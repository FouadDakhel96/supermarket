{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nimport { Group } from \"../../../scene/group\";\nimport { Selection } from \"../../../scene/selection\";\nimport { PointerEvents } from \"../../../scene/node\";\nimport { Path } from \"../../../scene/shape/path\";\nimport palette from \"../../palettes\";\nimport { CartesianSeries, CartesianSeriesMarker } from \"./cartesianSeries\";\nimport { ChartAxisDirection } from \"../../chartAxis\";\nimport { getMarker } from \"../../marker/util\";\nimport { Chart } from \"../../chart\";\nimport { findLargestMinMax, findMinMax } from \"../../../util/array\";\nimport { toFixed } from \"../../../util/number\";\nimport { equal } from \"../../../util/equal\";\nimport { reactive } from \"../../../util/observable\";\n\nvar AreaSeries =\n/** @class */\nfunction (_super) {\n  __extends(AreaSeries, _super);\n\n  function AreaSeries() {\n    var _this = _super.call(this) || this;\n\n    _this.areaGroup = _this.group.appendChild(new Group());\n    _this.strokeGroup = _this.group.appendChild(new Group());\n    _this.markerGroup = _this.group.appendChild(new Group());\n    _this.areaSelection = Selection.select(_this.areaGroup).selectAll();\n    _this.strokeSelection = Selection.select(_this.strokeGroup).selectAll();\n    _this.markerSelection = Selection.select(_this.markerGroup).selectAll();\n    _this.markerSelectionData = [];\n    /**\n     * The assumption is that the values will be reset (to `true`)\n     * in the {@link yKeys} setter.\n     */\n\n    _this.seriesItemEnabled = new Map();\n    _this.xData = [];\n    _this.yData = [];\n    _this.yDomain = [];\n    _this.directionKeys = {\n      x: ['xKey'],\n      y: ['yKeys']\n    };\n    _this.marker = new CartesianSeriesMarker();\n    _this.fills = palette.fills;\n    _this.strokes = palette.strokes;\n    _this.fillOpacity = 1;\n    _this.strokeOpacity = 1;\n    _this._xKey = '';\n    _this.xName = '';\n    _this._yKeys = [];\n    _this.yNames = [];\n    _this.strokeWidth = 2;\n    _this.highlightStyle = {\n      fill: 'yellow'\n    };\n\n    _this.addEventListener('update', _this.update);\n\n    _this.marker.enabled = false;\n\n    _this.marker.addPropertyListener('shape', _this.onMarkerShapeChange, _this);\n\n    _this.marker.addEventListener('change', _this.update, _this);\n\n    return _this;\n  }\n\n  AreaSeries.prototype.onMarkerShapeChange = function () {\n    this.markerSelection = this.markerSelection.setData([]);\n    this.markerSelection.exit.remove();\n    this.update();\n    this.fireEvent({\n      type: 'legendChange'\n    });\n  };\n\n  Object.defineProperty(AreaSeries.prototype, \"xKey\", {\n    get: function () {\n      return this._xKey;\n    },\n    set: function (value) {\n      if (this._xKey !== value) {\n        this._xKey = value;\n        this.xData = [];\n        this.scheduleData();\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(AreaSeries.prototype, \"yKeys\", {\n    get: function () {\n      return this._yKeys;\n    },\n    set: function (values) {\n      if (!equal(this._yKeys, values)) {\n        this._yKeys = values;\n        this.yData = [];\n        var seriesItemEnabled_1 = this.seriesItemEnabled;\n        seriesItemEnabled_1.clear();\n        values.forEach(function (key) {\n          return seriesItemEnabled_1.set(key, true);\n        });\n        this.scheduleData();\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(AreaSeries.prototype, \"normalizedTo\", {\n    get: function () {\n      return this._normalizedTo;\n    },\n    set: function (value) {\n      var absValue = value ? Math.abs(value) : undefined;\n\n      if (this._normalizedTo !== absValue) {\n        this._normalizedTo = absValue;\n        this.scheduleData();\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  AreaSeries.prototype.onHighlightChange = function () {\n    this.updateMarkerNodes();\n  };\n\n  AreaSeries.prototype.processData = function () {\n    var _a = this,\n        xKey = _a.xKey,\n        yKeys = _a.yKeys,\n        seriesItemEnabled = _a.seriesItemEnabled;\n\n    var data = xKey && yKeys.length && this.data ? this.data : []; // if (!(chart && chart.xAxis && chart.yAxis)) {\n    //     return false;\n    // }\n    // If the data is an array of rows like so:\n    //\n    // [{\n    //   xKy: 'Jan',\n    //   yKey1: 5,\n    //   yKey2: 7,\n    //   yKey3: -9,\n    // }, {\n    //   xKey: 'Feb',\n    //   yKey1: 10,\n    //   yKey2: -15,\n    //   yKey3: 20\n    // }]\n    //\n\n    var keysFound = true; // only warn once\n\n    this.xData = data.map(function (datum) {\n      if (keysFound && !(xKey in datum)) {\n        keysFound = false;\n        console.warn(\"The key '\" + xKey + \"' was not found in the data: \", datum);\n      }\n\n      return datum[xKey];\n    });\n    this.yData = data.map(function (datum) {\n      return yKeys.map(function (yKey) {\n        if (keysFound && !(yKey in datum)) {\n          keysFound = false;\n          console.warn(\"The key '\" + yKey + \"' was not found in the data: \", datum);\n        }\n\n        var value = datum[yKey];\n        return isFinite(value) && seriesItemEnabled.get(yKey) ? value : 0;\n      });\n    }); // xData: ['Jan', 'Feb']\n    //\n    // yData: [\n    //   [5, 7, -9],\n    //   [10, -15, 20]\n    // ]\n\n    var _b = this,\n        yData = _b.yData,\n        normalizedTo = _b.normalizedTo;\n\n    var yMinMax = yData.map(function (values) {\n      return findMinMax(values);\n    }); // used for normalization\n\n    var yLargestMinMax = findLargestMinMax(yMinMax);\n    var yMin;\n    var yMax;\n\n    if (normalizedTo && isFinite(normalizedTo)) {\n      yMin = yLargestMinMax.min < 0 ? -normalizedTo : 0;\n      yMax = normalizedTo;\n      yData.forEach(function (stack, i) {\n        return stack.forEach(function (y, j) {\n          if (y < 0) {\n            stack[j] = -y / yMinMax[i].min * normalizedTo;\n          } else {\n            stack[j] = y / yMinMax[i].max * normalizedTo;\n          }\n        });\n      });\n    } else {\n      yMin = yLargestMinMax.min;\n      yMax = yLargestMinMax.max;\n    }\n\n    if (yMin === 0 && yMax === 0) {\n      yMax = 1;\n    }\n\n    this.yDomain = this.fixNumericExtent([yMin, yMax], 'y');\n    this.fireEvent({\n      type: 'dataProcessed'\n    });\n    return true;\n  };\n\n  AreaSeries.prototype.getDomain = function (direction) {\n    if (direction === ChartAxisDirection.X) {\n      return this.xData;\n    } else {\n      return this.yDomain;\n    }\n  };\n\n  AreaSeries.prototype.update = function () {\n    var _a = this,\n        visible = _a.visible,\n        chart = _a.chart,\n        xAxis = _a.xAxis,\n        yAxis = _a.yAxis,\n        xData = _a.xData,\n        yData = _a.yData;\n\n    this.group.visible = visible && !!(xData.length && yData.length);\n\n    if (!xAxis || !yAxis || !visible || !chart || chart.layoutPending || chart.dataPending || !xData.length || !yData.length) {\n      return;\n    }\n\n    var _b = this.generateSelectionData(),\n        areaSelectionData = _b.areaSelectionData,\n        markerSelectionData = _b.markerSelectionData;\n\n    this.updateAreaSelection(areaSelectionData);\n    this.updateStrokeSelection(areaSelectionData);\n    this.updateMarkerSelection(markerSelectionData);\n    this.updateMarkerNodes();\n    this.markerSelectionData = markerSelectionData;\n  };\n\n  AreaSeries.prototype.generateSelectionData = function () {\n    var _this = this;\n\n    var _a = this,\n        yKeys = _a.yKeys,\n        data = _a.data,\n        xData = _a.xData,\n        yData = _a.yData,\n        marker = _a.marker,\n        fills = _a.fills,\n        strokes = _a.strokes,\n        xScale = _a.xAxis.scale,\n        yScale = _a.yAxis.scale;\n\n    var xOffset = (xScale.bandwidth || 0) / 2;\n    var yOffset = (yScale.bandwidth || 0) / 2;\n    var areaSelectionData = [];\n    var markerSelectionData = [];\n    var last = xData.length * 2 - 1;\n    xData.forEach(function (xDatum, i) {\n      var yDatum = yData[i];\n      var seriesDatum = data[i];\n      var x = xScale.convert(xDatum) + xOffset;\n      var prevMin = 0;\n      var prevMax = 0;\n      yDatum.forEach(function (curr, j) {\n        var prev = curr < 0 ? prevMin : prevMax;\n        var y = yScale.convert(prev + curr) + yOffset;\n        var yKey = yKeys[j];\n        var yValue = seriesDatum[yKey];\n\n        if (marker) {\n          markerSelectionData.push({\n            series: _this,\n            seriesDatum: seriesDatum,\n            yValue: yValue,\n            yKey: yKey,\n            point: {\n              x: x,\n              y: y\n            },\n            fill: fills[j % fills.length],\n            stroke: strokes[j % strokes.length]\n          });\n        }\n\n        var areaDatum = areaSelectionData[j] || (areaSelectionData[j] = {\n          yKey: yKey,\n          points: []\n        });\n        var areaPoints = areaDatum.points;\n        areaPoints[i] = {\n          x: x,\n          y: y\n        };\n        areaPoints[last - i] = {\n          x: x,\n          y: yScale.convert(prev) + yOffset\n        }; // bottom y\n\n        if (curr < 0) {\n          prevMin += curr;\n        } else {\n          prevMax += curr;\n        }\n      });\n    });\n    return {\n      areaSelectionData: areaSelectionData,\n      markerSelectionData: markerSelectionData\n    };\n  };\n\n  AreaSeries.prototype.updateAreaSelection = function (areaSelectionData) {\n    var _a = this,\n        fills = _a.fills,\n        fillOpacity = _a.fillOpacity,\n        seriesItemEnabled = _a.seriesItemEnabled,\n        shadow = _a.shadow;\n\n    var updateAreas = this.areaSelection.setData(areaSelectionData);\n    updateAreas.exit.remove();\n    var enterAreas = updateAreas.enter.append(Path).each(function (path) {\n      path.stroke = undefined;\n      path.pointerEvents = PointerEvents.None;\n    });\n    var areaSelection = updateAreas.merge(enterAreas);\n    areaSelection.each(function (shape, datum, index) {\n      var path = shape.path;\n      shape.fill = fills[index % fills.length];\n      shape.fillOpacity = fillOpacity;\n      shape.fillShadow = shadow;\n      shape.visible = !!seriesItemEnabled.get(datum.yKey);\n      path.clear();\n      var points = datum.points;\n      points.forEach(function (_a, i) {\n        var x = _a.x,\n            y = _a.y;\n\n        if (i > 0) {\n          path.lineTo(x, y);\n        } else {\n          path.moveTo(x, y);\n        }\n      });\n      path.closePath();\n    });\n    this.areaSelection = areaSelection;\n  };\n\n  AreaSeries.prototype.updateStrokeSelection = function (areaSelectionData) {\n    var _a = this,\n        strokes = _a.strokes,\n        strokeWidth = _a.strokeWidth,\n        strokeOpacity = _a.strokeOpacity,\n        data = _a.data,\n        seriesItemEnabled = _a.seriesItemEnabled;\n\n    var updateStrokes = this.strokeSelection.setData(areaSelectionData);\n    updateStrokes.exit.remove();\n    var enterStrokes = updateStrokes.enter.append(Path).each(function (path) {\n      path.fill = undefined;\n      path.lineJoin = path.lineCap = 'round';\n      path.pointerEvents = PointerEvents.None;\n    });\n    var strokeSelection = updateStrokes.merge(enterStrokes);\n    strokeSelection.each(function (shape, datum, index) {\n      var path = shape.path;\n      shape.stroke = strokes[index % strokes.length];\n      shape.strokeWidth = strokeWidth;\n      shape.visible = !!seriesItemEnabled.get(datum.yKey);\n      shape.strokeOpacity = strokeOpacity;\n      path.clear();\n      var points = datum.points; // The stroke doesn't go all the way around the fill, only on top,\n      // that's why we iterate until `data.length` (rather than `points.length`) and stop.\n\n      for (var i = 0; i < data.length; i++) {\n        var _a = points[i],\n            x = _a.x,\n            y = _a.y;\n\n        if (i > 0) {\n          path.lineTo(x, y);\n        } else {\n          path.moveTo(x, y);\n        }\n      }\n    });\n    this.strokeSelection = strokeSelection;\n  };\n\n  AreaSeries.prototype.updateMarkerSelection = function (markerSelectionData) {\n    var marker = this.marker;\n    var data = marker.shape ? markerSelectionData : [];\n    var MarkerShape = getMarker(marker.shape);\n    var updateMarkers = this.markerSelection.setData(data);\n    updateMarkers.exit.remove();\n    var enterMarkers = updateMarkers.enter.append(MarkerShape);\n    this.markerSelection = updateMarkers.merge(enterMarkers);\n  };\n\n  AreaSeries.prototype.updateMarkerNodes = function () {\n    var marker = this.marker;\n    var markerFormatter = marker.formatter;\n    var markerStrokeWidth = marker.strokeWidth !== undefined ? marker.strokeWidth : this.strokeWidth;\n    var markerSize = marker.size;\n\n    var _a = this,\n        xKey = _a.xKey,\n        seriesItemEnabled = _a.seriesItemEnabled;\n\n    var highlightedDatum = this.chart.highlightedDatum;\n    var _b = this.highlightStyle,\n        highlightFill = _b.fill,\n        highlightStroke = _b.stroke;\n    this.markerSelection.each(function (node, datum) {\n      var highlighted = datum === highlightedDatum;\n      var markerFill = highlighted && highlightFill !== undefined ? highlightFill : marker.fill || datum.fill;\n      var markerStroke = highlighted && highlightStroke !== undefined ? highlightStroke : marker.stroke || datum.stroke;\n      var markerFormat = undefined;\n\n      if (markerFormatter) {\n        markerFormat = markerFormatter({\n          datum: datum.seriesDatum,\n          xKey: xKey,\n          yKey: datum.yKey,\n          fill: markerFill,\n          stroke: markerStroke,\n          strokeWidth: markerStrokeWidth,\n          size: markerSize,\n          highlighted: highlighted\n        });\n      }\n\n      node.fill = markerFormat && markerFormat.fill || markerFill;\n      node.stroke = markerFormat && markerFormat.stroke || markerStroke;\n      node.strokeWidth = markerFormat && markerFormat.strokeWidth !== undefined ? markerFormat.strokeWidth : markerStrokeWidth;\n      node.size = markerFormat && markerFormat.size !== undefined ? markerFormat.size : markerSize;\n      node.translationX = datum.point.x;\n      node.translationY = datum.point.y;\n      node.visible = marker.enabled && node.size > 0 && !!seriesItemEnabled.get(datum.yKey);\n    });\n  };\n\n  AreaSeries.prototype.getNodeData = function () {\n    return this.markerSelectionData;\n  };\n\n  AreaSeries.prototype.fireNodeClickEvent = function (datum) {\n    this.fireEvent({\n      type: 'nodeClick',\n      series: this,\n      datum: datum.seriesDatum,\n      xKey: this.xKey,\n      yKey: datum.yKey\n    });\n  };\n\n  AreaSeries.prototype.getTooltipHtml = function (nodeDatum) {\n    var xKey = this.xKey;\n    var yKey = nodeDatum.yKey;\n\n    if (!xKey || !yKey) {\n      return '';\n    }\n\n    var _a = this,\n        xName = _a.xName,\n        yKeys = _a.yKeys,\n        yNames = _a.yNames,\n        fills = _a.fills,\n        tooltipRenderer = _a.tooltipRenderer;\n\n    var yKeyIndex = yKeys.indexOf(yKey);\n    var yName = yNames[yKeyIndex];\n    var color = fills[yKeyIndex % fills.length];\n\n    if (tooltipRenderer) {\n      return tooltipRenderer({\n        datum: nodeDatum.seriesDatum,\n        xKey: xKey,\n        xName: xName,\n        yKey: yKey,\n        yName: yName,\n        color: color\n      });\n    } else {\n      var titleStyle = \"style=\\\"color: white; background-color: \" + color + \"\\\"\";\n      var titleString = yName ? \"<div class=\\\"\" + Chart.defaultTooltipClass + \"-title\\\" \" + titleStyle + \">\" + yName + \"</div>\" : '';\n      var seriesDatum = nodeDatum.seriesDatum;\n      var xValue = seriesDatum[xKey];\n      var yValue = seriesDatum[yKey];\n      var xString = typeof xValue === 'number' ? toFixed(xValue) : String(xValue);\n      var yString = typeof yValue === 'number' ? toFixed(yValue) : String(yValue);\n      return titleString + \"<div class=\\\"\" + Chart.defaultTooltipClass + \"-content\\\">\" + xString + \": \" + yString + \"</div>\";\n    }\n  };\n\n  AreaSeries.prototype.listSeriesItems = function (legendData) {\n    var _a = this,\n        data = _a.data,\n        id = _a.id,\n        xKey = _a.xKey,\n        yKeys = _a.yKeys,\n        yNames = _a.yNames,\n        seriesItemEnabled = _a.seriesItemEnabled,\n        marker = _a.marker,\n        fills = _a.fills,\n        strokes = _a.strokes,\n        fillOpacity = _a.fillOpacity,\n        strokeOpacity = _a.strokeOpacity;\n\n    if (data && data.length && xKey && yKeys.length) {\n      yKeys.forEach(function (yKey, index) {\n        legendData.push({\n          id: id,\n          itemId: yKey,\n          enabled: seriesItemEnabled.get(yKey) || false,\n          label: {\n            text: yNames[index] || yKeys[index]\n          },\n          marker: {\n            shape: marker.shape,\n            fill: marker.fill || fills[index % fills.length],\n            stroke: marker.stroke || strokes[index % strokes.length],\n            fillOpacity: fillOpacity,\n            strokeOpacity: strokeOpacity\n          }\n        });\n      });\n    }\n  };\n\n  AreaSeries.prototype.toggleSeriesItem = function (itemId, enabled) {\n    this.seriesItemEnabled.set(itemId, enabled);\n    this.scheduleData();\n  };\n\n  AreaSeries.className = 'AreaSeries';\n  AreaSeries.type = 'area';\n\n  __decorate([reactive('dataChange')], AreaSeries.prototype, \"fills\", void 0);\n\n  __decorate([reactive('dataChange')], AreaSeries.prototype, \"strokes\", void 0);\n\n  __decorate([reactive('update')], AreaSeries.prototype, \"fillOpacity\", void 0);\n\n  __decorate([reactive('update')], AreaSeries.prototype, \"strokeOpacity\", void 0);\n\n  __decorate([reactive('update')], AreaSeries.prototype, \"xName\", void 0);\n\n  __decorate([reactive('update')], AreaSeries.prototype, \"yNames\", void 0);\n\n  __decorate([reactive('update')], AreaSeries.prototype, \"strokeWidth\", void 0);\n\n  __decorate([reactive('update')], AreaSeries.prototype, \"shadow\", void 0);\n\n  return AreaSeries;\n}(CartesianSeries);\n\nexport { AreaSeries };","map":{"version":3,"sources":["/Users/fouaddakhel/Projects/Nana/ReactJS/supermarket_dashboard/supermarket_dashboard/node_modules/ag-charts-community/dist/es6/chart/series/cartesian/areaSeries.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","__decorate","decorators","target","key","desc","c","arguments","length","r","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","Group","Selection","PointerEvents","Path","palette","CartesianSeries","CartesianSeriesMarker","ChartAxisDirection","getMarker","Chart","findLargestMinMax","findMinMax","toFixed","equal","reactive","AreaSeries","_super","_this","call","areaGroup","group","appendChild","strokeGroup","markerGroup","areaSelection","select","selectAll","strokeSelection","markerSelection","markerSelectionData","seriesItemEnabled","Map","xData","yData","yDomain","directionKeys","x","y","marker","fills","strokes","fillOpacity","strokeOpacity","_xKey","xName","_yKeys","yNames","strokeWidth","highlightStyle","fill","addEventListener","update","enabled","addPropertyListener","onMarkerShapeChange","setData","exit","remove","fireEvent","type","get","set","value","scheduleData","enumerable","configurable","values","seriesItemEnabled_1","clear","forEach","_normalizedTo","absValue","Math","abs","undefined","onHighlightChange","updateMarkerNodes","processData","_a","xKey","yKeys","data","keysFound","map","datum","console","warn","yKey","isFinite","_b","normalizedTo","yMinMax","yLargestMinMax","yMin","yMax","min","stack","j","max","fixNumericExtent","getDomain","direction","X","visible","chart","xAxis","yAxis","layoutPending","dataPending","generateSelectionData","areaSelectionData","updateAreaSelection","updateStrokeSelection","updateMarkerSelection","xScale","scale","yScale","xOffset","bandwidth","yOffset","last","xDatum","yDatum","seriesDatum","convert","prevMin","prevMax","curr","prev","yValue","push","series","point","stroke","areaDatum","points","areaPoints","shadow","updateAreas","enterAreas","enter","append","each","path","pointerEvents","None","merge","shape","index","fillShadow","lineTo","moveTo","closePath","updateStrokes","enterStrokes","lineJoin","lineCap","MarkerShape","updateMarkers","enterMarkers","markerFormatter","formatter","markerStrokeWidth","markerSize","size","highlightedDatum","highlightFill","highlightStroke","node","highlighted","markerFill","markerStroke","markerFormat","translationX","translationY","getNodeData","fireNodeClickEvent","getTooltipHtml","nodeDatum","tooltipRenderer","yKeyIndex","indexOf","yName","color","titleStyle","titleString","defaultTooltipClass","xValue","xString","String","yString","listSeriesItems","legendData","id","itemId","label","text","toggleSeriesItem","className"],"mappings":"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","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Group } from \"../../../scene/group\";\nimport { Selection } from \"../../../scene/selection\";\nimport { PointerEvents } from \"../../../scene/node\";\nimport { Path } from \"../../../scene/shape/path\";\nimport palette from \"../../palettes\";\nimport { CartesianSeries, CartesianSeriesMarker } from \"./cartesianSeries\";\nimport { ChartAxisDirection } from \"../../chartAxis\";\nimport { getMarker } from \"../../marker/util\";\nimport { Chart } from \"../../chart\";\nimport { findLargestMinMax, findMinMax } from \"../../../util/array\";\nimport { toFixed } from \"../../../util/number\";\nimport { equal } from \"../../../util/equal\";\nimport { reactive } from \"../../../util/observable\";\nvar AreaSeries = /** @class */ (function (_super) {\n    __extends(AreaSeries, _super);\n    function AreaSeries() {\n        var _this = _super.call(this) || this;\n        _this.areaGroup = _this.group.appendChild(new Group);\n        _this.strokeGroup = _this.group.appendChild(new Group);\n        _this.markerGroup = _this.group.appendChild(new Group);\n        _this.areaSelection = Selection.select(_this.areaGroup).selectAll();\n        _this.strokeSelection = Selection.select(_this.strokeGroup).selectAll();\n        _this.markerSelection = Selection.select(_this.markerGroup).selectAll();\n        _this.markerSelectionData = [];\n        /**\n         * The assumption is that the values will be reset (to `true`)\n         * in the {@link yKeys} setter.\n         */\n        _this.seriesItemEnabled = new Map();\n        _this.xData = [];\n        _this.yData = [];\n        _this.yDomain = [];\n        _this.directionKeys = {\n            x: ['xKey'],\n            y: ['yKeys']\n        };\n        _this.marker = new CartesianSeriesMarker();\n        _this.fills = palette.fills;\n        _this.strokes = palette.strokes;\n        _this.fillOpacity = 1;\n        _this.strokeOpacity = 1;\n        _this._xKey = '';\n        _this.xName = '';\n        _this._yKeys = [];\n        _this.yNames = [];\n        _this.strokeWidth = 2;\n        _this.highlightStyle = { fill: 'yellow' };\n        _this.addEventListener('update', _this.update);\n        _this.marker.enabled = false;\n        _this.marker.addPropertyListener('shape', _this.onMarkerShapeChange, _this);\n        _this.marker.addEventListener('change', _this.update, _this);\n        return _this;\n    }\n    AreaSeries.prototype.onMarkerShapeChange = function () {\n        this.markerSelection = this.markerSelection.setData([]);\n        this.markerSelection.exit.remove();\n        this.update();\n        this.fireEvent({ type: 'legendChange' });\n    };\n    Object.defineProperty(AreaSeries.prototype, \"xKey\", {\n        get: function () {\n            return this._xKey;\n        },\n        set: function (value) {\n            if (this._xKey !== value) {\n                this._xKey = value;\n                this.xData = [];\n                this.scheduleData();\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AreaSeries.prototype, \"yKeys\", {\n        get: function () {\n            return this._yKeys;\n        },\n        set: function (values) {\n            if (!equal(this._yKeys, values)) {\n                this._yKeys = values;\n                this.yData = [];\n                var seriesItemEnabled_1 = this.seriesItemEnabled;\n                seriesItemEnabled_1.clear();\n                values.forEach(function (key) { return seriesItemEnabled_1.set(key, true); });\n                this.scheduleData();\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(AreaSeries.prototype, \"normalizedTo\", {\n        get: function () {\n            return this._normalizedTo;\n        },\n        set: function (value) {\n            var absValue = value ? Math.abs(value) : undefined;\n            if (this._normalizedTo !== absValue) {\n                this._normalizedTo = absValue;\n                this.scheduleData();\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    AreaSeries.prototype.onHighlightChange = function () {\n        this.updateMarkerNodes();\n    };\n    AreaSeries.prototype.processData = function () {\n        var _a = this, xKey = _a.xKey, yKeys = _a.yKeys, seriesItemEnabled = _a.seriesItemEnabled;\n        var data = xKey && yKeys.length && this.data ? this.data : [];\n        // if (!(chart && chart.xAxis && chart.yAxis)) {\n        //     return false;\n        // }\n        // If the data is an array of rows like so:\n        //\n        // [{\n        //   xKy: 'Jan',\n        //   yKey1: 5,\n        //   yKey2: 7,\n        //   yKey3: -9,\n        // }, {\n        //   xKey: 'Feb',\n        //   yKey1: 10,\n        //   yKey2: -15,\n        //   yKey3: 20\n        // }]\n        //\n        var keysFound = true; // only warn once\n        this.xData = data.map(function (datum) {\n            if (keysFound && !(xKey in datum)) {\n                keysFound = false;\n                console.warn(\"The key '\" + xKey + \"' was not found in the data: \", datum);\n            }\n            return datum[xKey];\n        });\n        this.yData = data.map(function (datum) { return yKeys.map(function (yKey) {\n            if (keysFound && !(yKey in datum)) {\n                keysFound = false;\n                console.warn(\"The key '\" + yKey + \"' was not found in the data: \", datum);\n            }\n            var value = datum[yKey];\n            return isFinite(value) && seriesItemEnabled.get(yKey) ? value : 0;\n        }); });\n        // xData: ['Jan', 'Feb']\n        //\n        // yData: [\n        //   [5, 7, -9],\n        //   [10, -15, 20]\n        // ]\n        var _b = this, yData = _b.yData, normalizedTo = _b.normalizedTo;\n        var yMinMax = yData.map(function (values) { return findMinMax(values); }); // used for normalization\n        var yLargestMinMax = findLargestMinMax(yMinMax);\n        var yMin;\n        var yMax;\n        if (normalizedTo && isFinite(normalizedTo)) {\n            yMin = yLargestMinMax.min < 0 ? -normalizedTo : 0;\n            yMax = normalizedTo;\n            yData.forEach(function (stack, i) { return stack.forEach(function (y, j) {\n                if (y < 0) {\n                    stack[j] = -y / yMinMax[i].min * normalizedTo;\n                }\n                else {\n                    stack[j] = y / yMinMax[i].max * normalizedTo;\n                }\n            }); });\n        }\n        else {\n            yMin = yLargestMinMax.min;\n            yMax = yLargestMinMax.max;\n        }\n        if (yMin === 0 && yMax === 0) {\n            yMax = 1;\n        }\n        this.yDomain = this.fixNumericExtent([yMin, yMax], 'y');\n        this.fireEvent({ type: 'dataProcessed' });\n        return true;\n    };\n    AreaSeries.prototype.getDomain = function (direction) {\n        if (direction === ChartAxisDirection.X) {\n            return this.xData;\n        }\n        else {\n            return this.yDomain;\n        }\n    };\n    AreaSeries.prototype.update = function () {\n        var _a = this, visible = _a.visible, chart = _a.chart, xAxis = _a.xAxis, yAxis = _a.yAxis, xData = _a.xData, yData = _a.yData;\n        this.group.visible = visible && !!(xData.length && yData.length);\n        if (!xAxis || !yAxis || !visible || !chart || chart.layoutPending || chart.dataPending || !xData.length || !yData.length) {\n            return;\n        }\n        var _b = this.generateSelectionData(), areaSelectionData = _b.areaSelectionData, markerSelectionData = _b.markerSelectionData;\n        this.updateAreaSelection(areaSelectionData);\n        this.updateStrokeSelection(areaSelectionData);\n        this.updateMarkerSelection(markerSelectionData);\n        this.updateMarkerNodes();\n        this.markerSelectionData = markerSelectionData;\n    };\n    AreaSeries.prototype.generateSelectionData = function () {\n        var _this = this;\n        var _a = this, yKeys = _a.yKeys, data = _a.data, xData = _a.xData, yData = _a.yData, marker = _a.marker, fills = _a.fills, strokes = _a.strokes, xScale = _a.xAxis.scale, yScale = _a.yAxis.scale;\n        var xOffset = (xScale.bandwidth || 0) / 2;\n        var yOffset = (yScale.bandwidth || 0) / 2;\n        var areaSelectionData = [];\n        var markerSelectionData = [];\n        var last = xData.length * 2 - 1;\n        xData.forEach(function (xDatum, i) {\n            var yDatum = yData[i];\n            var seriesDatum = data[i];\n            var x = xScale.convert(xDatum) + xOffset;\n            var prevMin = 0;\n            var prevMax = 0;\n            yDatum.forEach(function (curr, j) {\n                var prev = curr < 0 ? prevMin : prevMax;\n                var y = yScale.convert(prev + curr) + yOffset;\n                var yKey = yKeys[j];\n                var yValue = seriesDatum[yKey];\n                if (marker) {\n                    markerSelectionData.push({\n                        series: _this,\n                        seriesDatum: seriesDatum,\n                        yValue: yValue,\n                        yKey: yKey,\n                        point: { x: x, y: y },\n                        fill: fills[j % fills.length],\n                        stroke: strokes[j % strokes.length]\n                    });\n                }\n                var areaDatum = areaSelectionData[j] || (areaSelectionData[j] = { yKey: yKey, points: [] });\n                var areaPoints = areaDatum.points;\n                areaPoints[i] = { x: x, y: y };\n                areaPoints[last - i] = { x: x, y: yScale.convert(prev) + yOffset }; // bottom y\n                if (curr < 0) {\n                    prevMin += curr;\n                }\n                else {\n                    prevMax += curr;\n                }\n            });\n        });\n        return { areaSelectionData: areaSelectionData, markerSelectionData: markerSelectionData };\n    };\n    AreaSeries.prototype.updateAreaSelection = function (areaSelectionData) {\n        var _a = this, fills = _a.fills, fillOpacity = _a.fillOpacity, seriesItemEnabled = _a.seriesItemEnabled, shadow = _a.shadow;\n        var updateAreas = this.areaSelection.setData(areaSelectionData);\n        updateAreas.exit.remove();\n        var enterAreas = updateAreas.enter.append(Path)\n            .each(function (path) {\n            path.stroke = undefined;\n            path.pointerEvents = PointerEvents.None;\n        });\n        var areaSelection = updateAreas.merge(enterAreas);\n        areaSelection.each(function (shape, datum, index) {\n            var path = shape.path;\n            shape.fill = fills[index % fills.length];\n            shape.fillOpacity = fillOpacity;\n            shape.fillShadow = shadow;\n            shape.visible = !!seriesItemEnabled.get(datum.yKey);\n            path.clear();\n            var points = datum.points;\n            points.forEach(function (_a, i) {\n                var x = _a.x, y = _a.y;\n                if (i > 0) {\n                    path.lineTo(x, y);\n                }\n                else {\n                    path.moveTo(x, y);\n                }\n            });\n            path.closePath();\n        });\n        this.areaSelection = areaSelection;\n    };\n    AreaSeries.prototype.updateStrokeSelection = function (areaSelectionData) {\n        var _a = this, strokes = _a.strokes, strokeWidth = _a.strokeWidth, strokeOpacity = _a.strokeOpacity, data = _a.data, seriesItemEnabled = _a.seriesItemEnabled;\n        var updateStrokes = this.strokeSelection.setData(areaSelectionData);\n        updateStrokes.exit.remove();\n        var enterStrokes = updateStrokes.enter.append(Path)\n            .each(function (path) {\n            path.fill = undefined;\n            path.lineJoin = path.lineCap = 'round';\n            path.pointerEvents = PointerEvents.None;\n        });\n        var strokeSelection = updateStrokes.merge(enterStrokes);\n        strokeSelection.each(function (shape, datum, index) {\n            var path = shape.path;\n            shape.stroke = strokes[index % strokes.length];\n            shape.strokeWidth = strokeWidth;\n            shape.visible = !!seriesItemEnabled.get(datum.yKey);\n            shape.strokeOpacity = strokeOpacity;\n            path.clear();\n            var points = datum.points;\n            // The stroke doesn't go all the way around the fill, only on top,\n            // that's why we iterate until `data.length` (rather than `points.length`) and stop.\n            for (var i = 0; i < data.length; i++) {\n                var _a = points[i], x = _a.x, y = _a.y;\n                if (i > 0) {\n                    path.lineTo(x, y);\n                }\n                else {\n                    path.moveTo(x, y);\n                }\n            }\n        });\n        this.strokeSelection = strokeSelection;\n    };\n    AreaSeries.prototype.updateMarkerSelection = function (markerSelectionData) {\n        var marker = this.marker;\n        var data = marker.shape ? markerSelectionData : [];\n        var MarkerShape = getMarker(marker.shape);\n        var updateMarkers = this.markerSelection.setData(data);\n        updateMarkers.exit.remove();\n        var enterMarkers = updateMarkers.enter.append(MarkerShape);\n        this.markerSelection = updateMarkers.merge(enterMarkers);\n    };\n    AreaSeries.prototype.updateMarkerNodes = function () {\n        var marker = this.marker;\n        var markerFormatter = marker.formatter;\n        var markerStrokeWidth = marker.strokeWidth !== undefined ? marker.strokeWidth : this.strokeWidth;\n        var markerSize = marker.size;\n        var _a = this, xKey = _a.xKey, seriesItemEnabled = _a.seriesItemEnabled;\n        var highlightedDatum = this.chart.highlightedDatum;\n        var _b = this.highlightStyle, highlightFill = _b.fill, highlightStroke = _b.stroke;\n        this.markerSelection.each(function (node, datum) {\n            var highlighted = datum === highlightedDatum;\n            var markerFill = highlighted && highlightFill !== undefined ? highlightFill : marker.fill || datum.fill;\n            var markerStroke = highlighted && highlightStroke !== undefined ? highlightStroke : marker.stroke || datum.stroke;\n            var markerFormat = undefined;\n            if (markerFormatter) {\n                markerFormat = markerFormatter({\n                    datum: datum.seriesDatum,\n                    xKey: xKey,\n                    yKey: datum.yKey,\n                    fill: markerFill,\n                    stroke: markerStroke,\n                    strokeWidth: markerStrokeWidth,\n                    size: markerSize,\n                    highlighted: highlighted\n                });\n            }\n            node.fill = markerFormat && markerFormat.fill || markerFill;\n            node.stroke = markerFormat && markerFormat.stroke || markerStroke;\n            node.strokeWidth = markerFormat && markerFormat.strokeWidth !== undefined\n                ? markerFormat.strokeWidth\n                : markerStrokeWidth;\n            node.size = markerFormat && markerFormat.size !== undefined\n                ? markerFormat.size\n                : markerSize;\n            node.translationX = datum.point.x;\n            node.translationY = datum.point.y;\n            node.visible = marker.enabled && node.size > 0 && !!seriesItemEnabled.get(datum.yKey);\n        });\n    };\n    AreaSeries.prototype.getNodeData = function () {\n        return this.markerSelectionData;\n    };\n    AreaSeries.prototype.fireNodeClickEvent = function (datum) {\n        this.fireEvent({\n            type: 'nodeClick',\n            series: this,\n            datum: datum.seriesDatum,\n            xKey: this.xKey,\n            yKey: datum.yKey\n        });\n    };\n    AreaSeries.prototype.getTooltipHtml = function (nodeDatum) {\n        var xKey = this.xKey;\n        var yKey = nodeDatum.yKey;\n        if (!xKey || !yKey) {\n            return '';\n        }\n        var _a = this, xName = _a.xName, yKeys = _a.yKeys, yNames = _a.yNames, fills = _a.fills, tooltipRenderer = _a.tooltipRenderer;\n        var yKeyIndex = yKeys.indexOf(yKey);\n        var yName = yNames[yKeyIndex];\n        var color = fills[yKeyIndex % fills.length];\n        if (tooltipRenderer) {\n            return tooltipRenderer({\n                datum: nodeDatum.seriesDatum,\n                xKey: xKey,\n                xName: xName,\n                yKey: yKey,\n                yName: yName,\n                color: color\n            });\n        }\n        else {\n            var titleStyle = \"style=\\\"color: white; background-color: \" + color + \"\\\"\";\n            var titleString = yName ? \"<div class=\\\"\" + Chart.defaultTooltipClass + \"-title\\\" \" + titleStyle + \">\" + yName + \"</div>\" : '';\n            var seriesDatum = nodeDatum.seriesDatum;\n            var xValue = seriesDatum[xKey];\n            var yValue = seriesDatum[yKey];\n            var xString = typeof xValue === 'number' ? toFixed(xValue) : String(xValue);\n            var yString = typeof yValue === 'number' ? toFixed(yValue) : String(yValue);\n            return titleString + \"<div class=\\\"\" + Chart.defaultTooltipClass + \"-content\\\">\" + xString + \": \" + yString + \"</div>\";\n        }\n    };\n    AreaSeries.prototype.listSeriesItems = function (legendData) {\n        var _a = this, data = _a.data, id = _a.id, xKey = _a.xKey, yKeys = _a.yKeys, yNames = _a.yNames, seriesItemEnabled = _a.seriesItemEnabled, marker = _a.marker, fills = _a.fills, strokes = _a.strokes, fillOpacity = _a.fillOpacity, strokeOpacity = _a.strokeOpacity;\n        if (data && data.length && xKey && yKeys.length) {\n            yKeys.forEach(function (yKey, index) {\n                legendData.push({\n                    id: id,\n                    itemId: yKey,\n                    enabled: seriesItemEnabled.get(yKey) || false,\n                    label: {\n                        text: yNames[index] || yKeys[index]\n                    },\n                    marker: {\n                        shape: marker.shape,\n                        fill: marker.fill || fills[index % fills.length],\n                        stroke: marker.stroke || strokes[index % strokes.length],\n                        fillOpacity: fillOpacity,\n                        strokeOpacity: strokeOpacity\n                    }\n                });\n            });\n        }\n    };\n    AreaSeries.prototype.toggleSeriesItem = function (itemId, enabled) {\n        this.seriesItemEnabled.set(itemId, enabled);\n        this.scheduleData();\n    };\n    AreaSeries.className = 'AreaSeries';\n    AreaSeries.type = 'area';\n    __decorate([\n        reactive('dataChange')\n    ], AreaSeries.prototype, \"fills\", void 0);\n    __decorate([\n        reactive('dataChange')\n    ], AreaSeries.prototype, \"strokes\", void 0);\n    __decorate([\n        reactive('update')\n    ], AreaSeries.prototype, \"fillOpacity\", void 0);\n    __decorate([\n        reactive('update')\n    ], AreaSeries.prototype, \"strokeOpacity\", void 0);\n    __decorate([\n        reactive('update')\n    ], AreaSeries.prototype, \"xName\", void 0);\n    __decorate([\n        reactive('update')\n    ], AreaSeries.prototype, \"yNames\", void 0);\n    __decorate([\n        reactive('update')\n    ], AreaSeries.prototype, \"strokeWidth\", void 0);\n    __decorate([\n        reactive('update')\n    ], AreaSeries.prototype, \"shadow\", void 0);\n    return AreaSeries;\n}(CartesianSeries));\nexport { AreaSeries };\n"]},"metadata":{},"sourceType":"module"}