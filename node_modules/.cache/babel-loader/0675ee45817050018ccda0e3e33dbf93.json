{"ast":null,"code":"/**\n * @ag-grid-community/core - Advanced Data Grid / Data Table supporting Javascript / React / AngularJS / Web Components\n * @version v23.2.1\n * @link http://www.ag-grid.com/\n * @license MIT\n */\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nimport { Autowired, Bean, PostConstruct } from \"../context/context\";\nimport { Events } from \"../eventKeys\";\nimport { FillUndoRedoAction, UndoRedoAction, UndoRedoStack } from \"./undoRedoStack\";\nimport { Constants } from \"../constants\";\nimport { ModuleNames } from \"../modules/moduleNames\";\nimport { ModuleRegistry } from \"../modules/moduleRegistry\";\nimport { BeanStub } from \"../context/beanStub\";\n\nvar UndoRedoService =\n/** @class */\nfunction (_super) {\n  __extends(UndoRedoService, _super);\n\n  function UndoRedoService() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.cellValueChanges = [];\n    _this.isCellEditing = false;\n    _this.isRowEditing = false;\n    _this.isPasting = false;\n    _this.isFilling = false;\n\n    _this.onCellValueChanged = function (event) {\n      var shouldCaptureAction = _this.isCellEditing || _this.isRowEditing || _this.isPasting || _this.isFilling;\n\n      if (!shouldCaptureAction) {\n        return;\n      }\n\n      var rowPinned = event.rowPinned,\n          rowIndex = event.rowIndex,\n          column = event.column,\n          oldValue = event.oldValue,\n          value = event.value;\n      var cellValueChange = {\n        rowPinned: rowPinned,\n        rowIndex: rowIndex,\n        columnId: column.getColId(),\n        oldValue: oldValue,\n        newValue: value\n      };\n\n      _this.cellValueChanges.push(cellValueChange);\n    };\n\n    _this.clearStacks = function () {\n      _this.undoStack.clear();\n\n      _this.redoStack.clear();\n    };\n\n    return _this;\n  }\n\n  UndoRedoService.prototype.init = function () {\n    if (!this.gridOptionsWrapper.isUndoRedoCellEditing()) {\n      return;\n    }\n\n    var undoRedoLimit = this.gridOptionsWrapper.getUndoRedoCellEditingLimit();\n\n    if (undoRedoLimit <= 0) {\n      return;\n    }\n\n    this.undoStack = new UndoRedoStack(undoRedoLimit);\n    this.redoStack = new UndoRedoStack(undoRedoLimit);\n    this.addRowEditingListeners();\n    this.addCellEditingListeners();\n    this.addPasteListeners();\n    this.addFillListeners();\n    this.addManagedListener(this.eventService, Events.EVENT_CELL_VALUE_CHANGED, this.onCellValueChanged); // undo / redo is restricted to actual editing so we clear the stacks when other operations are\n    // performed that change the order of the row / cols.\n\n    this.addManagedListener(this.eventService, Events.EVENT_MODEL_UPDATED, this.clearStacks);\n    this.addManagedListener(this.eventService, Events.EVENT_COLUMN_PIVOT_MODE_CHANGED, this.clearStacks);\n    this.addManagedListener(this.eventService, Events.EVENT_COLUMN_EVERYTHING_CHANGED, this.clearStacks);\n    this.addManagedListener(this.eventService, Events.EVENT_COLUMN_GROUP_OPENED, this.clearStacks);\n    this.addManagedListener(this.eventService, Events.EVENT_COLUMN_ROW_GROUP_CHANGED, this.clearStacks);\n    this.addManagedListener(this.eventService, Events.EVENT_COLUMN_MOVED, this.clearStacks);\n    this.addManagedListener(this.eventService, Events.EVENT_COLUMN_PINNED, this.clearStacks);\n    this.addManagedListener(this.eventService, Events.EVENT_COLUMN_VISIBLE, this.clearStacks);\n    this.addManagedListener(this.eventService, Events.EVENT_ROW_DRAG_END, this.clearStacks);\n  };\n\n  UndoRedoService.prototype.undo = function () {\n    if (!this.undoStack) {\n      return;\n    }\n\n    var undoAction = this.undoStack.pop();\n\n    if (!undoAction || !undoAction.cellValueChanges) {\n      return;\n    }\n\n    this.processAction(undoAction, function (cellValueChange) {\n      return cellValueChange.oldValue;\n    });\n\n    if (undoAction instanceof FillUndoRedoAction) {\n      this.processRangeAndCellFocus(undoAction.cellValueChanges, undoAction.initialRange);\n    } else {\n      this.processRangeAndCellFocus(undoAction.cellValueChanges);\n    }\n\n    this.redoStack.push(undoAction);\n  };\n\n  UndoRedoService.prototype.redo = function () {\n    if (!this.redoStack) {\n      return;\n    }\n\n    var redoAction = this.redoStack.pop();\n\n    if (!redoAction || !redoAction.cellValueChanges) {\n      return;\n    }\n\n    this.processAction(redoAction, function (cellValueChange) {\n      return cellValueChange.newValue;\n    });\n\n    if (redoAction instanceof FillUndoRedoAction) {\n      this.processRangeAndCellFocus(redoAction.cellValueChanges, redoAction.finalRange);\n    } else {\n      this.processRangeAndCellFocus(redoAction.cellValueChanges);\n    }\n\n    this.undoStack.push(redoAction);\n  };\n\n  UndoRedoService.prototype.processAction = function (action, valueExtractor) {\n    var _this = this;\n\n    action.cellValueChanges.forEach(function (cellValueChange) {\n      var rowIndex = cellValueChange.rowIndex,\n          rowPinned = cellValueChange.rowPinned,\n          columnId = cellValueChange.columnId;\n      var rowPosition = {\n        rowIndex: rowIndex,\n        rowPinned: rowPinned\n      };\n\n      var currentRow = _this.getRowNode(rowPosition); // checks if the row has been filtered out\n\n\n      if (currentRow.rowTop == null) {\n        return;\n      }\n\n      currentRow.setDataValue(columnId, valueExtractor(cellValueChange));\n    });\n  };\n\n  UndoRedoService.prototype.processRangeAndCellFocus = function (cellValueChanges, range) {\n    if (range) {\n      var startRow = range.startRow;\n      var endRow = range.endRow;\n      var lastFocusedCell_1 = {\n        rowPinned: startRow.rowPinned,\n        rowIndex: startRow.rowIndex,\n        columnId: range.startColumn.getColId()\n      };\n      this.setLastFocusedCell(lastFocusedCell_1);\n      var cellRangeParams = {\n        rowStartIndex: startRow.rowIndex,\n        rowStartPinned: startRow.rowPinned,\n        rowEndIndex: endRow.rowIndex,\n        rowEndPinned: endRow.rowPinned,\n        columnStart: range.startColumn,\n        columns: range.columns\n      };\n      this.gridApi.addCellRange(cellRangeParams);\n      return;\n    }\n\n    var cellValueChange = cellValueChanges[0];\n    var rowIndex = cellValueChange.rowIndex,\n        rowPinned = cellValueChange.rowPinned;\n    var rowPosition = {\n      rowIndex: rowIndex,\n      rowPinned: rowPinned\n    };\n    var row = this.getRowNode(rowPosition);\n    var lastFocusedCell = {\n      rowPinned: cellValueChange.rowPinned,\n      rowIndex: row.rowIndex,\n      columnId: cellValueChange.columnId\n    };\n    this.setLastFocusedCell(lastFocusedCell);\n  };\n\n  UndoRedoService.prototype.setLastFocusedCell = function (lastFocusedCell) {\n    var rowIndex = lastFocusedCell.rowIndex,\n        columnId = lastFocusedCell.columnId,\n        rowPinned = lastFocusedCell.rowPinned;\n    this.gridApi.ensureIndexVisible(rowIndex);\n    this.gridApi.ensureColumnVisible(columnId);\n\n    if (ModuleRegistry.isRegistered(ModuleNames.RangeSelectionModule)) {\n      this.gridApi.clearRangeSelection();\n    }\n\n    this.focusController.setFocusedCell(rowIndex, columnId, rowPinned, true);\n  };\n\n  UndoRedoService.prototype.addRowEditingListeners = function () {\n    var _this = this;\n\n    this.addManagedListener(this.eventService, Events.EVENT_ROW_EDITING_STARTED, function () {\n      _this.isRowEditing = true;\n    });\n    this.addManagedListener(this.eventService, Events.EVENT_ROW_EDITING_STOPPED, function () {\n      var action = new UndoRedoAction(_this.cellValueChanges);\n\n      _this.pushActionsToUndoStack(action);\n\n      _this.isRowEditing = false;\n    });\n  };\n\n  UndoRedoService.prototype.addCellEditingListeners = function () {\n    var _this = this;\n\n    this.addManagedListener(this.eventService, Events.EVENT_CELL_EDITING_STARTED, function () {\n      _this.isCellEditing = true;\n    });\n    this.addManagedListener(this.eventService, Events.EVENT_CELL_EDITING_STOPPED, function () {\n      _this.isCellEditing = false;\n      var shouldPushAction = !_this.isRowEditing && !_this.isPasting && !_this.isFilling;\n\n      if (shouldPushAction) {\n        var action = new UndoRedoAction(_this.cellValueChanges);\n\n        _this.pushActionsToUndoStack(action);\n      }\n    });\n  };\n\n  UndoRedoService.prototype.addPasteListeners = function () {\n    var _this = this;\n\n    this.addManagedListener(this.eventService, Events.EVENT_PASTE_START, function () {\n      _this.isPasting = true;\n    });\n    this.addManagedListener(this.eventService, Events.EVENT_PASTE_END, function () {\n      var action = new UndoRedoAction(_this.cellValueChanges);\n\n      _this.pushActionsToUndoStack(action);\n\n      _this.isPasting = false;\n    });\n  };\n\n  UndoRedoService.prototype.addFillListeners = function () {\n    var _this = this;\n\n    this.addManagedListener(this.eventService, Events.EVENT_FILL_START, function () {\n      _this.isFilling = true;\n    });\n    this.addManagedListener(this.eventService, Events.EVENT_FILL_END, function (event) {\n      var action = new FillUndoRedoAction(_this.cellValueChanges, event.initialRange, event.finalRange);\n\n      _this.pushActionsToUndoStack(action);\n\n      _this.isFilling = false;\n    });\n  };\n\n  UndoRedoService.prototype.pushActionsToUndoStack = function (action) {\n    this.undoStack.push(action);\n    this.cellValueChanges = [];\n    this.redoStack.clear();\n  };\n\n  UndoRedoService.prototype.getRowNode = function (gridRow) {\n    switch (gridRow.rowPinned) {\n      case Constants.PINNED_TOP:\n        return this.pinnedRowModel.getPinnedTopRowData()[gridRow.rowIndex];\n\n      case Constants.PINNED_BOTTOM:\n        return this.pinnedRowModel.getPinnedBottomRowData()[gridRow.rowIndex];\n\n      default:\n        return this.rowModel.getRow(gridRow.rowIndex);\n    }\n  };\n\n  __decorate([Autowired('gridOptionsWrapper')], UndoRedoService.prototype, \"gridOptionsWrapper\", void 0);\n\n  __decorate([Autowired('focusController')], UndoRedoService.prototype, \"focusController\", void 0);\n\n  __decorate([Autowired('gridApi')], UndoRedoService.prototype, \"gridApi\", void 0);\n\n  __decorate([Autowired('rowModel')], UndoRedoService.prototype, \"rowModel\", void 0);\n\n  __decorate([Autowired('pinnedRowModel')], UndoRedoService.prototype, \"pinnedRowModel\", void 0);\n\n  __decorate([PostConstruct], UndoRedoService.prototype, \"init\", null);\n\n  UndoRedoService = __decorate([Bean('undoRedoService')], UndoRedoService);\n  return UndoRedoService;\n}(BeanStub);\n\nexport { UndoRedoService };","map":{"version":3,"sources":["/Users/fouaddakhel/Projects/Nana/ReactJS/supermarket_dashboard/supermarket_dashboard/node_modules/@ag-grid-community/core/dist/es6/undoRedo/undoRedoService.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","__decorate","decorators","target","key","desc","c","arguments","length","r","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","Autowired","Bean","PostConstruct","Events","FillUndoRedoAction","UndoRedoAction","UndoRedoStack","Constants","ModuleNames","ModuleRegistry","BeanStub","UndoRedoService","_super","_this","apply","cellValueChanges","isCellEditing","isRowEditing","isPasting","isFilling","onCellValueChanged","event","shouldCaptureAction","rowPinned","rowIndex","column","oldValue","value","cellValueChange","columnId","getColId","newValue","push","clearStacks","undoStack","clear","redoStack","init","gridOptionsWrapper","isUndoRedoCellEditing","undoRedoLimit","getUndoRedoCellEditingLimit","addRowEditingListeners","addCellEditingListeners","addPasteListeners","addFillListeners","addManagedListener","eventService","EVENT_CELL_VALUE_CHANGED","EVENT_MODEL_UPDATED","EVENT_COLUMN_PIVOT_MODE_CHANGED","EVENT_COLUMN_EVERYTHING_CHANGED","EVENT_COLUMN_GROUP_OPENED","EVENT_COLUMN_ROW_GROUP_CHANGED","EVENT_COLUMN_MOVED","EVENT_COLUMN_PINNED","EVENT_COLUMN_VISIBLE","EVENT_ROW_DRAG_END","undo","undoAction","pop","processAction","processRangeAndCellFocus","initialRange","redo","redoAction","finalRange","action","valueExtractor","forEach","rowPosition","currentRow","getRowNode","rowTop","setDataValue","range","startRow","endRow","lastFocusedCell_1","startColumn","setLastFocusedCell","cellRangeParams","rowStartIndex","rowStartPinned","rowEndIndex","rowEndPinned","columnStart","columns","gridApi","addCellRange","row","lastFocusedCell","ensureIndexVisible","ensureColumnVisible","isRegistered","RangeSelectionModule","clearRangeSelection","focusController","setFocusedCell","EVENT_ROW_EDITING_STARTED","EVENT_ROW_EDITING_STOPPED","pushActionsToUndoStack","EVENT_CELL_EDITING_STARTED","EVENT_CELL_EDITING_STOPPED","shouldPushAction","EVENT_PASTE_START","EVENT_PASTE_END","EVENT_FILL_START","EVENT_FILL_END","gridRow","PINNED_TOP","pinnedRowModel","getPinnedTopRowData","PINNED_BOTTOM","getPinnedBottomRowData","rowModel","getRow"],"mappings":"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","sourcesContent":["/**\n * @ag-grid-community/core - Advanced Data Grid / Data Table supporting Javascript / React / AngularJS / Web Components\n * @version v23.2.1\n * @link http://www.ag-grid.com/\n * @license MIT\n */\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Autowired, Bean, PostConstruct } from \"../context/context\";\nimport { Events } from \"../eventKeys\";\nimport { FillUndoRedoAction, UndoRedoAction, UndoRedoStack } from \"./undoRedoStack\";\nimport { Constants } from \"../constants\";\nimport { ModuleNames } from \"../modules/moduleNames\";\nimport { ModuleRegistry } from \"../modules/moduleRegistry\";\nimport { BeanStub } from \"../context/beanStub\";\nvar UndoRedoService = /** @class */ (function (_super) {\n    __extends(UndoRedoService, _super);\n    function UndoRedoService() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.cellValueChanges = [];\n        _this.isCellEditing = false;\n        _this.isRowEditing = false;\n        _this.isPasting = false;\n        _this.isFilling = false;\n        _this.onCellValueChanged = function (event) {\n            var shouldCaptureAction = _this.isCellEditing || _this.isRowEditing || _this.isPasting || _this.isFilling;\n            if (!shouldCaptureAction) {\n                return;\n            }\n            var rowPinned = event.rowPinned, rowIndex = event.rowIndex, column = event.column, oldValue = event.oldValue, value = event.value;\n            var cellValueChange = {\n                rowPinned: rowPinned,\n                rowIndex: rowIndex,\n                columnId: column.getColId(),\n                oldValue: oldValue,\n                newValue: value\n            };\n            _this.cellValueChanges.push(cellValueChange);\n        };\n        _this.clearStacks = function () {\n            _this.undoStack.clear();\n            _this.redoStack.clear();\n        };\n        return _this;\n    }\n    UndoRedoService.prototype.init = function () {\n        if (!this.gridOptionsWrapper.isUndoRedoCellEditing()) {\n            return;\n        }\n        var undoRedoLimit = this.gridOptionsWrapper.getUndoRedoCellEditingLimit();\n        if (undoRedoLimit <= 0) {\n            return;\n        }\n        this.undoStack = new UndoRedoStack(undoRedoLimit);\n        this.redoStack = new UndoRedoStack(undoRedoLimit);\n        this.addRowEditingListeners();\n        this.addCellEditingListeners();\n        this.addPasteListeners();\n        this.addFillListeners();\n        this.addManagedListener(this.eventService, Events.EVENT_CELL_VALUE_CHANGED, this.onCellValueChanged);\n        // undo / redo is restricted to actual editing so we clear the stacks when other operations are\n        // performed that change the order of the row / cols.\n        this.addManagedListener(this.eventService, Events.EVENT_MODEL_UPDATED, this.clearStacks);\n        this.addManagedListener(this.eventService, Events.EVENT_COLUMN_PIVOT_MODE_CHANGED, this.clearStacks);\n        this.addManagedListener(this.eventService, Events.EVENT_COLUMN_EVERYTHING_CHANGED, this.clearStacks);\n        this.addManagedListener(this.eventService, Events.EVENT_COLUMN_GROUP_OPENED, this.clearStacks);\n        this.addManagedListener(this.eventService, Events.EVENT_COLUMN_ROW_GROUP_CHANGED, this.clearStacks);\n        this.addManagedListener(this.eventService, Events.EVENT_COLUMN_MOVED, this.clearStacks);\n        this.addManagedListener(this.eventService, Events.EVENT_COLUMN_PINNED, this.clearStacks);\n        this.addManagedListener(this.eventService, Events.EVENT_COLUMN_VISIBLE, this.clearStacks);\n        this.addManagedListener(this.eventService, Events.EVENT_ROW_DRAG_END, this.clearStacks);\n    };\n    UndoRedoService.prototype.undo = function () {\n        if (!this.undoStack) {\n            return;\n        }\n        var undoAction = this.undoStack.pop();\n        if (!undoAction || !undoAction.cellValueChanges) {\n            return;\n        }\n        this.processAction(undoAction, function (cellValueChange) { return cellValueChange.oldValue; });\n        if (undoAction instanceof FillUndoRedoAction) {\n            this.processRangeAndCellFocus(undoAction.cellValueChanges, undoAction.initialRange);\n        }\n        else {\n            this.processRangeAndCellFocus(undoAction.cellValueChanges);\n        }\n        this.redoStack.push(undoAction);\n    };\n    UndoRedoService.prototype.redo = function () {\n        if (!this.redoStack) {\n            return;\n        }\n        var redoAction = this.redoStack.pop();\n        if (!redoAction || !redoAction.cellValueChanges) {\n            return;\n        }\n        this.processAction(redoAction, function (cellValueChange) { return cellValueChange.newValue; });\n        if (redoAction instanceof FillUndoRedoAction) {\n            this.processRangeAndCellFocus(redoAction.cellValueChanges, redoAction.finalRange);\n        }\n        else {\n            this.processRangeAndCellFocus(redoAction.cellValueChanges);\n        }\n        this.undoStack.push(redoAction);\n    };\n    UndoRedoService.prototype.processAction = function (action, valueExtractor) {\n        var _this = this;\n        action.cellValueChanges.forEach(function (cellValueChange) {\n            var rowIndex = cellValueChange.rowIndex, rowPinned = cellValueChange.rowPinned, columnId = cellValueChange.columnId;\n            var rowPosition = { rowIndex: rowIndex, rowPinned: rowPinned };\n            var currentRow = _this.getRowNode(rowPosition);\n            // checks if the row has been filtered out\n            if (currentRow.rowTop == null) {\n                return;\n            }\n            currentRow.setDataValue(columnId, valueExtractor(cellValueChange));\n        });\n    };\n    UndoRedoService.prototype.processRangeAndCellFocus = function (cellValueChanges, range) {\n        if (range) {\n            var startRow = range.startRow;\n            var endRow = range.endRow;\n            var lastFocusedCell_1 = {\n                rowPinned: startRow.rowPinned,\n                rowIndex: startRow.rowIndex,\n                columnId: range.startColumn.getColId()\n            };\n            this.setLastFocusedCell(lastFocusedCell_1);\n            var cellRangeParams = {\n                rowStartIndex: startRow.rowIndex,\n                rowStartPinned: startRow.rowPinned,\n                rowEndIndex: endRow.rowIndex,\n                rowEndPinned: endRow.rowPinned,\n                columnStart: range.startColumn,\n                columns: range.columns\n            };\n            this.gridApi.addCellRange(cellRangeParams);\n            return;\n        }\n        var cellValueChange = cellValueChanges[0];\n        var rowIndex = cellValueChange.rowIndex, rowPinned = cellValueChange.rowPinned;\n        var rowPosition = { rowIndex: rowIndex, rowPinned: rowPinned };\n        var row = this.getRowNode(rowPosition);\n        var lastFocusedCell = {\n            rowPinned: cellValueChange.rowPinned,\n            rowIndex: row.rowIndex,\n            columnId: cellValueChange.columnId\n        };\n        this.setLastFocusedCell(lastFocusedCell);\n    };\n    UndoRedoService.prototype.setLastFocusedCell = function (lastFocusedCell) {\n        var rowIndex = lastFocusedCell.rowIndex, columnId = lastFocusedCell.columnId, rowPinned = lastFocusedCell.rowPinned;\n        this.gridApi.ensureIndexVisible(rowIndex);\n        this.gridApi.ensureColumnVisible(columnId);\n        if (ModuleRegistry.isRegistered(ModuleNames.RangeSelectionModule)) {\n            this.gridApi.clearRangeSelection();\n        }\n        this.focusController.setFocusedCell(rowIndex, columnId, rowPinned, true);\n    };\n    UndoRedoService.prototype.addRowEditingListeners = function () {\n        var _this = this;\n        this.addManagedListener(this.eventService, Events.EVENT_ROW_EDITING_STARTED, function () {\n            _this.isRowEditing = true;\n        });\n        this.addManagedListener(this.eventService, Events.EVENT_ROW_EDITING_STOPPED, function () {\n            var action = new UndoRedoAction(_this.cellValueChanges);\n            _this.pushActionsToUndoStack(action);\n            _this.isRowEditing = false;\n        });\n    };\n    UndoRedoService.prototype.addCellEditingListeners = function () {\n        var _this = this;\n        this.addManagedListener(this.eventService, Events.EVENT_CELL_EDITING_STARTED, function () {\n            _this.isCellEditing = true;\n        });\n        this.addManagedListener(this.eventService, Events.EVENT_CELL_EDITING_STOPPED, function () {\n            _this.isCellEditing = false;\n            var shouldPushAction = !_this.isRowEditing && !_this.isPasting && !_this.isFilling;\n            if (shouldPushAction) {\n                var action = new UndoRedoAction(_this.cellValueChanges);\n                _this.pushActionsToUndoStack(action);\n            }\n        });\n    };\n    UndoRedoService.prototype.addPasteListeners = function () {\n        var _this = this;\n        this.addManagedListener(this.eventService, Events.EVENT_PASTE_START, function () {\n            _this.isPasting = true;\n        });\n        this.addManagedListener(this.eventService, Events.EVENT_PASTE_END, function () {\n            var action = new UndoRedoAction(_this.cellValueChanges);\n            _this.pushActionsToUndoStack(action);\n            _this.isPasting = false;\n        });\n    };\n    UndoRedoService.prototype.addFillListeners = function () {\n        var _this = this;\n        this.addManagedListener(this.eventService, Events.EVENT_FILL_START, function () {\n            _this.isFilling = true;\n        });\n        this.addManagedListener(this.eventService, Events.EVENT_FILL_END, function (event) {\n            var action = new FillUndoRedoAction(_this.cellValueChanges, event.initialRange, event.finalRange);\n            _this.pushActionsToUndoStack(action);\n            _this.isFilling = false;\n        });\n    };\n    UndoRedoService.prototype.pushActionsToUndoStack = function (action) {\n        this.undoStack.push(action);\n        this.cellValueChanges = [];\n        this.redoStack.clear();\n    };\n    UndoRedoService.prototype.getRowNode = function (gridRow) {\n        switch (gridRow.rowPinned) {\n            case Constants.PINNED_TOP:\n                return this.pinnedRowModel.getPinnedTopRowData()[gridRow.rowIndex];\n            case Constants.PINNED_BOTTOM:\n                return this.pinnedRowModel.getPinnedBottomRowData()[gridRow.rowIndex];\n            default:\n                return this.rowModel.getRow(gridRow.rowIndex);\n        }\n    };\n    __decorate([\n        Autowired('gridOptionsWrapper')\n    ], UndoRedoService.prototype, \"gridOptionsWrapper\", void 0);\n    __decorate([\n        Autowired('focusController')\n    ], UndoRedoService.prototype, \"focusController\", void 0);\n    __decorate([\n        Autowired('gridApi')\n    ], UndoRedoService.prototype, \"gridApi\", void 0);\n    __decorate([\n        Autowired('rowModel')\n    ], UndoRedoService.prototype, \"rowModel\", void 0);\n    __decorate([\n        Autowired('pinnedRowModel')\n    ], UndoRedoService.prototype, \"pinnedRowModel\", void 0);\n    __decorate([\n        PostConstruct\n    ], UndoRedoService.prototype, \"init\", null);\n    UndoRedoService = __decorate([\n        Bean('undoRedoService')\n    ], UndoRedoService);\n    return UndoRedoService;\n}(BeanStub));\nexport { UndoRedoService };\n"]},"metadata":{},"sourceType":"module"}