{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (b.hasOwnProperty(p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) {\n    if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  }\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __spreadArrays = this && this.__spreadArrays || function () {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) {\n    s += arguments[i].length;\n  }\n\n  for (var r = Array(s), k = 0, i = 0; i < il; i++) {\n    for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++) {\n      r[k] = a[j];\n    }\n  }\n\n  return r;\n};\n\nimport { Group } from \"../../../scene/group\";\nimport { Selection } from \"../../../scene/selection\";\nimport { Rect } from \"../../../scene/shape/rect\";\nimport { Text } from \"../../../scene/shape/text\";\nimport palette from \"../../palettes\";\nimport { Label } from \"../../label\";\nimport { PointerEvents } from \"../../../scene/node\";\nimport { CartesianSeries } from \"./cartesianSeries\";\nimport { ChartAxisDirection } from \"../../chartAxis\";\nimport { Chart } from \"../../chart\";\nimport { numericExtent, finiteExtent } from \"../../../util/array\";\nimport { toFixed } from \"../../../util/number\";\nimport { reactive } from \"../../../util/observable\";\nimport ticks, { tickStep } from \"../../../util/ticks\";\nvar HistogramSeriesNodeTag;\n\n(function (HistogramSeriesNodeTag) {\n  HistogramSeriesNodeTag[HistogramSeriesNodeTag[\"Bin\"] = 0] = \"Bin\";\n  HistogramSeriesNodeTag[HistogramSeriesNodeTag[\"Label\"] = 1] = \"Label\";\n})(HistogramSeriesNodeTag || (HistogramSeriesNodeTag = {}));\n\nvar HistogramSeriesLabel =\n/** @class */\nfunction (_super) {\n  __extends(HistogramSeriesLabel, _super);\n\n  function HistogramSeriesLabel() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  __decorate([reactive('change')], HistogramSeriesLabel.prototype, \"formatter\", void 0);\n\n  return HistogramSeriesLabel;\n}(Label);\n\nvar defaultBinCount = 10;\nvar aggregationFunctions = {\n  count: function count(bin) {\n    return bin.data.length;\n  },\n  sum: function sum(bin, yKey) {\n    return bin.data.reduce(function (acc, datum) {\n      return acc + datum[yKey];\n    }, 0);\n  },\n  mean: function mean(bin, yKey) {\n    return aggregationFunctions.sum(bin, yKey) / aggregationFunctions.count(bin, yKey);\n  }\n};\n\nvar HistogramBin =\n/** @class */\nfunction () {\n  function HistogramBin(_a) {\n    var domainMin = _a[0],\n        domainMax = _a[1];\n    this.data = [];\n    this.aggregatedValue = 0;\n    this.frequency = 0;\n    this.domain = [domainMin, domainMax];\n  }\n\n  ;\n\n  HistogramBin.prototype.addDatum = function (datum) {\n    this.data.push(datum);\n    this.frequency++;\n  };\n\n  ;\n  Object.defineProperty(HistogramBin.prototype, \"domainWidth\", {\n    get: function get() {\n      var _a = this.domain,\n          domainMin = _a[0],\n          domainMax = _a[1];\n      return domainMax - domainMin;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(HistogramBin.prototype, \"relativeHeight\", {\n    get: function get() {\n      return this.aggregatedValue / this.domainWidth;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  ;\n\n  HistogramBin.prototype.calculateAggregatedValue = function (aggregationName, yKey) {\n    if (!yKey) {\n      // not having a yKey forces us into a frequency plot\n      aggregationName = 'count';\n    }\n\n    var aggregationFunction = aggregationFunctions[aggregationName];\n    this.aggregatedValue = aggregationFunction(this, yKey);\n  };\n\n  HistogramBin.prototype.getY = function (areaPlot) {\n    return areaPlot ? this.relativeHeight : this.aggregatedValue;\n  };\n\n  return HistogramBin;\n}();\n\nexport { HistogramBin };\n;\n\nvar HistogramSeries =\n/** @class */\nfunction (_super) {\n  __extends(HistogramSeries, _super);\n\n  function HistogramSeries() {\n    var _a;\n\n    var _this = _super.call(this) || this; // Need to put column and label nodes into separate groups, because even though label nodes are\n    // created after the column nodes, this only guarantees that labels will always be on top of columns\n    // on the first run. If on the next run more columns are added, they might clip the labels\n    // rendered during the previous run.\n\n\n    _this.rectGroup = _this.group.appendChild(new Group());\n    _this.textGroup = _this.group.appendChild(new Group());\n    _this.rectSelection = Selection.select(_this.rectGroup).selectAll();\n    _this.textSelection = Selection.select(_this.textGroup).selectAll();\n    _this.binnedData = [];\n    _this.xDomain = [];\n    _this.yDomain = [];\n    _this.label = new HistogramSeriesLabel();\n    _this.seriesItemEnabled = true;\n    _this.fill = palette.fills[0];\n    _this.stroke = palette.strokes[0];\n    _this.fillOpacity = 1;\n    _this.strokeOpacity = 1;\n    _this.directionKeys = (_a = {}, _a[ChartAxisDirection.X] = ['xKey'], _a[ChartAxisDirection.Y] = ['yKey'], _a);\n    _this._xKey = '';\n    _this._areaPlot = false;\n    _this._xName = '';\n    _this._yKey = '';\n    _this._yName = '';\n    _this._strokeWidth = 1;\n    _this.highlightStyle = {\n      fill: 'yellow'\n    };\n    _this.label.enabled = false;\n\n    _this.label.addEventListener('change', _this.update, _this);\n\n    return _this;\n  }\n\n  HistogramSeries.prototype.getKeys = function (direction) {\n    var _this = this;\n\n    var directionKeys = this.directionKeys;\n    var keys = directionKeys && directionKeys[direction];\n    var values = [];\n\n    if (keys) {\n      keys.forEach(function (key) {\n        var value = _this[key];\n\n        if (value) {\n          if (Array.isArray(value)) {\n            values.push.apply(values, value);\n          } else {\n            values.push(value);\n          }\n        }\n      });\n    }\n\n    return values;\n  };\n\n  Object.defineProperty(HistogramSeries.prototype, \"xKey\", {\n    get: function get() {\n      return this._xKey;\n    },\n    set: function set(value) {\n      if (this._xKey !== value) {\n        this._xKey = value;\n        this.scheduleData();\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(HistogramSeries.prototype, \"areaPlot\", {\n    get: function get() {\n      return this._areaPlot;\n    },\n    set: function set(c) {\n      this._areaPlot = c;\n      this.scheduleData();\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(HistogramSeries.prototype, \"bins\", {\n    get: function get() {\n      return this._bins;\n    },\n    set: function set(bins) {\n      this._bins = bins;\n      this.scheduleData();\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(HistogramSeries.prototype, \"aggregation\", {\n    get: function get() {\n      return this._aggregation;\n    },\n    set: function set(aggregation) {\n      this._aggregation = aggregation;\n      this.scheduleData();\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(HistogramSeries.prototype, \"binCount\", {\n    get: function get() {\n      return this._binCount;\n    },\n    set: function set(binCount) {\n      this._binCount = binCount;\n      this.scheduleData();\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(HistogramSeries.prototype, \"xName\", {\n    get: function get() {\n      return this._xName;\n    },\n    set: function set(value) {\n      if (this._xName !== value) {\n        this._xName = value;\n        this.update();\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(HistogramSeries.prototype, \"yKey\", {\n    get: function get() {\n      return this._yKey;\n    },\n    set: function set(yKey) {\n      this._yKey = yKey;\n      this.seriesItemEnabled = true;\n      this.scheduleData();\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(HistogramSeries.prototype, \"yName\", {\n    get: function get() {\n      return this._yName;\n    },\n    set: function set(values) {\n      this._yName = values;\n      this.scheduleData();\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(HistogramSeries.prototype, \"strokeWidth\", {\n    get: function get() {\n      return this._strokeWidth;\n    },\n    set: function set(value) {\n      if (this._strokeWidth !== value) {\n        this._strokeWidth = value;\n        this.update();\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(HistogramSeries.prototype, \"shadow\", {\n    get: function get() {\n      return this._shadow;\n    },\n    set: function set(value) {\n      if (this._shadow !== value) {\n        this._shadow = value;\n        this.update();\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  HistogramSeries.prototype.onHighlightChange = function () {\n    this.updateRectNodes();\n  };\n  /*  during processData phase, used to unify different ways of the user specifying\n      the bins. Returns bins in format [[min1, max1], [min2, max2] ... ] */\n\n\n  HistogramSeries.prototype.deriveBins = function () {\n    var _this = this;\n\n    var _a = this,\n        bins = _a.bins,\n        binCount = _a.binCount;\n\n    if (bins && binCount) {\n      console.warn('bin domain and bin count both specified - these are mutually exclusive properties');\n    }\n\n    if (bins) {\n      // we have explicity set bins from user. Use those.\n      return bins;\n    }\n\n    var xData = this.data.map(function (datum) {\n      return datum[_this.xKey];\n    });\n    var xDomain = this.fixNumericExtent(finiteExtent(xData), 'x');\n    var binStarts = ticks(xDomain[0], xDomain[1], this.binCount || defaultBinCount);\n    var binSize = tickStep(xDomain[0], xDomain[1], this.binCount || defaultBinCount);\n    var firstBinEnd = binStarts[0];\n\n    var expandStartToBin = function expandStartToBin(n) {\n      return [n, n + binSize];\n    };\n\n    return __spreadArrays([[firstBinEnd - binSize, firstBinEnd]], binStarts.map(expandStartToBin));\n  };\n\n  HistogramSeries.prototype.placeDataInBins = function (data) {\n    var _this = this;\n\n    var xKey = this.xKey;\n    var derivedBins = this.deriveBins(); // creating a sorted copy allows binning in O(n) rather than O(nÂ²)\n    // but at the expense of more temporary memory\n\n    var sortedData = data.slice().sort(function (a, b) {\n      if (a[xKey] < b[xKey]) {\n        return -1;\n      }\n\n      if (a[xKey] > b[xKey]) {\n        return 1;\n      }\n\n      return 0;\n    });\n    var currentBin = 0;\n    var bins = [new HistogramBin(derivedBins[0])];\n    sortedData.forEach(function (datum) {\n      while (datum[xKey] > derivedBins[currentBin][1]) {\n        currentBin++;\n        bins.push(new HistogramBin(derivedBins[currentBin]));\n      }\n\n      bins[currentBin].addDatum(datum);\n    });\n    bins.forEach(function (b) {\n      return b.calculateAggregatedValue(_this._aggregation, _this.yKey);\n    });\n    return bins;\n  };\n\n  Object.defineProperty(HistogramSeries.prototype, \"xMax\", {\n    get: function get() {\n      var _this = this;\n\n      return this.data && this.data.reduce(function (acc, datum) {\n        return Math.max(acc, datum[_this.xKey]);\n      }, Number.NEGATIVE_INFINITY);\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  HistogramSeries.prototype.processData = function () {\n    var _this = this;\n\n    var _a = this,\n        xKey = _a.xKey,\n        data = _a.data;\n\n    this.binnedData = this.placeDataInBins(xKey && data ? data : []);\n    var yData = this.binnedData.map(function (b) {\n      return b.getY(_this.areaPlot);\n    });\n    var yMinMax = numericExtent(yData);\n    this.yDomain = this.fixNumericExtent([0, yMinMax[1]], 'y');\n    var firstBin = this.binnedData[0];\n    var lastBin = this.binnedData[this.binnedData.length - 1];\n    var xMin = firstBin.domain[0];\n    var xMax = lastBin.domain[1];\n    this.xDomain = [xMin, xMax];\n    this.fireEvent({\n      type: 'dataProcessed'\n    });\n    return true;\n  };\n\n  HistogramSeries.prototype.getDomain = function (direction) {\n    if (direction === ChartAxisDirection.X) {\n      return this.xDomain;\n    } else {\n      return this.yDomain;\n    }\n  };\n\n  HistogramSeries.prototype.fireNodeClickEvent = function (datum) {\n    this.fireEvent({\n      type: 'nodeClick',\n      series: this,\n      datum: datum.seriesDatum,\n      xKey: this.xKey\n    });\n  };\n\n  HistogramSeries.prototype.update = function () {\n    var _a = this,\n        visible = _a.visible,\n        chart = _a.chart,\n        xAxis = _a.xAxis,\n        yAxis = _a.yAxis;\n\n    this.group.visible = visible;\n\n    if (!xAxis || !yAxis || !visible || !chart || chart.layoutPending || chart.dataPending) {\n      return;\n    }\n\n    var nodeData = this.generateNodeData();\n    this.updateRectSelection(nodeData);\n    this.updateRectNodes();\n    this.updateTextSelection(nodeData);\n    this.updateTextNodes();\n  };\n\n  HistogramSeries.prototype.generateNodeData = function () {\n    var _this = this;\n\n    if (!this.seriesItemEnabled) {\n      return [];\n    }\n\n    var _a = this,\n        xScale = _a.xAxis.scale,\n        yScale = _a.yAxis.scale,\n        fill = _a.fill,\n        stroke = _a.stroke,\n        strokeWidth = _a.strokeWidth;\n\n    var nodeData = [];\n\n    var defaultLabelFormatter = function defaultLabelFormatter(b) {\n      return String(b.aggregatedValue);\n    };\n\n    var _b = this.label,\n        _c = _b.formatter,\n        labelFormatter = _c === void 0 ? defaultLabelFormatter : _c,\n        labelFontStyle = _b.fontStyle,\n        labelFontWeight = _b.fontWeight,\n        labelFontSize = _b.fontSize,\n        labelFontFamily = _b.fontFamily,\n        labelColor = _b.color;\n    this.binnedData.forEach(function (binOfData) {\n      var total = binOfData.aggregatedValue,\n          frequency = binOfData.frequency,\n          _a = binOfData.domain,\n          xDomainMin = _a[0],\n          xDomainMax = _a[1],\n          relativeHeight = binOfData.relativeHeight;\n      var xMinPx = xScale.convert(xDomainMin),\n          xMaxPx = xScale.convert(xDomainMax),\n          // note: assuming can't be negative:\n      y = _this.areaPlot ? relativeHeight : _this.yKey ? total : frequency,\n          yZeroPx = yScale.convert(0),\n          yMaxPx = yScale.convert(y),\n          w = xMaxPx - xMinPx,\n          h = Math.abs(yMaxPx - yZeroPx);\n      var selectionDatumLabel = y !== 0 && {\n        text: labelFormatter(binOfData),\n        fontStyle: labelFontStyle,\n        fontWeight: labelFontWeight,\n        fontSize: labelFontSize,\n        fontFamily: labelFontFamily,\n        fill: labelColor,\n        x: xMinPx + w / 2,\n        y: yMaxPx + h / 2\n      };\n      nodeData.push({\n        series: _this,\n        seriesDatum: binOfData,\n        // since each selection is an aggregation of multiple data.\n        x: xMinPx,\n        y: yMaxPx,\n        width: w,\n        height: h,\n        fill: fill,\n        stroke: stroke,\n        strokeWidth: strokeWidth,\n        label: selectionDatumLabel\n      });\n    });\n    return nodeData;\n  };\n\n  HistogramSeries.prototype.updateRectSelection = function (nodeData) {\n    var updateRects = this.rectSelection.setData(nodeData);\n    updateRects.exit.remove();\n    var enterRects = updateRects.enter.append(Rect).each(function (rect) {\n      rect.tag = HistogramSeriesNodeTag.Bin;\n      rect.crisp = true;\n    });\n    this.rectSelection = updateRects.merge(enterRects);\n  };\n\n  HistogramSeries.prototype.updateRectNodes = function () {\n    var highlightedDatum = this.chart.highlightedDatum;\n\n    var _a = this,\n        fillOpacity = _a.fillOpacity,\n        strokeOpacity = _a.strokeOpacity,\n        shadow = _a.shadow,\n        _b = _a.highlightStyle,\n        fill = _b.fill,\n        stroke = _b.stroke;\n\n    this.rectSelection.each(function (rect, datum) {\n      var highlighted = datum === highlightedDatum;\n      rect.x = datum.x;\n      rect.y = datum.y;\n      rect.width = datum.width;\n      rect.height = datum.height;\n      rect.fill = highlighted && fill !== undefined ? fill : datum.fill;\n      rect.stroke = highlighted && stroke !== undefined ? stroke : datum.stroke;\n      rect.fillOpacity = fillOpacity;\n      rect.strokeOpacity = strokeOpacity;\n      rect.strokeWidth = datum.strokeWidth;\n      rect.fillShadow = shadow;\n      rect.visible = datum.height > 0; // prevent stroke from rendering for zero height columns\n    });\n  };\n\n  HistogramSeries.prototype.updateTextSelection = function (nodeData) {\n    var updateTexts = this.textSelection.setData(nodeData);\n    updateTexts.exit.remove();\n    var enterTexts = updateTexts.enter.append(Text).each(function (text) {\n      text.tag = HistogramSeriesNodeTag.Label;\n      text.pointerEvents = PointerEvents.None;\n      text.textAlign = 'center';\n      text.textBaseline = 'middle';\n    });\n    this.textSelection = updateTexts.merge(enterTexts);\n  };\n\n  HistogramSeries.prototype.updateTextNodes = function () {\n    var labelEnabled = this.label.enabled;\n    this.textSelection.each(function (text, datum) {\n      var label = datum.label;\n\n      if (label && labelEnabled) {\n        text.text = label.text;\n        text.x = label.x;\n        text.y = label.y;\n        text.fontStyle = label.fontStyle;\n        text.fontWeight = label.fontWeight;\n        text.fontSize = label.fontSize;\n        text.fontFamily = label.fontFamily;\n        text.fill = label.fill;\n        text.visible = true;\n      } else {\n        text.visible = false;\n      }\n    });\n  };\n\n  HistogramSeries.prototype.getTooltipHtml = function (nodeDatum) {\n    var _a = this,\n        xKey = _a.xKey,\n        yKey = _a.yKey;\n\n    if (!xKey) {\n      return '';\n    }\n\n    var _b = this,\n        xName = _b.xName,\n        yName = _b.yName,\n        fill = _b.fill,\n        tooltipRenderer = _b.tooltipRenderer,\n        aggregation = _b.aggregation;\n\n    var bin = nodeDatum.seriesDatum;\n    var aggregatedValue = bin.aggregatedValue,\n        frequency = bin.frequency,\n        _c = bin.domain,\n        rangeMin = _c[0],\n        rangeMax = _c[1];\n\n    if (tooltipRenderer) {\n      return tooltipRenderer({\n        datum: bin,\n        xKey: xKey,\n        xName: xName,\n        yKey: yKey,\n        yName: yName,\n        color: fill\n      });\n    } else {\n      var titleStyle = \"style=\\\"color: white; background-color: \" + fill + \"\\\"\";\n      var titleString = \"\\n                <div class=\\\"\" + Chart.defaultTooltipClass + \"-title\\\" \" + titleStyle + \">\\n                    \" + (xName || xKey) + \" \" + toFixed(rangeMin) + \" - \" + toFixed(rangeMax) + \"\\n                </div>\";\n      var contentHtml = yKey ? \"<b>\" + (yName || yKey) + \" (\" + aggregation + \")</b>: \" + toFixed(aggregatedValue) + \"<br>\" : '';\n      contentHtml += \"<b>Frequency</b>: \" + frequency;\n      return \"\\n                \" + titleString + \"\\n                <div class=\\\"\" + Chart.defaultTooltipClass + \"-content\\\">\\n                    \" + contentHtml + \"\\n                </div>\";\n    }\n  };\n\n  HistogramSeries.prototype.listSeriesItems = function (legendData) {\n    var _a = this,\n        id = _a.id,\n        data = _a.data,\n        yKey = _a.yKey,\n        yName = _a.yName,\n        seriesItemEnabled = _a.seriesItemEnabled,\n        fill = _a.fill,\n        stroke = _a.stroke,\n        fillOpacity = _a.fillOpacity,\n        strokeOpacity = _a.strokeOpacity;\n\n    if (data && data.length) {\n      legendData.push({\n        id: id,\n        itemId: yKey,\n        enabled: seriesItemEnabled,\n        label: {\n          text: yName || yKey || 'Frequency'\n        },\n        marker: {\n          fill: fill,\n          stroke: stroke,\n          fillOpacity: fillOpacity,\n          strokeOpacity: strokeOpacity\n        }\n      });\n    }\n  };\n\n  HistogramSeries.prototype.toggleSeriesItem = function (itemId, enabled) {\n    if (itemId === this.yKey) {\n      this.seriesItemEnabled = enabled;\n    }\n\n    this.scheduleData();\n  };\n\n  HistogramSeries.className = 'HistogramSeries';\n  HistogramSeries.type = 'histogram';\n\n  __decorate([reactive('dataChange')], HistogramSeries.prototype, \"fill\", void 0);\n\n  __decorate([reactive('dataChange')], HistogramSeries.prototype, \"stroke\", void 0);\n\n  __decorate([reactive('layoutChange')], HistogramSeries.prototype, \"fillOpacity\", void 0);\n\n  __decorate([reactive('layoutChange')], HistogramSeries.prototype, \"strokeOpacity\", void 0);\n\n  return HistogramSeries;\n}(CartesianSeries);\n\nexport { HistogramSeries };","map":{"version":3,"sources":["/Users/fouaddakhel/Projects/Nana/ReactJS/supermarket_dashboard/supermarket_dashboard/node_modules/ag-charts-community/dist/es6/chart/series/cartesian/histogramSeries.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","__decorate","decorators","target","key","desc","c","arguments","length","r","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","__spreadArrays","s","il","k","a","j","jl","Group","Selection","Rect","Text","palette","Label","PointerEvents","CartesianSeries","ChartAxisDirection","Chart","numericExtent","finiteExtent","toFixed","reactive","ticks","tickStep","HistogramSeriesNodeTag","HistogramSeriesLabel","_super","apply","defaultBinCount","aggregationFunctions","count","bin","data","sum","yKey","reduce","acc","datum","mean","HistogramBin","_a","domainMin","domainMax","aggregatedValue","frequency","domain","addDatum","push","get","enumerable","configurable","domainWidth","calculateAggregatedValue","aggregationName","aggregationFunction","getY","areaPlot","relativeHeight","HistogramSeries","_this","call","rectGroup","group","appendChild","textGroup","rectSelection","select","selectAll","textSelection","binnedData","xDomain","yDomain","label","seriesItemEnabled","fill","fills","stroke","strokes","fillOpacity","strokeOpacity","directionKeys","X","Y","_xKey","_areaPlot","_xName","_yKey","_yName","_strokeWidth","highlightStyle","enabled","addEventListener","update","getKeys","direction","keys","values","forEach","value","isArray","set","scheduleData","_bins","bins","_aggregation","aggregation","_binCount","binCount","_shadow","onHighlightChange","updateRectNodes","deriveBins","console","warn","xData","map","xKey","fixNumericExtent","binStarts","binSize","firstBinEnd","expandStartToBin","n","placeDataInBins","derivedBins","sortedData","slice","sort","currentBin","Math","max","Number","NEGATIVE_INFINITY","processData","yData","yMinMax","firstBin","lastBin","xMin","xMax","fireEvent","type","getDomain","fireNodeClickEvent","series","seriesDatum","visible","chart","xAxis","yAxis","layoutPending","dataPending","nodeData","generateNodeData","updateRectSelection","updateTextSelection","updateTextNodes","xScale","scale","yScale","strokeWidth","defaultLabelFormatter","String","_b","_c","formatter","labelFormatter","labelFontStyle","fontStyle","labelFontWeight","fontWeight","labelFontSize","fontSize","labelFontFamily","fontFamily","labelColor","color","binOfData","total","xDomainMin","xDomainMax","xMinPx","convert","xMaxPx","y","yZeroPx","yMaxPx","w","h","abs","selectionDatumLabel","text","x","width","height","updateRects","setData","exit","remove","enterRects","enter","append","each","rect","tag","Bin","crisp","merge","highlightedDatum","shadow","highlighted","undefined","fillShadow","updateTexts","enterTexts","pointerEvents","None","textAlign","textBaseline","labelEnabled","getTooltipHtml","nodeDatum","xName","yName","tooltipRenderer","rangeMin","rangeMax","titleStyle","titleString","defaultTooltipClass","contentHtml","listSeriesItems","legendData","id","itemId","marker","toggleSeriesItem","className"],"mappings":"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","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\nimport { Group } from \"../../../scene/group\";\nimport { Selection } from \"../../../scene/selection\";\nimport { Rect } from \"../../../scene/shape/rect\";\nimport { Text } from \"../../../scene/shape/text\";\nimport palette from \"../../palettes\";\nimport { Label } from \"../../label\";\nimport { PointerEvents } from \"../../../scene/node\";\nimport { CartesianSeries } from \"./cartesianSeries\";\nimport { ChartAxisDirection } from \"../../chartAxis\";\nimport { Chart } from \"../../chart\";\nimport { numericExtent, finiteExtent } from \"../../../util/array\";\nimport { toFixed } from \"../../../util/number\";\nimport { reactive } from \"../../../util/observable\";\nimport ticks, { tickStep } from \"../../../util/ticks\";\nvar HistogramSeriesNodeTag;\n(function (HistogramSeriesNodeTag) {\n    HistogramSeriesNodeTag[HistogramSeriesNodeTag[\"Bin\"] = 0] = \"Bin\";\n    HistogramSeriesNodeTag[HistogramSeriesNodeTag[\"Label\"] = 1] = \"Label\";\n})(HistogramSeriesNodeTag || (HistogramSeriesNodeTag = {}));\nvar HistogramSeriesLabel = /** @class */ (function (_super) {\n    __extends(HistogramSeriesLabel, _super);\n    function HistogramSeriesLabel() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        reactive('change')\n    ], HistogramSeriesLabel.prototype, \"formatter\", void 0);\n    return HistogramSeriesLabel;\n}(Label));\nvar defaultBinCount = 10;\nvar aggregationFunctions = {\n    count: function (bin) { return bin.data.length; },\n    sum: function (bin, yKey) { return bin.data.reduce(function (acc, datum) { return acc + datum[yKey]; }, 0); },\n    mean: function (bin, yKey) { return aggregationFunctions.sum(bin, yKey) / aggregationFunctions.count(bin, yKey); }\n};\nvar HistogramBin = /** @class */ (function () {\n    function HistogramBin(_a) {\n        var domainMin = _a[0], domainMax = _a[1];\n        this.data = [];\n        this.aggregatedValue = 0;\n        this.frequency = 0;\n        this.domain = [domainMin, domainMax];\n    }\n    ;\n    HistogramBin.prototype.addDatum = function (datum) {\n        this.data.push(datum);\n        this.frequency++;\n    };\n    ;\n    Object.defineProperty(HistogramBin.prototype, \"domainWidth\", {\n        get: function () {\n            var _a = this.domain, domainMin = _a[0], domainMax = _a[1];\n            return domainMax - domainMin;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(HistogramBin.prototype, \"relativeHeight\", {\n        get: function () {\n            return this.aggregatedValue / this.domainWidth;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ;\n    HistogramBin.prototype.calculateAggregatedValue = function (aggregationName, yKey) {\n        if (!yKey) {\n            // not having a yKey forces us into a frequency plot\n            aggregationName = 'count';\n        }\n        var aggregationFunction = aggregationFunctions[aggregationName];\n        this.aggregatedValue = aggregationFunction(this, yKey);\n    };\n    HistogramBin.prototype.getY = function (areaPlot) {\n        return areaPlot ? this.relativeHeight : this.aggregatedValue;\n    };\n    return HistogramBin;\n}());\nexport { HistogramBin };\n;\nvar HistogramSeries = /** @class */ (function (_super) {\n    __extends(HistogramSeries, _super);\n    function HistogramSeries() {\n        var _a;\n        var _this = _super.call(this) || this;\n        // Need to put column and label nodes into separate groups, because even though label nodes are\n        // created after the column nodes, this only guarantees that labels will always be on top of columns\n        // on the first run. If on the next run more columns are added, they might clip the labels\n        // rendered during the previous run.\n        _this.rectGroup = _this.group.appendChild(new Group());\n        _this.textGroup = _this.group.appendChild(new Group());\n        _this.rectSelection = Selection.select(_this.rectGroup).selectAll();\n        _this.textSelection = Selection.select(_this.textGroup).selectAll();\n        _this.binnedData = [];\n        _this.xDomain = [];\n        _this.yDomain = [];\n        _this.label = new HistogramSeriesLabel();\n        _this.seriesItemEnabled = true;\n        _this.fill = palette.fills[0];\n        _this.stroke = palette.strokes[0];\n        _this.fillOpacity = 1;\n        _this.strokeOpacity = 1;\n        _this.directionKeys = (_a = {},\n            _a[ChartAxisDirection.X] = ['xKey'],\n            _a[ChartAxisDirection.Y] = ['yKey'],\n            _a);\n        _this._xKey = '';\n        _this._areaPlot = false;\n        _this._xName = '';\n        _this._yKey = '';\n        _this._yName = '';\n        _this._strokeWidth = 1;\n        _this.highlightStyle = { fill: 'yellow' };\n        _this.label.enabled = false;\n        _this.label.addEventListener('change', _this.update, _this);\n        return _this;\n    }\n    HistogramSeries.prototype.getKeys = function (direction) {\n        var _this = this;\n        var directionKeys = this.directionKeys;\n        var keys = directionKeys && directionKeys[direction];\n        var values = [];\n        if (keys) {\n            keys.forEach(function (key) {\n                var value = _this[key];\n                if (value) {\n                    if (Array.isArray(value)) {\n                        values.push.apply(values, value);\n                    }\n                    else {\n                        values.push(value);\n                    }\n                }\n            });\n        }\n        return values;\n    };\n    Object.defineProperty(HistogramSeries.prototype, \"xKey\", {\n        get: function () {\n            return this._xKey;\n        },\n        set: function (value) {\n            if (this._xKey !== value) {\n                this._xKey = value;\n                this.scheduleData();\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(HistogramSeries.prototype, \"areaPlot\", {\n        get: function () {\n            return this._areaPlot;\n        },\n        set: function (c) {\n            this._areaPlot = c;\n            this.scheduleData();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(HistogramSeries.prototype, \"bins\", {\n        get: function () {\n            return this._bins;\n        },\n        set: function (bins) {\n            this._bins = bins;\n            this.scheduleData();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(HistogramSeries.prototype, \"aggregation\", {\n        get: function () {\n            return this._aggregation;\n        },\n        set: function (aggregation) {\n            this._aggregation = aggregation;\n            this.scheduleData();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(HistogramSeries.prototype, \"binCount\", {\n        get: function () {\n            return this._binCount;\n        },\n        set: function (binCount) {\n            this._binCount = binCount;\n            this.scheduleData();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(HistogramSeries.prototype, \"xName\", {\n        get: function () {\n            return this._xName;\n        },\n        set: function (value) {\n            if (this._xName !== value) {\n                this._xName = value;\n                this.update();\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(HistogramSeries.prototype, \"yKey\", {\n        get: function () {\n            return this._yKey;\n        },\n        set: function (yKey) {\n            this._yKey = yKey;\n            this.seriesItemEnabled = true;\n            this.scheduleData();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(HistogramSeries.prototype, \"yName\", {\n        get: function () {\n            return this._yName;\n        },\n        set: function (values) {\n            this._yName = values;\n            this.scheduleData();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(HistogramSeries.prototype, \"strokeWidth\", {\n        get: function () {\n            return this._strokeWidth;\n        },\n        set: function (value) {\n            if (this._strokeWidth !== value) {\n                this._strokeWidth = value;\n                this.update();\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(HistogramSeries.prototype, \"shadow\", {\n        get: function () {\n            return this._shadow;\n        },\n        set: function (value) {\n            if (this._shadow !== value) {\n                this._shadow = value;\n                this.update();\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    HistogramSeries.prototype.onHighlightChange = function () {\n        this.updateRectNodes();\n    };\n    /*  during processData phase, used to unify different ways of the user specifying\n        the bins. Returns bins in format [[min1, max1], [min2, max2] ... ] */\n    HistogramSeries.prototype.deriveBins = function () {\n        var _this = this;\n        var _a = this, bins = _a.bins, binCount = _a.binCount;\n        if (bins && binCount) {\n            console.warn('bin domain and bin count both specified - these are mutually exclusive properties');\n        }\n        if (bins) {\n            // we have explicity set bins from user. Use those.\n            return bins;\n        }\n        var xData = this.data.map(function (datum) { return datum[_this.xKey]; });\n        var xDomain = this.fixNumericExtent(finiteExtent(xData), 'x');\n        var binStarts = ticks(xDomain[0], xDomain[1], this.binCount || defaultBinCount);\n        var binSize = tickStep(xDomain[0], xDomain[1], this.binCount || defaultBinCount);\n        var firstBinEnd = binStarts[0];\n        var expandStartToBin = function (n) { return [n, n + binSize]; };\n        return __spreadArrays([\n            [firstBinEnd - binSize, firstBinEnd]\n        ], binStarts.map(expandStartToBin));\n    };\n    HistogramSeries.prototype.placeDataInBins = function (data) {\n        var _this = this;\n        var xKey = this.xKey;\n        var derivedBins = this.deriveBins();\n        // creating a sorted copy allows binning in O(n) rather than O(nÂ²)\n        // but at the expense of more temporary memory\n        var sortedData = data.slice().sort(function (a, b) {\n            if (a[xKey] < b[xKey]) {\n                return -1;\n            }\n            if (a[xKey] > b[xKey]) {\n                return 1;\n            }\n            return 0;\n        });\n        var currentBin = 0;\n        var bins = [new HistogramBin(derivedBins[0])];\n        sortedData.forEach(function (datum) {\n            while (datum[xKey] > derivedBins[currentBin][1]) {\n                currentBin++;\n                bins.push(new HistogramBin(derivedBins[currentBin]));\n            }\n            bins[currentBin].addDatum(datum);\n        });\n        bins.forEach(function (b) { return b.calculateAggregatedValue(_this._aggregation, _this.yKey); });\n        return bins;\n    };\n    Object.defineProperty(HistogramSeries.prototype, \"xMax\", {\n        get: function () {\n            var _this = this;\n            return this.data && this.data.reduce(function (acc, datum) {\n                return Math.max(acc, datum[_this.xKey]);\n            }, Number.NEGATIVE_INFINITY);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    HistogramSeries.prototype.processData = function () {\n        var _this = this;\n        var _a = this, xKey = _a.xKey, data = _a.data;\n        this.binnedData = this.placeDataInBins(xKey && data ? data : []);\n        var yData = this.binnedData.map(function (b) { return b.getY(_this.areaPlot); });\n        var yMinMax = numericExtent(yData);\n        this.yDomain = this.fixNumericExtent([0, yMinMax[1]], 'y');\n        var firstBin = this.binnedData[0];\n        var lastBin = this.binnedData[this.binnedData.length - 1];\n        var xMin = firstBin.domain[0];\n        var xMax = lastBin.domain[1];\n        this.xDomain = [xMin, xMax];\n        this.fireEvent({ type: 'dataProcessed' });\n        return true;\n    };\n    HistogramSeries.prototype.getDomain = function (direction) {\n        if (direction === ChartAxisDirection.X) {\n            return this.xDomain;\n        }\n        else {\n            return this.yDomain;\n        }\n    };\n    HistogramSeries.prototype.fireNodeClickEvent = function (datum) {\n        this.fireEvent({\n            type: 'nodeClick',\n            series: this,\n            datum: datum.seriesDatum,\n            xKey: this.xKey\n        });\n    };\n    HistogramSeries.prototype.update = function () {\n        var _a = this, visible = _a.visible, chart = _a.chart, xAxis = _a.xAxis, yAxis = _a.yAxis;\n        this.group.visible = visible;\n        if (!xAxis || !yAxis || !visible || !chart || chart.layoutPending || chart.dataPending) {\n            return;\n        }\n        var nodeData = this.generateNodeData();\n        this.updateRectSelection(nodeData);\n        this.updateRectNodes();\n        this.updateTextSelection(nodeData);\n        this.updateTextNodes();\n    };\n    HistogramSeries.prototype.generateNodeData = function () {\n        var _this = this;\n        if (!this.seriesItemEnabled) {\n            return [];\n        }\n        var _a = this, xScale = _a.xAxis.scale, yScale = _a.yAxis.scale, fill = _a.fill, stroke = _a.stroke, strokeWidth = _a.strokeWidth;\n        var nodeData = [];\n        var defaultLabelFormatter = function (b) { return String(b.aggregatedValue); };\n        var _b = this.label, _c = _b.formatter, labelFormatter = _c === void 0 ? defaultLabelFormatter : _c, labelFontStyle = _b.fontStyle, labelFontWeight = _b.fontWeight, labelFontSize = _b.fontSize, labelFontFamily = _b.fontFamily, labelColor = _b.color;\n        this.binnedData.forEach(function (binOfData) {\n            var total = binOfData.aggregatedValue, frequency = binOfData.frequency, _a = binOfData.domain, xDomainMin = _a[0], xDomainMax = _a[1], relativeHeight = binOfData.relativeHeight;\n            var xMinPx = xScale.convert(xDomainMin), xMaxPx = xScale.convert(xDomainMax), \n            // note: assuming can't be negative:\n            y = _this.areaPlot ? relativeHeight : (_this.yKey ? total : frequency), yZeroPx = yScale.convert(0), yMaxPx = yScale.convert(y), w = xMaxPx - xMinPx, h = Math.abs(yMaxPx - yZeroPx);\n            var selectionDatumLabel = y !== 0 && {\n                text: labelFormatter(binOfData),\n                fontStyle: labelFontStyle,\n                fontWeight: labelFontWeight,\n                fontSize: labelFontSize,\n                fontFamily: labelFontFamily,\n                fill: labelColor,\n                x: xMinPx + w / 2,\n                y: yMaxPx + h / 2\n            };\n            nodeData.push({\n                series: _this,\n                seriesDatum: binOfData,\n                // since each selection is an aggregation of multiple data.\n                x: xMinPx,\n                y: yMaxPx,\n                width: w,\n                height: h,\n                fill: fill,\n                stroke: stroke,\n                strokeWidth: strokeWidth,\n                label: selectionDatumLabel,\n            });\n        });\n        return nodeData;\n    };\n    HistogramSeries.prototype.updateRectSelection = function (nodeData) {\n        var updateRects = this.rectSelection.setData(nodeData);\n        updateRects.exit.remove();\n        var enterRects = updateRects.enter.append(Rect).each(function (rect) {\n            rect.tag = HistogramSeriesNodeTag.Bin;\n            rect.crisp = true;\n        });\n        this.rectSelection = updateRects.merge(enterRects);\n    };\n    HistogramSeries.prototype.updateRectNodes = function () {\n        var highlightedDatum = this.chart.highlightedDatum;\n        var _a = this, fillOpacity = _a.fillOpacity, strokeOpacity = _a.strokeOpacity, shadow = _a.shadow, _b = _a.highlightStyle, fill = _b.fill, stroke = _b.stroke;\n        this.rectSelection.each(function (rect, datum) {\n            var highlighted = datum === highlightedDatum;\n            rect.x = datum.x;\n            rect.y = datum.y;\n            rect.width = datum.width;\n            rect.height = datum.height;\n            rect.fill = highlighted && fill !== undefined ? fill : datum.fill;\n            rect.stroke = highlighted && stroke !== undefined ? stroke : datum.stroke;\n            rect.fillOpacity = fillOpacity;\n            rect.strokeOpacity = strokeOpacity;\n            rect.strokeWidth = datum.strokeWidth;\n            rect.fillShadow = shadow;\n            rect.visible = datum.height > 0; // prevent stroke from rendering for zero height columns\n        });\n    };\n    HistogramSeries.prototype.updateTextSelection = function (nodeData) {\n        var updateTexts = this.textSelection.setData(nodeData);\n        updateTexts.exit.remove();\n        var enterTexts = updateTexts.enter.append(Text).each(function (text) {\n            text.tag = HistogramSeriesNodeTag.Label;\n            text.pointerEvents = PointerEvents.None;\n            text.textAlign = 'center';\n            text.textBaseline = 'middle';\n        });\n        this.textSelection = updateTexts.merge(enterTexts);\n    };\n    HistogramSeries.prototype.updateTextNodes = function () {\n        var labelEnabled = this.label.enabled;\n        this.textSelection.each(function (text, datum) {\n            var label = datum.label;\n            if (label && labelEnabled) {\n                text.text = label.text;\n                text.x = label.x;\n                text.y = label.y;\n                text.fontStyle = label.fontStyle;\n                text.fontWeight = label.fontWeight;\n                text.fontSize = label.fontSize;\n                text.fontFamily = label.fontFamily;\n                text.fill = label.fill;\n                text.visible = true;\n            }\n            else {\n                text.visible = false;\n            }\n        });\n    };\n    HistogramSeries.prototype.getTooltipHtml = function (nodeDatum) {\n        var _a = this, xKey = _a.xKey, yKey = _a.yKey;\n        if (!xKey) {\n            return '';\n        }\n        var _b = this, xName = _b.xName, yName = _b.yName, fill = _b.fill, tooltipRenderer = _b.tooltipRenderer, aggregation = _b.aggregation;\n        var bin = nodeDatum.seriesDatum;\n        var aggregatedValue = bin.aggregatedValue, frequency = bin.frequency, _c = bin.domain, rangeMin = _c[0], rangeMax = _c[1];\n        if (tooltipRenderer) {\n            return tooltipRenderer({\n                datum: bin,\n                xKey: xKey,\n                xName: xName,\n                yKey: yKey,\n                yName: yName,\n                color: fill\n            });\n        }\n        else {\n            var titleStyle = \"style=\\\"color: white; background-color: \" + fill + \"\\\"\";\n            var titleString = \"\\n                <div class=\\\"\" + Chart.defaultTooltipClass + \"-title\\\" \" + titleStyle + \">\\n                    \" + (xName || xKey) + \" \" + toFixed(rangeMin) + \" - \" + toFixed(rangeMax) + \"\\n                </div>\";\n            var contentHtml = yKey ?\n                \"<b>\" + (yName || yKey) + \" (\" + aggregation + \")</b>: \" + toFixed(aggregatedValue) + \"<br>\" :\n                '';\n            contentHtml += \"<b>Frequency</b>: \" + frequency;\n            return \"\\n                \" + titleString + \"\\n                <div class=\\\"\" + Chart.defaultTooltipClass + \"-content\\\">\\n                    \" + contentHtml + \"\\n                </div>\";\n        }\n    };\n    HistogramSeries.prototype.listSeriesItems = function (legendData) {\n        var _a = this, id = _a.id, data = _a.data, yKey = _a.yKey, yName = _a.yName, seriesItemEnabled = _a.seriesItemEnabled, fill = _a.fill, stroke = _a.stroke, fillOpacity = _a.fillOpacity, strokeOpacity = _a.strokeOpacity;\n        if (data && data.length) {\n            legendData.push({\n                id: id,\n                itemId: yKey,\n                enabled: seriesItemEnabled,\n                label: {\n                    text: yName || yKey || 'Frequency'\n                },\n                marker: {\n                    fill: fill,\n                    stroke: stroke,\n                    fillOpacity: fillOpacity,\n                    strokeOpacity: strokeOpacity\n                }\n            });\n        }\n    };\n    HistogramSeries.prototype.toggleSeriesItem = function (itemId, enabled) {\n        if (itemId === this.yKey) {\n            this.seriesItemEnabled = enabled;\n        }\n        this.scheduleData();\n    };\n    HistogramSeries.className = 'HistogramSeries';\n    HistogramSeries.type = 'histogram';\n    __decorate([\n        reactive('dataChange')\n    ], HistogramSeries.prototype, \"fill\", void 0);\n    __decorate([\n        reactive('dataChange')\n    ], HistogramSeries.prototype, \"stroke\", void 0);\n    __decorate([\n        reactive('layoutChange')\n    ], HistogramSeries.prototype, \"fillOpacity\", void 0);\n    __decorate([\n        reactive('layoutChange')\n    ], HistogramSeries.prototype, \"strokeOpacity\", void 0);\n    return HistogramSeries;\n}(CartesianSeries));\nexport { HistogramSeries };\n"]},"metadata":{},"sourceType":"module"}