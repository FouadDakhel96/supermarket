{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (b.hasOwnProperty(p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) {\n    if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  }\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nimport { Autowired, Constants, ManagedFocusComponent, _ } from \"@ag-grid-community/core\";\nimport { MenuItemComponent } from \"./menuItemComponent\";\n\nvar MenuList =\n/** @class */\nfunction (_super) {\n  __extends(MenuList, _super);\n\n  function MenuList() {\n    var _this = _super.call(this, MenuList.TEMPLATE) || this;\n\n    _this.menuItems = [];\n    _this.subMenuHideTimer = 0;\n    _this.subMenuShowTimer = 0;\n    _this.removeChildFuncs = [];\n    return _this;\n  }\n\n  MenuList.prototype.onTabKeyDown = function (e) {\n    var parent = this.getParentComponent();\n    var isManaged = parent && parent instanceof ManagedFocusComponent;\n\n    if (!isManaged) {\n      e.preventDefault();\n    }\n\n    if (e.shiftKey) {\n      this.closeIfIsChild(e);\n    }\n  };\n\n  MenuList.prototype.handleKeyDown = function (e) {\n    switch (e.keyCode) {\n      case Constants.KEY_UP:\n      case Constants.KEY_RIGHT:\n      case Constants.KEY_DOWN:\n      case Constants.KEY_LEFT:\n        e.preventDefault();\n        this.handleNavKey(e.keyCode);\n        break;\n\n      case Constants.KEY_ESCAPE:\n        var topMenu = this.findTopMenu();\n\n        if (topMenu) {\n          topMenu.getGui().focus();\n        }\n\n        break;\n    }\n  };\n\n  MenuList.prototype.isFocusableContainer = function () {\n    return true;\n  };\n\n  MenuList.prototype.clearActiveItem = function () {\n    this.deactivateItem();\n    this.removeChildPopup();\n  };\n\n  MenuList.prototype.addMenuItems = function (menuItems) {\n    var _this = this;\n\n    if (!menuItems || _.missing(menuItems)) {\n      return;\n    }\n\n    menuItems.forEach(function (menuItemOrString) {\n      if (menuItemOrString === 'separator') {\n        _this.addSeparator();\n      } else if (typeof menuItemOrString === 'string') {\n        console.warn(\"ag-Grid: unrecognised menu item \" + menuItemOrString);\n      } else {\n        var menuItem = menuItemOrString;\n\n        _this.addItem(menuItem);\n      }\n    });\n  };\n\n  MenuList.prototype.addItem = function (menuItemDef) {\n    var _this = this;\n\n    var cMenuItem = this.createManagedBean(new MenuItemComponent(menuItemDef));\n    this.menuItems.push({\n      comp: cMenuItem,\n      params: menuItemDef\n    });\n    this.appendChild(cMenuItem.getGui());\n    cMenuItem.addEventListener(MenuItemComponent.EVENT_ITEM_SELECTED, function (event) {\n      if (menuItemDef.subMenu && !menuItemDef.action) {\n        _this.showChildMenu(cMenuItem, menuItemDef);\n\n        if (event.event.type === 'keydown') {\n          _this.subMenuComp.activateFirstItem();\n        }\n      } else {\n        _this.dispatchEvent(event);\n      }\n    });\n    cMenuItem.setParentComponent(this);\n\n    var handleMouseEnter = function handleMouseEnter(cMenuItem, menuItemParams) {\n      if (_this.subMenuShowTimer) {\n        window.clearTimeout(_this.subMenuShowTimer);\n        _this.subMenuShowTimer = 0;\n      }\n\n      if (!_this.subMenuHideTimer) {\n        _this.mouseEnterItem(cMenuItem, menuItemParams);\n      } else {\n        _this.subMenuShowTimer = window.setTimeout(function () {\n          handleMouseEnter(cMenuItem, menuItemParams);\n        }, MenuList.HIDE_MENU_DELAY);\n      }\n    };\n\n    var handleMouseLeave = function handleMouseLeave(e, cMenuItem, menuItemParams) {\n      if (_this.subMenuParentComp === cMenuItem) {\n        if (_this.subMenuHideTimer) {\n          return;\n        }\n\n        _this.subMenuHideTimer = window.setTimeout(function () {\n          return _this.mouseLeaveItem(e, cMenuItem, menuItemParams);\n        }, MenuList.HIDE_MENU_DELAY);\n      } else if (!_this.subMenuHideTimer) {\n        _this.mouseLeaveItem(e, cMenuItem, menuItemParams);\n      }\n    };\n\n    cMenuItem.addGuiEventListener('mouseenter', function () {\n      return handleMouseEnter(cMenuItem, menuItemDef);\n    });\n    cMenuItem.addGuiEventListener('mouseleave', function (e) {\n      return handleMouseLeave(e, cMenuItem, menuItemDef);\n    });\n  };\n\n  MenuList.prototype.activateFirstItem = function () {\n    var item = this.menuItems.filter(function (item) {\n      return !item.params.disabled;\n    })[0];\n\n    if (!item) {\n      return;\n    }\n\n    this.activateItem(item.comp, item.params);\n  };\n\n  MenuList.prototype.mouseEnterItem = function (menuItem, menuItemParams) {\n    this.subMenuShowTimer = 0;\n    this.activateItem(menuItem, menuItemParams, true);\n  };\n\n  MenuList.prototype.mouseLeaveItem = function (e, menuItem, menuItemParams) {\n    var isParent = this.subMenuComp && this.subMenuComp.getParentComponent() === menuItem;\n    var subMenuGui = isParent && this.subMenuComp.getGui();\n    var relatedTarget = e.relatedTarget;\n    this.subMenuHideTimer = 0;\n\n    if (relatedTarget && subMenuGui && (subMenuGui.contains(relatedTarget) || relatedTarget.contains(subMenuGui))) {\n      return;\n    }\n\n    this.deactivateItem(menuItem, menuItemParams);\n  };\n\n  MenuList.prototype.activateItem = function (menuItem, menuItemParams, openSubMenu) {\n    if (menuItemParams.disabled) {\n      this.deactivateItem();\n      return;\n    }\n\n    if (this.activeMenuItemParams !== menuItemParams) {\n      this.removeChildPopup();\n    }\n\n    if (this.activeMenuItem && this.activeMenuItem !== menuItem) {\n      this.deactivateItem();\n    }\n\n    this.activeMenuItemParams = menuItemParams;\n    this.activeMenuItem = menuItem;\n    var eGui = menuItem.getGui();\n\n    _.addCssClass(eGui, 'ag-menu-option-active');\n\n    eGui.focus();\n\n    if (openSubMenu && menuItemParams.subMenu) {\n      this.addHoverForChildPopup(menuItem, menuItemParams);\n    }\n  };\n\n  MenuList.prototype.deactivateItem = function (menuItem, menuItemParams) {\n    if (!menuItem && this.activeMenuItem) {\n      menuItem = this.activeMenuItem;\n      menuItemParams = this.activeMenuItemParams;\n    }\n\n    if (!menuItem || menuItemParams.disabled) {\n      return;\n    }\n\n    _.removeCssClass(menuItem.getGui(), 'ag-menu-option-active');\n\n    if (this.subMenuParentComp === menuItem) {\n      this.removeChildPopup();\n    }\n\n    this.activeMenuItem = null;\n    this.activeMenuItemParams = null;\n  };\n\n  MenuList.prototype.findTopMenu = function () {\n    var parent = this.getParentComponent();\n\n    if (!parent && this instanceof MenuList) {\n      return this;\n    }\n\n    while (true) {\n      var nextParent = parent && parent.getParentComponent && parent.getParentComponent();\n\n      if (!nextParent || !(nextParent instanceof MenuList || nextParent instanceof MenuItemComponent)) {\n        break;\n      }\n\n      parent = nextParent;\n    }\n\n    return parent instanceof MenuList ? parent : undefined;\n  };\n\n  MenuList.prototype.handleNavKey = function (key) {\n    switch (key) {\n      case Constants.KEY_UP:\n      case Constants.KEY_DOWN:\n        var nextItem = this.findNextItem(key === Constants.KEY_UP);\n\n        if (nextItem && nextItem.comp !== this.activeMenuItem) {\n          this.deactivateItem();\n          this.activateItem(nextItem.comp, nextItem.params);\n        }\n\n        return;\n    }\n\n    if (!this.activateItem) {\n      return;\n    }\n\n    var left = this.gridOptionsWrapper.isEnableRtl() ? Constants.KEY_RIGHT : Constants.KEY_LEFT;\n\n    if (key === left) {\n      this.closeIfIsChild();\n    } else {\n      this.openChild();\n    }\n  };\n\n  MenuList.prototype.closeIfIsChild = function (e) {\n    var parentItem = this.getParentComponent();\n\n    if (parentItem && parentItem instanceof MenuItemComponent) {\n      if (e) {\n        e.preventDefault();\n      }\n\n      var parentMenuList = parentItem.getParentComponent();\n      parentItem.getGui().focus();\n      parentMenuList.removeChildPopup();\n    }\n  };\n\n  MenuList.prototype.openChild = function () {\n    var _this = this;\n\n    if (this.activeMenuItemParams && this.activeMenuItemParams.subMenu) {\n      this.showChildMenu(this.activeMenuItem, this.activeMenuItemParams);\n      setTimeout(function () {\n        var subMenu = _this.subMenuComp;\n        subMenu.activateFirstItem();\n      }, 0);\n    }\n  };\n\n  MenuList.prototype.findNextItem = function (up) {\n    var items = this.menuItems.filter(function (item) {\n      return !item.params.disabled;\n    });\n\n    if (!items.length) {\n      return;\n    }\n\n    if (!this.activeMenuItem) {\n      return up ? _.last(items) : items[0];\n    }\n\n    if (up) {\n      items.reverse();\n    }\n\n    var nextItem;\n    var foundCurrent = false;\n\n    for (var i = 0; i < items.length; i++) {\n      var item = items[i];\n\n      if (!foundCurrent) {\n        if (item.comp === this.activeMenuItem) {\n          foundCurrent = true;\n        }\n\n        continue;\n      }\n\n      nextItem = item;\n      break;\n    }\n\n    return nextItem || {\n      comp: this.activeMenuItem,\n      params: this.activeMenuItemParams\n    };\n  };\n\n  MenuList.prototype.addHoverForChildPopup = function (menuItemComp, menuItemDef) {\n    var _this = this;\n\n    window.setTimeout(function () {\n      var showingThisMenu = _this.subMenuParentComp === menuItemComp;\n      var menuItemIsActive = _this.activeMenuItem === menuItemComp;\n\n      if (_this.isAlive() && menuItemIsActive && !showingThisMenu) {\n        _this.showChildMenu(menuItemComp, menuItemDef);\n      }\n    }, 300);\n  };\n\n  MenuList.prototype.addSeparator = function () {\n    var template = _.loadTemplate(MenuList.SEPARATOR_TEMPLATE);\n\n    this.appendChild(template);\n  };\n\n  MenuList.prototype.showChildMenu = function (menuItemComp, menuItemDef) {\n    var _this = this;\n\n    this.removeChildPopup();\n    var childMenu = new MenuList();\n    childMenu.setParentComponent(menuItemComp);\n    this.getContext().createBean(childMenu);\n    childMenu.addMenuItems(menuItemDef.subMenu);\n\n    var ePopup = _.loadTemplate('<div class=\"ag-menu\" tabindex=\"-1\"></div>');\n\n    ePopup.appendChild(childMenu.getGui());\n    var hidePopupFunc = this.popupService.addAsModalPopup(ePopup, false);\n    this.popupService.positionPopupForMenu({\n      eventSource: menuItemComp.getGui(),\n      ePopup: ePopup\n    });\n    this.subMenuParentComp = menuItemComp;\n    this.subMenuComp = childMenu;\n    childMenu.addManagedListener(ePopup, 'mouseover', function () {\n      if (_this.subMenuHideTimer && menuItemComp === _this.subMenuParentComp) {\n        window.clearTimeout(_this.subMenuHideTimer);\n        window.clearTimeout(_this.subMenuShowTimer);\n        _this.subMenuHideTimer = 0;\n        _this.subMenuShowTimer = 0;\n      }\n    });\n\n    var selectedListener = function selectedListener(event) {\n      _this.dispatchEvent(event);\n    };\n\n    childMenu.addEventListener(MenuItemComponent.EVENT_ITEM_SELECTED, selectedListener);\n    this.removeChildFuncs.push(function () {\n      childMenu.clearActiveItem();\n      childMenu.destroy();\n      _this.subMenuParentComp = null;\n      _this.subMenuComp = null;\n      childMenu.removeEventListener(MenuItemComponent.EVENT_ITEM_SELECTED, selectedListener);\n      hidePopupFunc();\n    });\n  };\n\n  MenuList.prototype.removeChildPopup = function () {\n    this.removeChildFuncs.forEach(function (func) {\n      return func();\n    });\n    this.removeChildFuncs = [];\n  };\n\n  MenuList.prototype.destroy = function () {\n    this.removeChildPopup();\n\n    _super.prototype.destroy.call(this);\n  };\n\n  MenuList.TEMPLATE = \"\\n        <div class=\\\"ag-menu-list\\\"><div class=\\\"ag-menu-list-body\\\"></div>\";\n  MenuList.SEPARATOR_TEMPLATE = \"<div class=\\\"ag-menu-separator\\\">\\n            <span class=\\\"ag-menu-separator-cell\\\"></span>\\n            <span class=\\\"ag-menu-separator-cell\\\"></span>\\n            <span class=\\\"ag-menu-separator-cell\\\"></span>\\n            <span class=\\\"ag-menu-separator-cell\\\"></span>\\n        </div>\";\n  MenuList.HIDE_MENU_DELAY = 80;\n\n  __decorate([Autowired('popupService')], MenuList.prototype, \"popupService\", void 0);\n\n  __decorate([Autowired('gridOptionsWrapper')], MenuList.prototype, \"gridOptionsWrapper\", void 0);\n\n  return MenuList;\n}(ManagedFocusComponent);\n\nexport { MenuList };","map":{"version":3,"sources":["/Users/fouaddakhel/Projects/Nana/ReactJS/supermarket_dashboard/supermarket_dashboard/node_modules/@ag-grid-enterprise/menu/dist/es6/menu/menuList.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","__decorate","decorators","target","key","desc","c","arguments","length","r","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","Autowired","Constants","ManagedFocusComponent","_","MenuItemComponent","MenuList","_super","_this","call","TEMPLATE","menuItems","subMenuHideTimer","subMenuShowTimer","removeChildFuncs","onTabKeyDown","e","parent","getParentComponent","isManaged","preventDefault","shiftKey","closeIfIsChild","handleKeyDown","keyCode","KEY_UP","KEY_RIGHT","KEY_DOWN","KEY_LEFT","handleNavKey","KEY_ESCAPE","topMenu","findTopMenu","getGui","focus","isFocusableContainer","clearActiveItem","deactivateItem","removeChildPopup","addMenuItems","missing","forEach","menuItemOrString","addSeparator","console","warn","menuItem","addItem","menuItemDef","cMenuItem","createManagedBean","push","comp","params","appendChild","addEventListener","EVENT_ITEM_SELECTED","event","subMenu","action","showChildMenu","type","subMenuComp","activateFirstItem","dispatchEvent","setParentComponent","handleMouseEnter","menuItemParams","window","clearTimeout","mouseEnterItem","setTimeout","HIDE_MENU_DELAY","handleMouseLeave","subMenuParentComp","mouseLeaveItem","addGuiEventListener","item","filter","disabled","activateItem","isParent","subMenuGui","relatedTarget","contains","openSubMenu","activeMenuItemParams","activeMenuItem","eGui","addCssClass","addHoverForChildPopup","removeCssClass","nextParent","undefined","nextItem","findNextItem","left","gridOptionsWrapper","isEnableRtl","openChild","parentItem","parentMenuList","up","items","last","reverse","foundCurrent","menuItemComp","showingThisMenu","menuItemIsActive","isAlive","template","loadTemplate","SEPARATOR_TEMPLATE","childMenu","getContext","createBean","ePopup","hidePopupFunc","popupService","addAsModalPopup","positionPopupForMenu","eventSource","addManagedListener","selectedListener","destroy","removeEventListener","func"],"mappings":"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","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Autowired, Constants, ManagedFocusComponent, _ } from \"@ag-grid-community/core\";\nimport { MenuItemComponent } from \"./menuItemComponent\";\nvar MenuList = /** @class */ (function (_super) {\n    __extends(MenuList, _super);\n    function MenuList() {\n        var _this = _super.call(this, MenuList.TEMPLATE) || this;\n        _this.menuItems = [];\n        _this.subMenuHideTimer = 0;\n        _this.subMenuShowTimer = 0;\n        _this.removeChildFuncs = [];\n        return _this;\n    }\n    MenuList.prototype.onTabKeyDown = function (e) {\n        var parent = this.getParentComponent();\n        var isManaged = parent && parent instanceof ManagedFocusComponent;\n        if (!isManaged) {\n            e.preventDefault();\n        }\n        if (e.shiftKey) {\n            this.closeIfIsChild(e);\n        }\n    };\n    MenuList.prototype.handleKeyDown = function (e) {\n        switch (e.keyCode) {\n            case Constants.KEY_UP:\n            case Constants.KEY_RIGHT:\n            case Constants.KEY_DOWN:\n            case Constants.KEY_LEFT:\n                e.preventDefault();\n                this.handleNavKey(e.keyCode);\n                break;\n            case Constants.KEY_ESCAPE:\n                var topMenu = this.findTopMenu();\n                if (topMenu) {\n                    topMenu.getGui().focus();\n                }\n                break;\n        }\n    };\n    MenuList.prototype.isFocusableContainer = function () {\n        return true;\n    };\n    MenuList.prototype.clearActiveItem = function () {\n        this.deactivateItem();\n        this.removeChildPopup();\n    };\n    MenuList.prototype.addMenuItems = function (menuItems) {\n        var _this = this;\n        if (!menuItems || _.missing(menuItems)) {\n            return;\n        }\n        menuItems.forEach(function (menuItemOrString) {\n            if (menuItemOrString === 'separator') {\n                _this.addSeparator();\n            }\n            else if (typeof menuItemOrString === 'string') {\n                console.warn(\"ag-Grid: unrecognised menu item \" + menuItemOrString);\n            }\n            else {\n                var menuItem = menuItemOrString;\n                _this.addItem(menuItem);\n            }\n        });\n    };\n    MenuList.prototype.addItem = function (menuItemDef) {\n        var _this = this;\n        var cMenuItem = this.createManagedBean(new MenuItemComponent(menuItemDef));\n        this.menuItems.push({ comp: cMenuItem, params: menuItemDef });\n        this.appendChild(cMenuItem.getGui());\n        cMenuItem.addEventListener(MenuItemComponent.EVENT_ITEM_SELECTED, function (event) {\n            if (menuItemDef.subMenu && !menuItemDef.action) {\n                _this.showChildMenu(cMenuItem, menuItemDef);\n                if (event.event.type === 'keydown') {\n                    _this.subMenuComp.activateFirstItem();\n                }\n            }\n            else {\n                _this.dispatchEvent(event);\n            }\n        });\n        cMenuItem.setParentComponent(this);\n        var handleMouseEnter = function (cMenuItem, menuItemParams) {\n            if (_this.subMenuShowTimer) {\n                window.clearTimeout(_this.subMenuShowTimer);\n                _this.subMenuShowTimer = 0;\n            }\n            if (!_this.subMenuHideTimer) {\n                _this.mouseEnterItem(cMenuItem, menuItemParams);\n            }\n            else {\n                _this.subMenuShowTimer = window.setTimeout(function () {\n                    handleMouseEnter(cMenuItem, menuItemParams);\n                }, MenuList.HIDE_MENU_DELAY);\n            }\n        };\n        var handleMouseLeave = function (e, cMenuItem, menuItemParams) {\n            if (_this.subMenuParentComp === cMenuItem) {\n                if (_this.subMenuHideTimer) {\n                    return;\n                }\n                _this.subMenuHideTimer = window.setTimeout(function () { return _this.mouseLeaveItem(e, cMenuItem, menuItemParams); }, MenuList.HIDE_MENU_DELAY);\n            }\n            else if (!_this.subMenuHideTimer) {\n                _this.mouseLeaveItem(e, cMenuItem, menuItemParams);\n            }\n        };\n        cMenuItem.addGuiEventListener('mouseenter', function () { return handleMouseEnter(cMenuItem, menuItemDef); });\n        cMenuItem.addGuiEventListener('mouseleave', function (e) { return handleMouseLeave(e, cMenuItem, menuItemDef); });\n    };\n    MenuList.prototype.activateFirstItem = function () {\n        var item = this.menuItems.filter(function (item) { return !item.params.disabled; })[0];\n        if (!item) {\n            return;\n        }\n        this.activateItem(item.comp, item.params);\n    };\n    MenuList.prototype.mouseEnterItem = function (menuItem, menuItemParams) {\n        this.subMenuShowTimer = 0;\n        this.activateItem(menuItem, menuItemParams, true);\n    };\n    MenuList.prototype.mouseLeaveItem = function (e, menuItem, menuItemParams) {\n        var isParent = this.subMenuComp && this.subMenuComp.getParentComponent() === menuItem;\n        var subMenuGui = isParent && this.subMenuComp.getGui();\n        var relatedTarget = e.relatedTarget;\n        this.subMenuHideTimer = 0;\n        if (relatedTarget && subMenuGui &&\n            (subMenuGui.contains(relatedTarget) || relatedTarget.contains(subMenuGui))) {\n            return;\n        }\n        this.deactivateItem(menuItem, menuItemParams);\n    };\n    MenuList.prototype.activateItem = function (menuItem, menuItemParams, openSubMenu) {\n        if (menuItemParams.disabled) {\n            this.deactivateItem();\n            return;\n        }\n        if (this.activeMenuItemParams !== menuItemParams) {\n            this.removeChildPopup();\n        }\n        if (this.activeMenuItem && this.activeMenuItem !== menuItem) {\n            this.deactivateItem();\n        }\n        this.activeMenuItemParams = menuItemParams;\n        this.activeMenuItem = menuItem;\n        var eGui = menuItem.getGui();\n        _.addCssClass(eGui, 'ag-menu-option-active');\n        eGui.focus();\n        if (openSubMenu && menuItemParams.subMenu) {\n            this.addHoverForChildPopup(menuItem, menuItemParams);\n        }\n    };\n    MenuList.prototype.deactivateItem = function (menuItem, menuItemParams) {\n        if (!menuItem && this.activeMenuItem) {\n            menuItem = this.activeMenuItem;\n            menuItemParams = this.activeMenuItemParams;\n        }\n        if (!menuItem || menuItemParams.disabled) {\n            return;\n        }\n        _.removeCssClass(menuItem.getGui(), 'ag-menu-option-active');\n        if (this.subMenuParentComp === menuItem) {\n            this.removeChildPopup();\n        }\n        this.activeMenuItem = null;\n        this.activeMenuItemParams = null;\n    };\n    MenuList.prototype.findTopMenu = function () {\n        var parent = this.getParentComponent();\n        if (!parent && this instanceof MenuList) {\n            return this;\n        }\n        while (true) {\n            var nextParent = parent && parent.getParentComponent && parent.getParentComponent();\n            if (!nextParent || (!(nextParent instanceof MenuList || nextParent instanceof MenuItemComponent))) {\n                break;\n            }\n            parent = nextParent;\n        }\n        return parent instanceof MenuList ? parent : undefined;\n    };\n    MenuList.prototype.handleNavKey = function (key) {\n        switch (key) {\n            case Constants.KEY_UP:\n            case Constants.KEY_DOWN:\n                var nextItem = this.findNextItem(key === Constants.KEY_UP);\n                if (nextItem && nextItem.comp !== this.activeMenuItem) {\n                    this.deactivateItem();\n                    this.activateItem(nextItem.comp, nextItem.params);\n                }\n                return;\n        }\n        if (!this.activateItem) {\n            return;\n        }\n        var left = this.gridOptionsWrapper.isEnableRtl() ? Constants.KEY_RIGHT : Constants.KEY_LEFT;\n        if (key === left) {\n            this.closeIfIsChild();\n        }\n        else {\n            this.openChild();\n        }\n    };\n    MenuList.prototype.closeIfIsChild = function (e) {\n        var parentItem = this.getParentComponent();\n        if (parentItem && parentItem instanceof MenuItemComponent) {\n            if (e) {\n                e.preventDefault();\n            }\n            var parentMenuList = parentItem.getParentComponent();\n            parentItem.getGui().focus();\n            parentMenuList.removeChildPopup();\n        }\n    };\n    MenuList.prototype.openChild = function () {\n        var _this = this;\n        if (this.activeMenuItemParams && this.activeMenuItemParams.subMenu) {\n            this.showChildMenu(this.activeMenuItem, this.activeMenuItemParams);\n            setTimeout(function () {\n                var subMenu = _this.subMenuComp;\n                subMenu.activateFirstItem();\n            }, 0);\n        }\n    };\n    MenuList.prototype.findNextItem = function (up) {\n        var items = this.menuItems.filter(function (item) { return !item.params.disabled; });\n        if (!items.length) {\n            return;\n        }\n        if (!this.activeMenuItem) {\n            return up ? _.last(items) : items[0];\n        }\n        if (up) {\n            items.reverse();\n        }\n        var nextItem;\n        var foundCurrent = false;\n        for (var i = 0; i < items.length; i++) {\n            var item = items[i];\n            if (!foundCurrent) {\n                if (item.comp === this.activeMenuItem) {\n                    foundCurrent = true;\n                }\n                continue;\n            }\n            nextItem = item;\n            break;\n        }\n        return nextItem || { comp: this.activeMenuItem, params: this.activeMenuItemParams };\n    };\n    MenuList.prototype.addHoverForChildPopup = function (menuItemComp, menuItemDef) {\n        var _this = this;\n        window.setTimeout(function () {\n            var showingThisMenu = _this.subMenuParentComp === menuItemComp;\n            var menuItemIsActive = _this.activeMenuItem === menuItemComp;\n            if (_this.isAlive() && menuItemIsActive && !showingThisMenu) {\n                _this.showChildMenu(menuItemComp, menuItemDef);\n            }\n        }, 300);\n    };\n    MenuList.prototype.addSeparator = function () {\n        var template = _.loadTemplate(MenuList.SEPARATOR_TEMPLATE);\n        this.appendChild(template);\n    };\n    MenuList.prototype.showChildMenu = function (menuItemComp, menuItemDef) {\n        var _this = this;\n        this.removeChildPopup();\n        var childMenu = new MenuList();\n        childMenu.setParentComponent(menuItemComp);\n        this.getContext().createBean(childMenu);\n        childMenu.addMenuItems(menuItemDef.subMenu);\n        var ePopup = _.loadTemplate('<div class=\"ag-menu\" tabindex=\"-1\"></div>');\n        ePopup.appendChild(childMenu.getGui());\n        var hidePopupFunc = this.popupService.addAsModalPopup(ePopup, false);\n        this.popupService.positionPopupForMenu({\n            eventSource: menuItemComp.getGui(),\n            ePopup: ePopup\n        });\n        this.subMenuParentComp = menuItemComp;\n        this.subMenuComp = childMenu;\n        childMenu.addManagedListener(ePopup, 'mouseover', function () {\n            if (_this.subMenuHideTimer && menuItemComp === _this.subMenuParentComp) {\n                window.clearTimeout(_this.subMenuHideTimer);\n                window.clearTimeout(_this.subMenuShowTimer);\n                _this.subMenuHideTimer = 0;\n                _this.subMenuShowTimer = 0;\n            }\n        });\n        var selectedListener = function (event) {\n            _this.dispatchEvent(event);\n        };\n        childMenu.addEventListener(MenuItemComponent.EVENT_ITEM_SELECTED, selectedListener);\n        this.removeChildFuncs.push(function () {\n            childMenu.clearActiveItem();\n            childMenu.destroy();\n            _this.subMenuParentComp = null;\n            _this.subMenuComp = null;\n            childMenu.removeEventListener(MenuItemComponent.EVENT_ITEM_SELECTED, selectedListener);\n            hidePopupFunc();\n        });\n    };\n    MenuList.prototype.removeChildPopup = function () {\n        this.removeChildFuncs.forEach(function (func) { return func(); });\n        this.removeChildFuncs = [];\n    };\n    MenuList.prototype.destroy = function () {\n        this.removeChildPopup();\n        _super.prototype.destroy.call(this);\n    };\n    MenuList.TEMPLATE = \"\\n        <div class=\\\"ag-menu-list\\\"><div class=\\\"ag-menu-list-body\\\"></div>\";\n    MenuList.SEPARATOR_TEMPLATE = \"<div class=\\\"ag-menu-separator\\\">\\n            <span class=\\\"ag-menu-separator-cell\\\"></span>\\n            <span class=\\\"ag-menu-separator-cell\\\"></span>\\n            <span class=\\\"ag-menu-separator-cell\\\"></span>\\n            <span class=\\\"ag-menu-separator-cell\\\"></span>\\n        </div>\";\n    MenuList.HIDE_MENU_DELAY = 80;\n    __decorate([\n        Autowired('popupService')\n    ], MenuList.prototype, \"popupService\", void 0);\n    __decorate([\n        Autowired('gridOptionsWrapper')\n    ], MenuList.prototype, \"gridOptionsWrapper\", void 0);\n    return MenuList;\n}(ManagedFocusComponent));\nexport { MenuList };\n"]},"metadata":{},"sourceType":"module"}