{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nimport { DragSourceType, Component, Autowired, Events, TouchListener, DragAndDropService, PostConstruct, RefSelector, _, Optional, VirtualList } from \"@ag-grid-community/core\";\n\nvar DropZoneColumnComp =\n/** @class */\nfunction (_super) {\n  __extends(DropZoneColumnComp, _super);\n\n  function DropZoneColumnComp(column, dragSourceDropTarget, ghost, valueColumn, horizontal) {\n    var _this = _super.call(this) || this;\n\n    _this.column = column;\n    _this.dragSourceDropTarget = dragSourceDropTarget;\n    _this.ghost = ghost;\n    _this.valueColumn = valueColumn;\n    _this.horizontal = horizontal;\n    _this.popupShowing = false;\n    return _this;\n  }\n\n  DropZoneColumnComp.prototype.init = function () {\n    this.setTemplate(DropZoneColumnComp.TEMPLATE);\n    this.addElementClasses(this.getGui());\n    this.addElementClasses(this.eDragHandle, 'drag-handle');\n    this.addElementClasses(this.eText, 'text');\n    this.addElementClasses(this.eButton, 'button');\n    this.eDragHandle.appendChild(_.createIconNoSpan('columnDrag', this.gridOptionsWrapper));\n    this.eButton.appendChild(_.createIconNoSpan('cancel', this.gridOptionsWrapper));\n    this.displayName = this.columnController.getDisplayNameForColumn(this.column, 'columnDrop');\n    this.setupComponents();\n\n    if (!this.ghost && !this.gridOptionsWrapper.isFunctionsReadOnly()) {\n      this.addDragSource();\n    }\n  };\n\n  DropZoneColumnComp.prototype.addDragSource = function () {\n    var _this = this;\n\n    var dragSource = {\n      type: DragSourceType.ToolPanel,\n      eElement: this.eDragHandle,\n      defaultIconName: DragAndDropService.ICON_HIDE,\n      getDragItem: function () {\n        return _this.createDragItem();\n      },\n      dragItemName: this.displayName,\n      dragSourceDropTarget: this.dragSourceDropTarget\n    };\n    this.dragAndDropService.addDragSource(dragSource, true);\n    this.addDestroyFunc(function () {\n      return _this.dragAndDropService.removeDragSource(dragSource);\n    });\n  };\n\n  DropZoneColumnComp.prototype.createDragItem = function () {\n    var visibleState = {};\n    visibleState[this.column.getId()] = this.column.isVisible();\n    return {\n      columns: [this.column],\n      visibleState: visibleState\n    };\n  };\n\n  DropZoneColumnComp.prototype.setupComponents = function () {\n    this.setTextValue();\n    this.setupRemove();\n\n    if (this.ghost) {\n      _.addCssClass(this.getGui(), 'ag-column-drop-cell-ghost');\n    }\n\n    if (this.valueColumn && !this.gridOptionsWrapper.isFunctionsReadOnly()) {\n      this.addGuiEventListener('click', this.onShowAggFuncSelection.bind(this));\n    }\n  };\n\n  DropZoneColumnComp.prototype.setupRemove = function () {\n    var _this = this;\n\n    _.setDisplayed(this.eButton, !this.gridOptionsWrapper.isFunctionsReadOnly());\n\n    this.addManagedListener(this.eButton, 'click', function (mouseEvent) {\n      var agEvent = {\n        type: DropZoneColumnComp.EVENT_COLUMN_REMOVE\n      };\n\n      _this.dispatchEvent(agEvent);\n\n      mouseEvent.stopPropagation();\n    });\n    var touchListener = new TouchListener(this.eButton);\n    this.addManagedListener(touchListener, TouchListener.EVENT_TAP, function (event) {\n      var agEvent = {\n        type: DropZoneColumnComp.EVENT_COLUMN_REMOVE\n      };\n\n      _this.dispatchEvent(agEvent);\n    });\n    this.addDestroyFunc(touchListener.destroy.bind(touchListener));\n  };\n\n  DropZoneColumnComp.prototype.setTextValue = function () {\n    var displayValue;\n\n    if (this.valueColumn) {\n      var aggFunc = this.column.getAggFunc(); // if aggFunc is a string, we can use it, but if it's a function, then we swap with 'func'\n\n      var aggFuncString = typeof aggFunc === 'string' ? aggFunc : 'agg';\n      var localeTextFunc = this.gridOptionsWrapper.getLocaleTextFunc();\n      var aggFuncStringTranslated = localeTextFunc(aggFuncString, aggFuncString);\n      displayValue = aggFuncStringTranslated + \"(\" + this.displayName + \")\";\n    } else {\n      displayValue = this.displayName;\n    }\n\n    var displayValueSanitised = _.escape(displayValue);\n\n    this.eText.innerHTML = displayValueSanitised;\n  };\n\n  DropZoneColumnComp.prototype.onShowAggFuncSelection = function () {\n    var _this = this;\n\n    if (this.popupShowing) {\n      return;\n    }\n\n    this.popupShowing = true;\n    var virtualList = new VirtualList('select-agg-func');\n    var rows = this.aggFuncService.getFuncNames(this.column);\n    virtualList.setModel({\n      getRow: function (index) {\n        return rows[index];\n      },\n      getRowCount: function () {\n        return rows.length;\n      }\n    });\n    this.getContext().createBean(virtualList);\n\n    var ePopup = _.loadTemplate('<div class=\"ag-select-agg-func-popup\"></div>');\n\n    ePopup.style.top = '0px';\n    ePopup.style.left = '0px';\n    ePopup.appendChild(virtualList.getGui()); // ePopup.style.height = this.gridOptionsWrapper.getAggFuncPopupHeight() + 'px';\n\n    ePopup.style.width = this.getGui().clientWidth + 'px';\n\n    var popupHiddenFunc = function () {\n      _this.destroyBean(virtualList);\n\n      _this.popupShowing = false;\n    };\n\n    var hidePopup = this.popupService.addAsModalPopup(ePopup, true, popupHiddenFunc);\n    virtualList.setComponentCreator(this.createAggSelect.bind(this, hidePopup));\n    this.popupService.positionPopupUnderComponent({\n      type: 'aggFuncSelect',\n      eventSource: this.getGui(),\n      ePopup: ePopup,\n      keepWithinBounds: true,\n      column: this.column\n    });\n    virtualList.refresh();\n  };\n\n  DropZoneColumnComp.prototype.createAggSelect = function (hidePopup, value) {\n    var _this = this;\n\n    var itemSelected = function () {\n      hidePopup();\n\n      if (_this.gridOptionsWrapper.isFunctionsPassive()) {\n        var event_1 = {\n          type: Events.EVENT_COLUMN_AGG_FUNC_CHANGE_REQUEST,\n          columns: [_this.column],\n          aggFunc: value,\n          api: _this.gridApi,\n          columnApi: _this.columnApi\n        };\n\n        _this.eventService.dispatchEvent(event_1);\n      } else {\n        _this.columnController.setColumnAggFunc(_this.column, value, \"toolPanelDragAndDrop\");\n      }\n    };\n\n    var localeTextFunc = this.gridOptionsWrapper.getLocaleTextFunc();\n    var aggFuncString = value.toString();\n    var aggFuncStringTranslated = localeTextFunc(aggFuncString, aggFuncString);\n    var comp = new AggItemComp(itemSelected, aggFuncStringTranslated);\n    return comp;\n  };\n\n  DropZoneColumnComp.prototype.addElementClasses = function (el, suffix) {\n    suffix = suffix ? \"-\" + suffix : '';\n\n    _.addCssClass(el, \"ag-column-drop-cell\" + suffix);\n\n    var direction = this.horizontal ? 'horizontal' : 'vertical';\n\n    _.addCssClass(el, \"ag-column-drop-\" + direction + \"-cell\" + suffix);\n  };\n\n  DropZoneColumnComp.EVENT_COLUMN_REMOVE = 'columnRemove';\n  DropZoneColumnComp.TEMPLATE = \"<span>\\n          <span ref=\\\"eDragHandle\\\" class=\\\"ag-drag-handle ag-column-drop-cell-drag-handle\\\"></span>\\n          <span ref=\\\"eText\\\" class=\\\"ag-column-drop-cell-text\\\"></span>\\n          <span ref=\\\"eButton\\\" class=\\\"ag-column-drop-cell-button\\\"></span>\\n        </span>\";\n\n  __decorate([Autowired('dragAndDropService')], DropZoneColumnComp.prototype, \"dragAndDropService\", void 0);\n\n  __decorate([Autowired('columnController')], DropZoneColumnComp.prototype, \"columnController\", void 0);\n\n  __decorate([Autowired('popupService')], DropZoneColumnComp.prototype, \"popupService\", void 0);\n\n  __decorate([Optional('aggFuncService')], DropZoneColumnComp.prototype, \"aggFuncService\", void 0);\n\n  __decorate([Autowired('gridOptionsWrapper')], DropZoneColumnComp.prototype, \"gridOptionsWrapper\", void 0);\n\n  __decorate([Autowired('columnApi')], DropZoneColumnComp.prototype, \"columnApi\", void 0);\n\n  __decorate([Autowired('gridApi')], DropZoneColumnComp.prototype, \"gridApi\", void 0);\n\n  __decorate([RefSelector('eText')], DropZoneColumnComp.prototype, \"eText\", void 0);\n\n  __decorate([RefSelector('eDragHandle')], DropZoneColumnComp.prototype, \"eDragHandle\", void 0);\n\n  __decorate([RefSelector('eButton')], DropZoneColumnComp.prototype, \"eButton\", void 0);\n\n  __decorate([PostConstruct], DropZoneColumnComp.prototype, \"init\", null);\n\n  return DropZoneColumnComp;\n}(Component);\n\nexport { DropZoneColumnComp };\n\nvar AggItemComp =\n/** @class */\nfunction (_super) {\n  __extends(AggItemComp, _super);\n\n  function AggItemComp(itemSelected, value) {\n    var _this = _super.call(this, '<div class=\"ag-select-agg-func-item\"/>') || this;\n\n    _this.getGui().innerText = value;\n    _this.value = value;\n\n    _this.addGuiEventListener('click', itemSelected);\n\n    return _this;\n  }\n\n  return AggItemComp;\n}(Component);","map":{"version":3,"sources":["/Users/fouaddakhel/Projects/Nana/ReactJS/supermarket_dashboard/supermarket_dashboard/node_modules/@ag-grid-enterprise/row-grouping/dist/es6/rowGrouping/columnDropZones/dropZoneColumnComp.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","__decorate","decorators","target","key","desc","c","arguments","length","r","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","DragSourceType","Component","Autowired","Events","TouchListener","DragAndDropService","PostConstruct","RefSelector","_","Optional","VirtualList","DropZoneColumnComp","_super","column","dragSourceDropTarget","ghost","valueColumn","horizontal","_this","call","popupShowing","init","setTemplate","TEMPLATE","addElementClasses","getGui","eDragHandle","eText","eButton","appendChild","createIconNoSpan","gridOptionsWrapper","displayName","columnController","getDisplayNameForColumn","setupComponents","isFunctionsReadOnly","addDragSource","dragSource","type","ToolPanel","eElement","defaultIconName","ICON_HIDE","getDragItem","createDragItem","dragItemName","dragAndDropService","addDestroyFunc","removeDragSource","visibleState","getId","isVisible","columns","setTextValue","setupRemove","addCssClass","addGuiEventListener","onShowAggFuncSelection","bind","setDisplayed","addManagedListener","mouseEvent","agEvent","EVENT_COLUMN_REMOVE","dispatchEvent","stopPropagation","touchListener","EVENT_TAP","event","destroy","displayValue","aggFunc","getAggFunc","aggFuncString","localeTextFunc","getLocaleTextFunc","aggFuncStringTranslated","displayValueSanitised","escape","innerHTML","virtualList","rows","aggFuncService","getFuncNames","setModel","getRow","index","getRowCount","getContext","createBean","ePopup","loadTemplate","style","top","left","width","clientWidth","popupHiddenFunc","destroyBean","hidePopup","popupService","addAsModalPopup","setComponentCreator","createAggSelect","positionPopupUnderComponent","eventSource","keepWithinBounds","refresh","value","itemSelected","isFunctionsPassive","event_1","EVENT_COLUMN_AGG_FUNC_CHANGE_REQUEST","api","gridApi","columnApi","eventService","setColumnAggFunc","toString","comp","AggItemComp","el","suffix","direction","innerText"],"mappings":"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","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { DragSourceType, Component, Autowired, Events, TouchListener, DragAndDropService, PostConstruct, RefSelector, _, Optional, VirtualList } from \"@ag-grid-community/core\";\nvar DropZoneColumnComp = /** @class */ (function (_super) {\n    __extends(DropZoneColumnComp, _super);\n    function DropZoneColumnComp(column, dragSourceDropTarget, ghost, valueColumn, horizontal) {\n        var _this = _super.call(this) || this;\n        _this.column = column;\n        _this.dragSourceDropTarget = dragSourceDropTarget;\n        _this.ghost = ghost;\n        _this.valueColumn = valueColumn;\n        _this.horizontal = horizontal;\n        _this.popupShowing = false;\n        return _this;\n    }\n    DropZoneColumnComp.prototype.init = function () {\n        this.setTemplate(DropZoneColumnComp.TEMPLATE);\n        this.addElementClasses(this.getGui());\n        this.addElementClasses(this.eDragHandle, 'drag-handle');\n        this.addElementClasses(this.eText, 'text');\n        this.addElementClasses(this.eButton, 'button');\n        this.eDragHandle.appendChild(_.createIconNoSpan('columnDrag', this.gridOptionsWrapper));\n        this.eButton.appendChild(_.createIconNoSpan('cancel', this.gridOptionsWrapper));\n        this.displayName = this.columnController.getDisplayNameForColumn(this.column, 'columnDrop');\n        this.setupComponents();\n        if (!this.ghost && !this.gridOptionsWrapper.isFunctionsReadOnly()) {\n            this.addDragSource();\n        }\n    };\n    DropZoneColumnComp.prototype.addDragSource = function () {\n        var _this = this;\n        var dragSource = {\n            type: DragSourceType.ToolPanel,\n            eElement: this.eDragHandle,\n            defaultIconName: DragAndDropService.ICON_HIDE,\n            getDragItem: function () { return _this.createDragItem(); },\n            dragItemName: this.displayName,\n            dragSourceDropTarget: this.dragSourceDropTarget\n        };\n        this.dragAndDropService.addDragSource(dragSource, true);\n        this.addDestroyFunc(function () { return _this.dragAndDropService.removeDragSource(dragSource); });\n    };\n    DropZoneColumnComp.prototype.createDragItem = function () {\n        var visibleState = {};\n        visibleState[this.column.getId()] = this.column.isVisible();\n        return {\n            columns: [this.column],\n            visibleState: visibleState\n        };\n    };\n    DropZoneColumnComp.prototype.setupComponents = function () {\n        this.setTextValue();\n        this.setupRemove();\n        if (this.ghost) {\n            _.addCssClass(this.getGui(), 'ag-column-drop-cell-ghost');\n        }\n        if (this.valueColumn && !this.gridOptionsWrapper.isFunctionsReadOnly()) {\n            this.addGuiEventListener('click', this.onShowAggFuncSelection.bind(this));\n        }\n    };\n    DropZoneColumnComp.prototype.setupRemove = function () {\n        var _this = this;\n        _.setDisplayed(this.eButton, !this.gridOptionsWrapper.isFunctionsReadOnly());\n        this.addManagedListener(this.eButton, 'click', function (mouseEvent) {\n            var agEvent = { type: DropZoneColumnComp.EVENT_COLUMN_REMOVE };\n            _this.dispatchEvent(agEvent);\n            mouseEvent.stopPropagation();\n        });\n        var touchListener = new TouchListener(this.eButton);\n        this.addManagedListener(touchListener, TouchListener.EVENT_TAP, function (event) {\n            var agEvent = { type: DropZoneColumnComp.EVENT_COLUMN_REMOVE };\n            _this.dispatchEvent(agEvent);\n        });\n        this.addDestroyFunc(touchListener.destroy.bind(touchListener));\n    };\n    DropZoneColumnComp.prototype.setTextValue = function () {\n        var displayValue;\n        if (this.valueColumn) {\n            var aggFunc = this.column.getAggFunc();\n            // if aggFunc is a string, we can use it, but if it's a function, then we swap with 'func'\n            var aggFuncString = (typeof aggFunc === 'string') ? aggFunc : 'agg';\n            var localeTextFunc = this.gridOptionsWrapper.getLocaleTextFunc();\n            var aggFuncStringTranslated = localeTextFunc(aggFuncString, aggFuncString);\n            displayValue = aggFuncStringTranslated + \"(\" + this.displayName + \")\";\n        }\n        else {\n            displayValue = this.displayName;\n        }\n        var displayValueSanitised = _.escape(displayValue);\n        this.eText.innerHTML = displayValueSanitised;\n    };\n    DropZoneColumnComp.prototype.onShowAggFuncSelection = function () {\n        var _this = this;\n        if (this.popupShowing) {\n            return;\n        }\n        this.popupShowing = true;\n        var virtualList = new VirtualList('select-agg-func');\n        var rows = this.aggFuncService.getFuncNames(this.column);\n        virtualList.setModel({\n            getRow: function (index) { return rows[index]; },\n            getRowCount: function () { return rows.length; }\n        });\n        this.getContext().createBean(virtualList);\n        var ePopup = _.loadTemplate('<div class=\"ag-select-agg-func-popup\"></div>');\n        ePopup.style.top = '0px';\n        ePopup.style.left = '0px';\n        ePopup.appendChild(virtualList.getGui());\n        // ePopup.style.height = this.gridOptionsWrapper.getAggFuncPopupHeight() + 'px';\n        ePopup.style.width = this.getGui().clientWidth + 'px';\n        var popupHiddenFunc = function () {\n            _this.destroyBean(virtualList);\n            _this.popupShowing = false;\n        };\n        var hidePopup = this.popupService.addAsModalPopup(ePopup, true, popupHiddenFunc);\n        virtualList.setComponentCreator(this.createAggSelect.bind(this, hidePopup));\n        this.popupService.positionPopupUnderComponent({\n            type: 'aggFuncSelect',\n            eventSource: this.getGui(),\n            ePopup: ePopup,\n            keepWithinBounds: true,\n            column: this.column\n        });\n        virtualList.refresh();\n    };\n    DropZoneColumnComp.prototype.createAggSelect = function (hidePopup, value) {\n        var _this = this;\n        var itemSelected = function () {\n            hidePopup();\n            if (_this.gridOptionsWrapper.isFunctionsPassive()) {\n                var event_1 = {\n                    type: Events.EVENT_COLUMN_AGG_FUNC_CHANGE_REQUEST,\n                    columns: [_this.column],\n                    aggFunc: value,\n                    api: _this.gridApi,\n                    columnApi: _this.columnApi\n                };\n                _this.eventService.dispatchEvent(event_1);\n            }\n            else {\n                _this.columnController.setColumnAggFunc(_this.column, value, \"toolPanelDragAndDrop\");\n            }\n        };\n        var localeTextFunc = this.gridOptionsWrapper.getLocaleTextFunc();\n        var aggFuncString = value.toString();\n        var aggFuncStringTranslated = localeTextFunc(aggFuncString, aggFuncString);\n        var comp = new AggItemComp(itemSelected, aggFuncStringTranslated);\n        return comp;\n    };\n    DropZoneColumnComp.prototype.addElementClasses = function (el, suffix) {\n        suffix = suffix ? \"-\" + suffix : '';\n        _.addCssClass(el, \"ag-column-drop-cell\" + suffix);\n        var direction = this.horizontal ? 'horizontal' : 'vertical';\n        _.addCssClass(el, \"ag-column-drop-\" + direction + \"-cell\" + suffix);\n    };\n    DropZoneColumnComp.EVENT_COLUMN_REMOVE = 'columnRemove';\n    DropZoneColumnComp.TEMPLATE = \"<span>\\n          <span ref=\\\"eDragHandle\\\" class=\\\"ag-drag-handle ag-column-drop-cell-drag-handle\\\"></span>\\n          <span ref=\\\"eText\\\" class=\\\"ag-column-drop-cell-text\\\"></span>\\n          <span ref=\\\"eButton\\\" class=\\\"ag-column-drop-cell-button\\\"></span>\\n        </span>\";\n    __decorate([\n        Autowired('dragAndDropService')\n    ], DropZoneColumnComp.prototype, \"dragAndDropService\", void 0);\n    __decorate([\n        Autowired('columnController')\n    ], DropZoneColumnComp.prototype, \"columnController\", void 0);\n    __decorate([\n        Autowired('popupService')\n    ], DropZoneColumnComp.prototype, \"popupService\", void 0);\n    __decorate([\n        Optional('aggFuncService')\n    ], DropZoneColumnComp.prototype, \"aggFuncService\", void 0);\n    __decorate([\n        Autowired('gridOptionsWrapper')\n    ], DropZoneColumnComp.prototype, \"gridOptionsWrapper\", void 0);\n    __decorate([\n        Autowired('columnApi')\n    ], DropZoneColumnComp.prototype, \"columnApi\", void 0);\n    __decorate([\n        Autowired('gridApi')\n    ], DropZoneColumnComp.prototype, \"gridApi\", void 0);\n    __decorate([\n        RefSelector('eText')\n    ], DropZoneColumnComp.prototype, \"eText\", void 0);\n    __decorate([\n        RefSelector('eDragHandle')\n    ], DropZoneColumnComp.prototype, \"eDragHandle\", void 0);\n    __decorate([\n        RefSelector('eButton')\n    ], DropZoneColumnComp.prototype, \"eButton\", void 0);\n    __decorate([\n        PostConstruct\n    ], DropZoneColumnComp.prototype, \"init\", null);\n    return DropZoneColumnComp;\n}(Component));\nexport { DropZoneColumnComp };\nvar AggItemComp = /** @class */ (function (_super) {\n    __extends(AggItemComp, _super);\n    function AggItemComp(itemSelected, value) {\n        var _this = _super.call(this, '<div class=\"ag-select-agg-func-item\"/>') || this;\n        _this.getGui().innerText = value;\n        _this.value = value;\n        _this.addGuiEventListener('click', itemSelected);\n        return _this;\n    }\n    return AggItemComp;\n}(Component));\n"]},"metadata":{},"sourceType":"module"}