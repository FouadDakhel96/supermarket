{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (b.hasOwnProperty(p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) {\n    if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  }\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nimport { Group } from \"../../../scene/group\";\nimport { Line } from \"../../../scene/shape/line\";\nimport { Text } from \"../../../scene/shape/text\";\nimport { Selection } from \"../../../scene/selection\";\nimport { LinearScale } from \"../../../scale/linearScale\";\nimport palette from \"../../palettes\";\nimport { Sector } from \"../../../scene/shape/sector\";\nimport { Label } from \"../../label\";\nimport { PointerEvents } from \"../../../scene/node\";\nimport { normalizeAngle180, toRadians } from \"../../../util/angle\";\nimport { Color } from \"../../../util/color\";\nimport { toFixed } from \"../../../util/number\";\nimport { reactive, Observable } from \"../../../util/observable\";\nimport { PolarSeries } from \"./polarSeries\";\nimport { ChartAxisDirection } from \"../../chartAxis\";\nimport { Chart } from \"../../chart\";\nvar PieNodeTag;\n\n(function (PieNodeTag) {\n  PieNodeTag[PieNodeTag[\"Sector\"] = 0] = \"Sector\";\n  PieNodeTag[PieNodeTag[\"Callout\"] = 1] = \"Callout\";\n  PieNodeTag[PieNodeTag[\"Label\"] = 2] = \"Label\";\n})(PieNodeTag || (PieNodeTag = {}));\n\nvar PieSeriesLabel =\n/** @class */\nfunction (_super) {\n  __extends(PieSeriesLabel, _super);\n\n  function PieSeriesLabel() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.offset = 3; // from the callout line\n\n    _this.minAngle = 20; // in degrees\n\n    return _this;\n  }\n\n  __decorate([reactive('change')], PieSeriesLabel.prototype, \"offset\", void 0);\n\n  __decorate([reactive('dataChange')], PieSeriesLabel.prototype, \"minAngle\", void 0);\n\n  return PieSeriesLabel;\n}(Label);\n\nvar PieSeriesCallout =\n/** @class */\nfunction (_super) {\n  __extends(PieSeriesCallout, _super);\n\n  function PieSeriesCallout() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.colors = palette.strokes;\n    _this.length = 10;\n    _this.strokeWidth = 1;\n    return _this;\n  }\n\n  __decorate([reactive('change')], PieSeriesCallout.prototype, \"colors\", void 0);\n\n  __decorate([reactive('change')], PieSeriesCallout.prototype, \"length\", void 0);\n\n  __decorate([reactive('change')], PieSeriesCallout.prototype, \"strokeWidth\", void 0);\n\n  return PieSeriesCallout;\n}(Observable);\n\nvar PieSeries =\n/** @class */\nfunction (_super) {\n  __extends(PieSeries, _super);\n\n  function PieSeries() {\n    var _this = _super.call(this) || this;\n\n    _this.radiusScale = new LinearScale();\n    _this.groupSelection = Selection.select(_this.group).selectAll();\n    /**\n     * The processed data that gets visualized.\n     */\n\n    _this.groupSelectionData = [];\n\n    _this.angleScale = function () {\n      var scale = new LinearScale(); // Each slice is a ratio of the whole, where all ratios add up to 1.\n\n      scale.domain = [0, 1]; // Add 90 deg to start the first pie at 12 o'clock.\n\n      scale.range = [-Math.PI, Math.PI].map(function (angle) {\n        return angle + Math.PI / 2;\n      });\n      return scale;\n    }(); // When a user toggles a series item (e.g. from the legend), its boolean state is recorded here.\n\n\n    _this.seriesItemEnabled = [];\n    _this.label = new PieSeriesLabel();\n    _this.callout = new PieSeriesCallout();\n    /**\n     * The key of the numeric field to use to determine the angle (for example,\n     * a pie slice angle).\n     */\n\n    _this.angleKey = '';\n    _this.angleName = '';\n    _this._fills = palette.fills;\n    _this._strokes = palette.strokes;\n    _this.fillOpacity = 1;\n    _this.strokeOpacity = 1;\n    /**\n     * The series rotation in degrees.\n     */\n\n    _this.rotation = 0;\n    _this.outerRadiusOffset = 0;\n    _this.innerRadiusOffset = 0;\n    _this.strokeWidth = 1;\n    _this.highlightStyle = {\n      fill: 'yellow'\n    };\n\n    _this.addEventListener('update', _this.update, _this);\n\n    _this.label.addEventListener('change', _this.scheduleLayout, _this);\n\n    _this.label.addEventListener('dataChange', _this.scheduleData, _this);\n\n    _this.callout.addEventListener('change', _this.scheduleLayout, _this);\n\n    _this.addPropertyListener('data', function (event) {\n      event.source.seriesItemEnabled = event.value.map(function () {\n        return true;\n      });\n    });\n\n    return _this;\n  }\n\n  Object.defineProperty(PieSeries.prototype, \"title\", {\n    get: function get() {\n      return this._title;\n    },\n    set: function set(value) {\n      var oldTitle = this._title;\n\n      if (oldTitle !== value) {\n        if (oldTitle) {\n          oldTitle.removeEventListener('change', this.scheduleLayout);\n          this.group.removeChild(oldTitle.node);\n        }\n\n        if (value) {\n          value.node.textBaseline = 'bottom';\n          value.addEventListener('change', this.scheduleLayout);\n          this.group.appendChild(value.node);\n        }\n\n        this._title = value;\n        this.scheduleLayout();\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(PieSeries.prototype, \"fills\", {\n    get: function get() {\n      return this._fills;\n    },\n    set: function set(values) {\n      this._fills = values;\n      this.strokes = values.map(function (color) {\n        return Color.fromString(color).darker().toHexString();\n      });\n      this.scheduleData();\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(PieSeries.prototype, \"strokes\", {\n    get: function get() {\n      return this._strokes;\n    },\n    set: function set(values) {\n      this._strokes = values;\n      this.callout.colors = values;\n      this.scheduleData();\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  PieSeries.prototype.onHighlightChange = function () {\n    this.updateNodes();\n  };\n\n  PieSeries.prototype.getDomain = function (direction) {\n    if (direction === ChartAxisDirection.X) {\n      return this.angleScale.domain;\n    } else {\n      return this.radiusScale.domain;\n    }\n  };\n\n  PieSeries.prototype.processData = function () {\n    var _this = this;\n\n    var _a = this,\n        angleKey = _a.angleKey,\n        radiusKey = _a.radiusKey,\n        seriesItemEnabled = _a.seriesItemEnabled,\n        angleScale = _a.angleScale,\n        groupSelectionData = _a.groupSelectionData;\n\n    var data = angleKey && this.data ? this.data : [];\n    var angleData = data.map(function (datum, index) {\n      return seriesItemEnabled[index] && Math.abs(+datum[angleKey]) || 0;\n    });\n    var angleDataTotal = angleData.reduce(function (a, b) {\n      return a + b;\n    }, 0); // The ratios (in [0, 1] interval) used to calculate the end angle value for every pie slice.\n    // Each slice starts where the previous one ends, so we only keep the ratios for end angles.\n\n    var angleDataRatios = function () {\n      var sum = 0;\n      return angleData.map(function (datum) {\n        return sum += datum / angleDataTotal;\n      });\n    }();\n\n    var labelKey = this.label.enabled && this.labelKey;\n    var labelData = labelKey ? data.map(function (datum) {\n      return String(datum[labelKey]);\n    }) : [];\n    var useRadiusKey = !!radiusKey && !this.innerRadiusOffset;\n    var radiusData = [];\n\n    if (useRadiusKey) {\n      var radii = data.map(function (datum) {\n        return Math.abs(datum[radiusKey]);\n      });\n      var maxDatum_1 = Math.max.apply(Math, radii);\n      radiusData = radii.map(function (value) {\n        return value / maxDatum_1;\n      });\n    }\n\n    groupSelectionData.length = 0;\n    var rotation = toRadians(this.rotation);\n    var halfPi = Math.PI / 2;\n    var datumIndex = 0; // Simply use reduce here to pair up adjacent ratios.\n\n    angleDataRatios.reduce(function (start, end) {\n      var radius = useRadiusKey ? radiusData[datumIndex] : 1;\n      var startAngle = angleScale.convert(start) + rotation;\n      var endAngle = angleScale.convert(end) + rotation;\n      var midAngle = (startAngle + endAngle) / 2;\n      var span = Math.abs(endAngle - startAngle);\n      var midCos = Math.cos(midAngle);\n      var midSin = Math.sin(midAngle);\n      var labelMinAngle = toRadians(_this.label.minAngle);\n      var labelVisible = labelKey && span > labelMinAngle;\n      var midAngle180 = normalizeAngle180(midAngle); // Split the circle into quadrants like so: âŠ—\n\n      var quadrantStart = -3 * Math.PI / 4; // same as `normalizeAngle180(toRadians(-135))`\n\n      var textAlign;\n      var textBaseline;\n\n      if (midAngle180 >= quadrantStart && midAngle180 < (quadrantStart += halfPi)) {\n        textAlign = 'center';\n        textBaseline = 'bottom';\n      } else if (midAngle180 >= quadrantStart && midAngle180 < (quadrantStart += halfPi)) {\n        textAlign = 'left';\n        textBaseline = 'middle';\n      } else if (midAngle180 >= quadrantStart && midAngle180 < (quadrantStart += halfPi)) {\n        textAlign = 'center';\n        textBaseline = 'hanging';\n      } else {\n        textAlign = 'right';\n        textBaseline = 'middle';\n      }\n\n      groupSelectionData.push({\n        series: _this,\n        seriesDatum: data[datumIndex],\n        index: datumIndex,\n        radius: radius,\n        startAngle: startAngle,\n        endAngle: endAngle,\n        midAngle: midAngle,\n        midCos: midCos,\n        midSin: midSin,\n        label: labelVisible ? {\n          text: labelData[datumIndex],\n          textAlign: textAlign,\n          textBaseline: textBaseline\n        } : undefined\n      });\n      datumIndex++;\n      return end;\n    }, 0);\n    return true;\n  };\n\n  PieSeries.prototype.update = function () {\n    var chart = this.chart;\n    var visible = this.group.visible = this.visible && this.seriesItemEnabled.indexOf(true) >= 0;\n\n    if (!visible || !chart || chart.dataPending || chart.layoutPending) {\n      return;\n    }\n\n    this.radiusScale.range = [0, this.radius];\n    this.group.translationX = this.centerX;\n    this.group.translationY = this.centerY;\n    var title = this.title;\n\n    if (title) {\n      title.node.translationY = -this.radius - this.outerRadiusOffset - 2;\n      title.node.visible = title.enabled;\n    }\n\n    this.updateGroupSelection();\n    this.updateNodes();\n  };\n\n  PieSeries.prototype.updateGroupSelection = function () {\n    var updateGroups = this.groupSelection.setData(this.groupSelectionData);\n    updateGroups.exit.remove();\n    var enterGroups = updateGroups.enter.append(Group);\n    enterGroups.append(Sector).each(function (node) {\n      return node.tag = PieNodeTag.Sector;\n    });\n    enterGroups.append(Line).each(function (node) {\n      node.tag = PieNodeTag.Callout;\n      node.pointerEvents = PointerEvents.None;\n    });\n    enterGroups.append(Text).each(function (node) {\n      node.tag = PieNodeTag.Label;\n      node.pointerEvents = PointerEvents.None;\n    });\n    this.groupSelection = updateGroups.merge(enterGroups);\n  };\n\n  PieSeries.prototype.updateNodes = function () {\n    var _a = this,\n        fills = _a.fills,\n        strokes = _a.strokes,\n        fillOpacity = _a.fillOpacity,\n        strokeOpacity = _a.strokeOpacity,\n        strokeWidth = _a.strokeWidth,\n        outerRadiusOffset = _a.outerRadiusOffset,\n        innerRadiusOffset = _a.innerRadiusOffset,\n        radiusScale = _a.radiusScale,\n        callout = _a.callout,\n        shadow = _a.shadow,\n        _b = _a.highlightStyle,\n        fill = _b.fill,\n        stroke = _b.stroke,\n        centerOffset = _b.centerOffset;\n\n    var highlightedDatum = this.chart.highlightedDatum;\n    var minOuterRadius = Infinity;\n    var outerRadii = [];\n    var centerOffsets = [];\n    this.groupSelection.selectByTag(PieNodeTag.Sector).each(function (sector, datum, index) {\n      var radius = radiusScale.convert(datum.radius);\n      var outerRadius = Math.max(0, radius + outerRadiusOffset);\n\n      if (minOuterRadius > outerRadius) {\n        minOuterRadius = outerRadius;\n      }\n\n      sector.outerRadius = outerRadius;\n      sector.innerRadius = Math.max(0, innerRadiusOffset ? radius + innerRadiusOffset : 0);\n      sector.startAngle = datum.startAngle;\n      sector.endAngle = datum.endAngle;\n      var highlighted = datum === highlightedDatum;\n      sector.fill = highlighted && fill !== undefined ? fill : fills[index % fills.length];\n      sector.stroke = highlighted && stroke !== undefined ? stroke : strokes[index % strokes.length];\n      sector.fillOpacity = fillOpacity;\n      sector.strokeOpacity = strokeOpacity;\n      sector.centerOffset = highlighted && centerOffset !== undefined ? centerOffset : 0;\n      sector.fillShadow = shadow;\n      sector.strokeWidth = strokeWidth;\n      sector.lineJoin = 'round';\n      outerRadii.push(outerRadius);\n      centerOffsets.push(sector.centerOffset);\n    });\n    var calloutColors = callout.colors,\n        calloutLength = callout.length,\n        calloutStrokeWidth = callout.strokeWidth;\n    this.groupSelection.selectByTag(PieNodeTag.Callout).each(function (line, datum, index) {\n      if (datum.label) {\n        var outerRadius = centerOffsets[index] + outerRadii[index];\n        line.strokeWidth = calloutStrokeWidth;\n        line.stroke = calloutColors[index % calloutColors.length];\n        line.x1 = datum.midCos * outerRadius;\n        line.y1 = datum.midSin * outerRadius;\n        line.x2 = datum.midCos * (outerRadius + calloutLength);\n        line.y2 = datum.midSin * (outerRadius + calloutLength);\n      } else {\n        line.stroke = undefined;\n      }\n    });\n    {\n      var _c = this.label,\n          offset_1 = _c.offset,\n          fontStyle_1 = _c.fontStyle,\n          fontWeight_1 = _c.fontWeight,\n          fontSize_1 = _c.fontSize,\n          fontFamily_1 = _c.fontFamily,\n          color_1 = _c.color;\n      this.groupSelection.selectByTag(PieNodeTag.Label).each(function (text, datum, index) {\n        var label = datum.label;\n\n        if (label) {\n          var outerRadius = outerRadii[index];\n          var labelRadius = centerOffsets[index] + outerRadius + calloutLength + offset_1;\n          text.fontStyle = fontStyle_1;\n          text.fontWeight = fontWeight_1;\n          text.fontSize = fontSize_1;\n          text.fontFamily = fontFamily_1;\n          text.text = label.text;\n          text.x = datum.midCos * labelRadius;\n          text.y = datum.midSin * labelRadius;\n          text.fill = color_1;\n          text.textAlign = label.textAlign;\n          text.textBaseline = label.textBaseline;\n        } else {\n          text.fill = undefined;\n        }\n      });\n    }\n  };\n\n  PieSeries.prototype.fireNodeClickEvent = function (datum) {\n    this.fireEvent({\n      type: 'nodeClick',\n      series: this,\n      datum: datum.seriesDatum,\n      angleKey: this.angleKey,\n      radiusKey: this.radiusKey\n    });\n  };\n\n  PieSeries.prototype.getTooltipHtml = function (nodeDatum) {\n    var angleKey = this.angleKey;\n\n    if (!angleKey) {\n      return '';\n    }\n\n    var _a = this,\n        title = _a.title,\n        fills = _a.fills,\n        tooltipRenderer = _a.tooltipRenderer,\n        angleName = _a.angleName,\n        radiusKey = _a.radiusKey,\n        radiusName = _a.radiusName,\n        labelKey = _a.labelKey,\n        labelName = _a.labelName;\n\n    var text = title ? title.text : undefined;\n    var color = fills[nodeDatum.index % fills.length];\n\n    if (tooltipRenderer) {\n      return tooltipRenderer({\n        datum: nodeDatum.seriesDatum,\n        angleKey: angleKey,\n        angleName: angleName,\n        radiusKey: radiusKey,\n        radiusName: radiusName,\n        labelKey: labelKey,\n        labelName: labelName,\n        title: text,\n        color: color\n      });\n    } else {\n      var titleStyle = \"style=\\\"color: white; background-color: \" + color + \"\\\"\";\n      var titleString = title ? \"<div class=\\\"\" + Chart.defaultTooltipClass + \"-title\\\" \" + titleStyle + \">\" + text + \"</div>\" : '';\n      var label = labelKey ? nodeDatum.seriesDatum[labelKey] + \": \" : '';\n      var value = nodeDatum.seriesDatum[angleKey];\n      var formattedValue = typeof value === 'number' ? toFixed(value) : value.toString();\n      return titleString + \"<div class=\\\"\" + Chart.defaultTooltipClass + \"-content\\\">\" + label + formattedValue + \"</div>\";\n    }\n  };\n\n  PieSeries.prototype.listSeriesItems = function (legendData) {\n    var _this = this;\n\n    var _a = this,\n        labelKey = _a.labelKey,\n        data = _a.data;\n\n    if (data && data.length && labelKey) {\n      var _b = this,\n          fills_1 = _b.fills,\n          strokes_1 = _b.strokes,\n          id_1 = _b.id;\n\n      data.forEach(function (datum, index) {\n        legendData.push({\n          id: id_1,\n          itemId: index,\n          enabled: _this.seriesItemEnabled[index],\n          label: {\n            text: String(datum[labelKey])\n          },\n          marker: {\n            fill: fills_1[index % fills_1.length],\n            stroke: strokes_1[index % strokes_1.length],\n            fillOpacity: _this.fillOpacity,\n            strokeOpacity: _this.strokeOpacity\n          }\n        });\n      });\n    }\n  };\n\n  PieSeries.prototype.toggleSeriesItem = function (itemId, enabled) {\n    this.seriesItemEnabled[itemId] = enabled;\n    this.scheduleData();\n  };\n\n  PieSeries.className = 'PieSeries';\n  PieSeries.type = 'pie';\n\n  __decorate([reactive('dataChange')], PieSeries.prototype, \"angleKey\", void 0);\n\n  __decorate([reactive('update')], PieSeries.prototype, \"angleName\", void 0);\n\n  __decorate([reactive('dataChange')], PieSeries.prototype, \"radiusKey\", void 0);\n\n  __decorate([reactive('update')], PieSeries.prototype, \"radiusName\", void 0);\n\n  __decorate([reactive('dataChange')], PieSeries.prototype, \"labelKey\", void 0);\n\n  __decorate([reactive('update')], PieSeries.prototype, \"labelName\", void 0);\n\n  __decorate([reactive('layoutChange')], PieSeries.prototype, \"fillOpacity\", void 0);\n\n  __decorate([reactive('layoutChange')], PieSeries.prototype, \"strokeOpacity\", void 0);\n\n  __decorate([reactive('dataChange')], PieSeries.prototype, \"rotation\", void 0);\n\n  __decorate([reactive('layoutChange')], PieSeries.prototype, \"outerRadiusOffset\", void 0);\n\n  __decorate([reactive('dataChange')], PieSeries.prototype, \"innerRadiusOffset\", void 0);\n\n  __decorate([reactive('layoutChange')], PieSeries.prototype, \"strokeWidth\", void 0);\n\n  __decorate([reactive('layoutChange')], PieSeries.prototype, \"shadow\", void 0);\n\n  return PieSeries;\n}(PolarSeries);\n\nexport { PieSeries };","map":{"version":3,"sources":["/Users/fouaddakhel/Projects/Nana/ReactJS/supermarket_dashboard/supermarket_dashboard/node_modules/ag-charts-community/dist/es6/chart/series/polar/pieSeries.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","__decorate","decorators","target","key","desc","c","arguments","length","r","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","Group","Line","Text","Selection","LinearScale","palette","Sector","Label","PointerEvents","normalizeAngle180","toRadians","Color","toFixed","reactive","Observable","PolarSeries","ChartAxisDirection","Chart","PieNodeTag","PieSeriesLabel","_super","_this","apply","offset","minAngle","PieSeriesCallout","colors","strokes","strokeWidth","PieSeries","call","radiusScale","groupSelection","select","group","selectAll","groupSelectionData","angleScale","scale","domain","range","Math","PI","map","angle","seriesItemEnabled","label","callout","angleKey","angleName","_fills","fills","_strokes","fillOpacity","strokeOpacity","rotation","outerRadiusOffset","innerRadiusOffset","highlightStyle","fill","addEventListener","update","scheduleLayout","scheduleData","addPropertyListener","event","source","value","get","_title","set","oldTitle","removeEventListener","removeChild","node","textBaseline","appendChild","enumerable","configurable","values","color","fromString","darker","toHexString","onHighlightChange","updateNodes","getDomain","direction","X","processData","_a","radiusKey","data","angleData","datum","index","abs","angleDataTotal","reduce","a","angleDataRatios","sum","labelKey","enabled","labelData","String","useRadiusKey","radiusData","radii","maxDatum_1","max","halfPi","datumIndex","start","end","radius","startAngle","convert","endAngle","midAngle","span","midCos","cos","midSin","sin","labelMinAngle","labelVisible","midAngle180","quadrantStart","textAlign","push","series","seriesDatum","text","undefined","chart","visible","indexOf","dataPending","layoutPending","translationX","centerX","translationY","centerY","title","updateGroupSelection","updateGroups","setData","exit","remove","enterGroups","enter","append","each","tag","Callout","pointerEvents","None","merge","shadow","_b","stroke","centerOffset","highlightedDatum","minOuterRadius","Infinity","outerRadii","centerOffsets","selectByTag","sector","outerRadius","innerRadius","highlighted","fillShadow","lineJoin","calloutColors","calloutLength","calloutStrokeWidth","line","x1","y1","x2","y2","_c","offset_1","fontStyle_1","fontStyle","fontWeight_1","fontWeight","fontSize_1","fontSize","fontFamily_1","fontFamily","color_1","labelRadius","x","y","fireNodeClickEvent","fireEvent","type","getTooltipHtml","nodeDatum","tooltipRenderer","radiusName","labelName","titleStyle","titleString","defaultTooltipClass","formattedValue","toString","listSeriesItems","legendData","fills_1","strokes_1","id_1","id","forEach","itemId","marker","toggleSeriesItem","className"],"mappings":"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","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Group } from \"../../../scene/group\";\nimport { Line } from \"../../../scene/shape/line\";\nimport { Text } from \"../../../scene/shape/text\";\nimport { Selection } from \"../../../scene/selection\";\nimport { LinearScale } from \"../../../scale/linearScale\";\nimport palette from \"../../palettes\";\nimport { Sector } from \"../../../scene/shape/sector\";\nimport { Label } from \"../../label\";\nimport { PointerEvents } from \"../../../scene/node\";\nimport { normalizeAngle180, toRadians } from \"../../../util/angle\";\nimport { Color } from \"../../../util/color\";\nimport { toFixed } from \"../../../util/number\";\nimport { reactive, Observable } from \"../../../util/observable\";\nimport { PolarSeries } from \"./polarSeries\";\nimport { ChartAxisDirection } from \"../../chartAxis\";\nimport { Chart } from \"../../chart\";\nvar PieNodeTag;\n(function (PieNodeTag) {\n    PieNodeTag[PieNodeTag[\"Sector\"] = 0] = \"Sector\";\n    PieNodeTag[PieNodeTag[\"Callout\"] = 1] = \"Callout\";\n    PieNodeTag[PieNodeTag[\"Label\"] = 2] = \"Label\";\n})(PieNodeTag || (PieNodeTag = {}));\nvar PieSeriesLabel = /** @class */ (function (_super) {\n    __extends(PieSeriesLabel, _super);\n    function PieSeriesLabel() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.offset = 3; // from the callout line\n        _this.minAngle = 20; // in degrees\n        return _this;\n    }\n    __decorate([\n        reactive('change')\n    ], PieSeriesLabel.prototype, \"offset\", void 0);\n    __decorate([\n        reactive('dataChange')\n    ], PieSeriesLabel.prototype, \"minAngle\", void 0);\n    return PieSeriesLabel;\n}(Label));\nvar PieSeriesCallout = /** @class */ (function (_super) {\n    __extends(PieSeriesCallout, _super);\n    function PieSeriesCallout() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.colors = palette.strokes;\n        _this.length = 10;\n        _this.strokeWidth = 1;\n        return _this;\n    }\n    __decorate([\n        reactive('change')\n    ], PieSeriesCallout.prototype, \"colors\", void 0);\n    __decorate([\n        reactive('change')\n    ], PieSeriesCallout.prototype, \"length\", void 0);\n    __decorate([\n        reactive('change')\n    ], PieSeriesCallout.prototype, \"strokeWidth\", void 0);\n    return PieSeriesCallout;\n}(Observable));\nvar PieSeries = /** @class */ (function (_super) {\n    __extends(PieSeries, _super);\n    function PieSeries() {\n        var _this = _super.call(this) || this;\n        _this.radiusScale = new LinearScale();\n        _this.groupSelection = Selection.select(_this.group).selectAll();\n        /**\n         * The processed data that gets visualized.\n         */\n        _this.groupSelectionData = [];\n        _this.angleScale = (function () {\n            var scale = new LinearScale();\n            // Each slice is a ratio of the whole, where all ratios add up to 1.\n            scale.domain = [0, 1];\n            // Add 90 deg to start the first pie at 12 o'clock.\n            scale.range = [-Math.PI, Math.PI].map(function (angle) { return angle + Math.PI / 2; });\n            return scale;\n        })();\n        // When a user toggles a series item (e.g. from the legend), its boolean state is recorded here.\n        _this.seriesItemEnabled = [];\n        _this.label = new PieSeriesLabel();\n        _this.callout = new PieSeriesCallout();\n        /**\n         * The key of the numeric field to use to determine the angle (for example,\n         * a pie slice angle).\n         */\n        _this.angleKey = '';\n        _this.angleName = '';\n        _this._fills = palette.fills;\n        _this._strokes = palette.strokes;\n        _this.fillOpacity = 1;\n        _this.strokeOpacity = 1;\n        /**\n         * The series rotation in degrees.\n         */\n        _this.rotation = 0;\n        _this.outerRadiusOffset = 0;\n        _this.innerRadiusOffset = 0;\n        _this.strokeWidth = 1;\n        _this.highlightStyle = { fill: 'yellow' };\n        _this.addEventListener('update', _this.update, _this);\n        _this.label.addEventListener('change', _this.scheduleLayout, _this);\n        _this.label.addEventListener('dataChange', _this.scheduleData, _this);\n        _this.callout.addEventListener('change', _this.scheduleLayout, _this);\n        _this.addPropertyListener('data', function (event) {\n            event.source.seriesItemEnabled = event.value.map(function () { return true; });\n        });\n        return _this;\n    }\n    Object.defineProperty(PieSeries.prototype, \"title\", {\n        get: function () {\n            return this._title;\n        },\n        set: function (value) {\n            var oldTitle = this._title;\n            if (oldTitle !== value) {\n                if (oldTitle) {\n                    oldTitle.removeEventListener('change', this.scheduleLayout);\n                    this.group.removeChild(oldTitle.node);\n                }\n                if (value) {\n                    value.node.textBaseline = 'bottom';\n                    value.addEventListener('change', this.scheduleLayout);\n                    this.group.appendChild(value.node);\n                }\n                this._title = value;\n                this.scheduleLayout();\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(PieSeries.prototype, \"fills\", {\n        get: function () {\n            return this._fills;\n        },\n        set: function (values) {\n            this._fills = values;\n            this.strokes = values.map(function (color) { return Color.fromString(color).darker().toHexString(); });\n            this.scheduleData();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(PieSeries.prototype, \"strokes\", {\n        get: function () {\n            return this._strokes;\n        },\n        set: function (values) {\n            this._strokes = values;\n            this.callout.colors = values;\n            this.scheduleData();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    PieSeries.prototype.onHighlightChange = function () {\n        this.updateNodes();\n    };\n    PieSeries.prototype.getDomain = function (direction) {\n        if (direction === ChartAxisDirection.X) {\n            return this.angleScale.domain;\n        }\n        else {\n            return this.radiusScale.domain;\n        }\n    };\n    PieSeries.prototype.processData = function () {\n        var _this = this;\n        var _a = this, angleKey = _a.angleKey, radiusKey = _a.radiusKey, seriesItemEnabled = _a.seriesItemEnabled, angleScale = _a.angleScale, groupSelectionData = _a.groupSelectionData;\n        var data = angleKey && this.data ? this.data : [];\n        var angleData = data.map(function (datum, index) { return seriesItemEnabled[index] && Math.abs(+datum[angleKey]) || 0; });\n        var angleDataTotal = angleData.reduce(function (a, b) { return a + b; }, 0);\n        // The ratios (in [0, 1] interval) used to calculate the end angle value for every pie slice.\n        // Each slice starts where the previous one ends, so we only keep the ratios for end angles.\n        var angleDataRatios = (function () {\n            var sum = 0;\n            return angleData.map(function (datum) { return sum += datum / angleDataTotal; });\n        })();\n        var labelKey = this.label.enabled && this.labelKey;\n        var labelData = labelKey ? data.map(function (datum) { return String(datum[labelKey]); }) : [];\n        var useRadiusKey = !!radiusKey && !this.innerRadiusOffset;\n        var radiusData = [];\n        if (useRadiusKey) {\n            var radii = data.map(function (datum) { return Math.abs(datum[radiusKey]); });\n            var maxDatum_1 = Math.max.apply(Math, radii);\n            radiusData = radii.map(function (value) { return value / maxDatum_1; });\n        }\n        groupSelectionData.length = 0;\n        var rotation = toRadians(this.rotation);\n        var halfPi = Math.PI / 2;\n        var datumIndex = 0;\n        // Simply use reduce here to pair up adjacent ratios.\n        angleDataRatios.reduce(function (start, end) {\n            var radius = useRadiusKey ? radiusData[datumIndex] : 1;\n            var startAngle = angleScale.convert(start) + rotation;\n            var endAngle = angleScale.convert(end) + rotation;\n            var midAngle = (startAngle + endAngle) / 2;\n            var span = Math.abs(endAngle - startAngle);\n            var midCos = Math.cos(midAngle);\n            var midSin = Math.sin(midAngle);\n            var labelMinAngle = toRadians(_this.label.minAngle);\n            var labelVisible = labelKey && span > labelMinAngle;\n            var midAngle180 = normalizeAngle180(midAngle);\n            // Split the circle into quadrants like so: âŠ—\n            var quadrantStart = -3 * Math.PI / 4; // same as `normalizeAngle180(toRadians(-135))`\n            var textAlign;\n            var textBaseline;\n            if (midAngle180 >= quadrantStart && midAngle180 < (quadrantStart += halfPi)) {\n                textAlign = 'center';\n                textBaseline = 'bottom';\n            }\n            else if (midAngle180 >= quadrantStart && midAngle180 < (quadrantStart += halfPi)) {\n                textAlign = 'left';\n                textBaseline = 'middle';\n            }\n            else if (midAngle180 >= quadrantStart && midAngle180 < (quadrantStart += halfPi)) {\n                textAlign = 'center';\n                textBaseline = 'hanging';\n            }\n            else {\n                textAlign = 'right';\n                textBaseline = 'middle';\n            }\n            groupSelectionData.push({\n                series: _this,\n                seriesDatum: data[datumIndex],\n                index: datumIndex,\n                radius: radius,\n                startAngle: startAngle,\n                endAngle: endAngle,\n                midAngle: midAngle,\n                midCos: midCos,\n                midSin: midSin,\n                label: labelVisible ? {\n                    text: labelData[datumIndex],\n                    textAlign: textAlign,\n                    textBaseline: textBaseline\n                } : undefined\n            });\n            datumIndex++;\n            return end;\n        }, 0);\n        return true;\n    };\n    PieSeries.prototype.update = function () {\n        var chart = this.chart;\n        var visible = this.group.visible = this.visible && this.seriesItemEnabled.indexOf(true) >= 0;\n        if (!visible || !chart || chart.dataPending || chart.layoutPending) {\n            return;\n        }\n        this.radiusScale.range = [0, this.radius];\n        this.group.translationX = this.centerX;\n        this.group.translationY = this.centerY;\n        var title = this.title;\n        if (title) {\n            title.node.translationY = -this.radius - this.outerRadiusOffset - 2;\n            title.node.visible = title.enabled;\n        }\n        this.updateGroupSelection();\n        this.updateNodes();\n    };\n    PieSeries.prototype.updateGroupSelection = function () {\n        var updateGroups = this.groupSelection.setData(this.groupSelectionData);\n        updateGroups.exit.remove();\n        var enterGroups = updateGroups.enter.append(Group);\n        enterGroups.append(Sector).each(function (node) { return node.tag = PieNodeTag.Sector; });\n        enterGroups.append(Line).each(function (node) {\n            node.tag = PieNodeTag.Callout;\n            node.pointerEvents = PointerEvents.None;\n        });\n        enterGroups.append(Text).each(function (node) {\n            node.tag = PieNodeTag.Label;\n            node.pointerEvents = PointerEvents.None;\n        });\n        this.groupSelection = updateGroups.merge(enterGroups);\n    };\n    PieSeries.prototype.updateNodes = function () {\n        var _a = this, fills = _a.fills, strokes = _a.strokes, fillOpacity = _a.fillOpacity, strokeOpacity = _a.strokeOpacity, strokeWidth = _a.strokeWidth, outerRadiusOffset = _a.outerRadiusOffset, innerRadiusOffset = _a.innerRadiusOffset, radiusScale = _a.radiusScale, callout = _a.callout, shadow = _a.shadow, _b = _a.highlightStyle, fill = _b.fill, stroke = _b.stroke, centerOffset = _b.centerOffset;\n        var highlightedDatum = this.chart.highlightedDatum;\n        var minOuterRadius = Infinity;\n        var outerRadii = [];\n        var centerOffsets = [];\n        this.groupSelection.selectByTag(PieNodeTag.Sector).each(function (sector, datum, index) {\n            var radius = radiusScale.convert(datum.radius);\n            var outerRadius = Math.max(0, radius + outerRadiusOffset);\n            if (minOuterRadius > outerRadius) {\n                minOuterRadius = outerRadius;\n            }\n            sector.outerRadius = outerRadius;\n            sector.innerRadius = Math.max(0, innerRadiusOffset ? radius + innerRadiusOffset : 0);\n            sector.startAngle = datum.startAngle;\n            sector.endAngle = datum.endAngle;\n            var highlighted = datum === highlightedDatum;\n            sector.fill = highlighted && fill !== undefined ? fill : fills[index % fills.length];\n            sector.stroke = highlighted && stroke !== undefined ? stroke : strokes[index % strokes.length];\n            sector.fillOpacity = fillOpacity;\n            sector.strokeOpacity = strokeOpacity;\n            sector.centerOffset = highlighted && centerOffset !== undefined ? centerOffset : 0;\n            sector.fillShadow = shadow;\n            sector.strokeWidth = strokeWidth;\n            sector.lineJoin = 'round';\n            outerRadii.push(outerRadius);\n            centerOffsets.push(sector.centerOffset);\n        });\n        var calloutColors = callout.colors, calloutLength = callout.length, calloutStrokeWidth = callout.strokeWidth;\n        this.groupSelection.selectByTag(PieNodeTag.Callout).each(function (line, datum, index) {\n            if (datum.label) {\n                var outerRadius = centerOffsets[index] + outerRadii[index];\n                line.strokeWidth = calloutStrokeWidth;\n                line.stroke = calloutColors[index % calloutColors.length];\n                line.x1 = datum.midCos * outerRadius;\n                line.y1 = datum.midSin * outerRadius;\n                line.x2 = datum.midCos * (outerRadius + calloutLength);\n                line.y2 = datum.midSin * (outerRadius + calloutLength);\n            }\n            else {\n                line.stroke = undefined;\n            }\n        });\n        {\n            var _c = this.label, offset_1 = _c.offset, fontStyle_1 = _c.fontStyle, fontWeight_1 = _c.fontWeight, fontSize_1 = _c.fontSize, fontFamily_1 = _c.fontFamily, color_1 = _c.color;\n            this.groupSelection.selectByTag(PieNodeTag.Label).each(function (text, datum, index) {\n                var label = datum.label;\n                if (label) {\n                    var outerRadius = outerRadii[index];\n                    var labelRadius = centerOffsets[index] + outerRadius + calloutLength + offset_1;\n                    text.fontStyle = fontStyle_1;\n                    text.fontWeight = fontWeight_1;\n                    text.fontSize = fontSize_1;\n                    text.fontFamily = fontFamily_1;\n                    text.text = label.text;\n                    text.x = datum.midCos * labelRadius;\n                    text.y = datum.midSin * labelRadius;\n                    text.fill = color_1;\n                    text.textAlign = label.textAlign;\n                    text.textBaseline = label.textBaseline;\n                }\n                else {\n                    text.fill = undefined;\n                }\n            });\n        }\n    };\n    PieSeries.prototype.fireNodeClickEvent = function (datum) {\n        this.fireEvent({\n            type: 'nodeClick',\n            series: this,\n            datum: datum.seriesDatum,\n            angleKey: this.angleKey,\n            radiusKey: this.radiusKey\n        });\n    };\n    PieSeries.prototype.getTooltipHtml = function (nodeDatum) {\n        var angleKey = this.angleKey;\n        if (!angleKey) {\n            return '';\n        }\n        var _a = this, title = _a.title, fills = _a.fills, tooltipRenderer = _a.tooltipRenderer, angleName = _a.angleName, radiusKey = _a.radiusKey, radiusName = _a.radiusName, labelKey = _a.labelKey, labelName = _a.labelName;\n        var text = title ? title.text : undefined;\n        var color = fills[nodeDatum.index % fills.length];\n        if (tooltipRenderer) {\n            return tooltipRenderer({\n                datum: nodeDatum.seriesDatum,\n                angleKey: angleKey,\n                angleName: angleName,\n                radiusKey: radiusKey,\n                radiusName: radiusName,\n                labelKey: labelKey,\n                labelName: labelName,\n                title: text,\n                color: color,\n            });\n        }\n        else {\n            var titleStyle = \"style=\\\"color: white; background-color: \" + color + \"\\\"\";\n            var titleString = title ? \"<div class=\\\"\" + Chart.defaultTooltipClass + \"-title\\\" \" + titleStyle + \">\" + text + \"</div>\" : '';\n            var label = labelKey ? nodeDatum.seriesDatum[labelKey] + \": \" : '';\n            var value = nodeDatum.seriesDatum[angleKey];\n            var formattedValue = typeof value === 'number' ? toFixed(value) : value.toString();\n            return titleString + \"<div class=\\\"\" + Chart.defaultTooltipClass + \"-content\\\">\" + label + formattedValue + \"</div>\";\n        }\n    };\n    PieSeries.prototype.listSeriesItems = function (legendData) {\n        var _this = this;\n        var _a = this, labelKey = _a.labelKey, data = _a.data;\n        if (data && data.length && labelKey) {\n            var _b = this, fills_1 = _b.fills, strokes_1 = _b.strokes, id_1 = _b.id;\n            data.forEach(function (datum, index) {\n                legendData.push({\n                    id: id_1,\n                    itemId: index,\n                    enabled: _this.seriesItemEnabled[index],\n                    label: {\n                        text: String(datum[labelKey])\n                    },\n                    marker: {\n                        fill: fills_1[index % fills_1.length],\n                        stroke: strokes_1[index % strokes_1.length],\n                        fillOpacity: _this.fillOpacity,\n                        strokeOpacity: _this.strokeOpacity\n                    }\n                });\n            });\n        }\n    };\n    PieSeries.prototype.toggleSeriesItem = function (itemId, enabled) {\n        this.seriesItemEnabled[itemId] = enabled;\n        this.scheduleData();\n    };\n    PieSeries.className = 'PieSeries';\n    PieSeries.type = 'pie';\n    __decorate([\n        reactive('dataChange')\n    ], PieSeries.prototype, \"angleKey\", void 0);\n    __decorate([\n        reactive('update')\n    ], PieSeries.prototype, \"angleName\", void 0);\n    __decorate([\n        reactive('dataChange')\n    ], PieSeries.prototype, \"radiusKey\", void 0);\n    __decorate([\n        reactive('update')\n    ], PieSeries.prototype, \"radiusName\", void 0);\n    __decorate([\n        reactive('dataChange')\n    ], PieSeries.prototype, \"labelKey\", void 0);\n    __decorate([\n        reactive('update')\n    ], PieSeries.prototype, \"labelName\", void 0);\n    __decorate([\n        reactive('layoutChange')\n    ], PieSeries.prototype, \"fillOpacity\", void 0);\n    __decorate([\n        reactive('layoutChange')\n    ], PieSeries.prototype, \"strokeOpacity\", void 0);\n    __decorate([\n        reactive('dataChange')\n    ], PieSeries.prototype, \"rotation\", void 0);\n    __decorate([\n        reactive('layoutChange')\n    ], PieSeries.prototype, \"outerRadiusOffset\", void 0);\n    __decorate([\n        reactive('dataChange')\n    ], PieSeries.prototype, \"innerRadiusOffset\", void 0);\n    __decorate([\n        reactive('layoutChange')\n    ], PieSeries.prototype, \"strokeWidth\", void 0);\n    __decorate([\n        reactive('layoutChange')\n    ], PieSeries.prototype, \"shadow\", void 0);\n    return PieSeries;\n}(PolarSeries));\nexport { PieSeries };\n"]},"metadata":{},"sourceType":"module"}