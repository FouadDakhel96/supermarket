{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nimport { _, Autowired, Bean, BeanStub, Constants, Events, NumberSequence, PostConstruct, PreDestroy, RowNodeBlockLoader, RowNodeCache } from \"@ag-grid-community/core\";\nimport { InfiniteCache } from \"./infiniteCache\";\n\nvar InfiniteRowModel =\n/** @class */\nfunction (_super) {\n  __extends(InfiniteRowModel, _super);\n\n  function InfiniteRowModel() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  InfiniteRowModel.prototype.getRowBounds = function (index) {\n    return {\n      rowHeight: this.rowHeight,\n      rowTop: this.rowHeight * index\n    };\n  }; // we don't implement as lazy row heights is not supported in this row model\n\n\n  InfiniteRowModel.prototype.ensureRowHeightsValid = function (startPixel, endPixel, startLimitIndex, endLimitIndex) {\n    return false;\n  };\n\n  InfiniteRowModel.prototype.init = function () {\n    var _this = this;\n\n    if (!this.gridOptionsWrapper.isRowModelInfinite()) {\n      return;\n    }\n\n    this.rowHeight = this.gridOptionsWrapper.getRowHeightAsNumber();\n    this.addEventListeners();\n    this.addDestroyFunc(function () {\n      return _this.destroyCache();\n    });\n  };\n\n  InfiniteRowModel.prototype.start = function () {\n    this.setDatasource(this.gridOptionsWrapper.getDatasource());\n  };\n\n  InfiniteRowModel.prototype.destroyDatasource = function () {\n    if (this.datasource) {\n      this.getContext().destroyBean(this.datasource);\n      this.rowRenderer.datasourceChanged();\n      this.datasource = null;\n    }\n  };\n\n  InfiniteRowModel.prototype.isLastRowFound = function () {\n    return this.infiniteCache ? this.infiniteCache.isMaxRowFound() : false;\n  };\n\n  InfiniteRowModel.prototype.addEventListeners = function () {\n    this.addManagedListener(this.eventService, Events.EVENT_FILTER_CHANGED, this.onFilterChanged.bind(this));\n    this.addManagedListener(this.eventService, Events.EVENT_SORT_CHANGED, this.onSortChanged.bind(this));\n    this.addManagedListener(this.eventService, Events.EVENT_COLUMN_EVERYTHING_CHANGED, this.onColumnEverything.bind(this));\n  };\n\n  InfiniteRowModel.prototype.onFilterChanged = function () {\n    this.reset();\n  };\n\n  InfiniteRowModel.prototype.onSortChanged = function () {\n    this.reset();\n  };\n\n  InfiniteRowModel.prototype.onColumnEverything = function () {\n    var resetRequired; // if cache params, we require reset only if sort model has changed. we don't need to check\n    // for filter model, as the filter manager will fire an event when columns change that result\n    // in the filter changing.\n\n    if (this.cacheParams) {\n      resetRequired = this.isSortModelDifferent();\n    } else {\n      // if no cacheParams, means first time creating the cache, so always create one\n      resetRequired = true;\n    }\n\n    if (resetRequired) {\n      this.reset();\n    }\n  };\n\n  InfiniteRowModel.prototype.isSortModelDifferent = function () {\n    return !_.jsonEquals(this.cacheParams.sortModel, this.sortController.getSortModel());\n  };\n\n  InfiniteRowModel.prototype.getType = function () {\n    return Constants.ROW_MODEL_TYPE_INFINITE;\n  };\n\n  InfiniteRowModel.prototype.setDatasource = function (datasource) {\n    this.destroyDatasource();\n    this.datasource = datasource; // only reset if we have a valid datasource to working with\n\n    if (datasource) {\n      this.checkForDeprecated();\n      this.reset();\n    }\n  };\n\n  InfiniteRowModel.prototype.checkForDeprecated = function () {\n    var ds = this.datasource; // the number of concurrent loads we are allowed to the server\n\n    if (_.exists(ds.maxConcurrentRequests)) {\n      console.error('ag-Grid: since version 5.1.x, maxConcurrentRequests is replaced with grid property maxConcurrentDatasourceRequests');\n    }\n\n    if (_.exists(ds.maxPagesInCache)) {\n      console.error('ag-Grid: since version 5.1.x, maxPagesInCache is replaced with grid property maxPagesInPaginationCache');\n    }\n\n    if (_.exists(ds.overflowSize)) {\n      console.error('ag-Grid: since version 5.1.x, overflowSize is replaced with grid property paginationOverflowSize');\n    }\n\n    if (_.exists(ds.blockSize)) {\n      console.error('ag-Grid: since version 5.1.x, pageSize/blockSize is replaced with grid property infinitePageSize');\n    }\n  };\n\n  InfiniteRowModel.prototype.isEmpty = function () {\n    return _.missing(this.infiniteCache);\n  };\n\n  InfiniteRowModel.prototype.isRowsToRender = function () {\n    return _.exists(this.infiniteCache);\n  };\n\n  InfiniteRowModel.prototype.getNodesInRangeForSelection = function (firstInRange, lastInRange) {\n    return this.infiniteCache ? this.infiniteCache.getRowNodesInRange(firstInRange, lastInRange) : [];\n  };\n\n  InfiniteRowModel.prototype.reset = function () {\n    // important to return here, as the user could be setting filter or sort before\n    // data-source is set\n    if (_.missing(this.datasource)) {\n      return;\n    } // if user is providing id's, then this means we can keep the selection between datasource hits,\n    // as the rows will keep their unique id's even if, for example, server side sorting or filtering\n    // is done.\n\n\n    var userGeneratingIds = _.exists(this.gridOptionsWrapper.getRowNodeIdFunc());\n\n    if (!userGeneratingIds) {\n      this.selectionController.reset();\n    }\n\n    this.resetCache();\n    var event = this.createModelUpdatedEvent();\n    this.eventService.dispatchEvent(event);\n  };\n\n  InfiniteRowModel.prototype.createModelUpdatedEvent = function () {\n    return {\n      type: Events.EVENT_MODEL_UPDATED,\n      api: this.gridApi,\n      columnApi: this.columnApi,\n      // not sure if these should all be false - noticed if after implementing,\n      // maybe they should be true?\n      newPage: false,\n      newData: false,\n      keepRenderedRows: false,\n      animate: false\n    };\n  };\n\n  InfiniteRowModel.prototype.resetCache = function () {\n    // if not first time creating a cache, need to destroy the old one\n    this.destroyCache();\n    var maxConcurrentRequests = this.gridOptionsWrapper.getMaxConcurrentDatasourceRequests();\n    var blockLoadDebounceMillis = this.gridOptionsWrapper.getBlockLoadDebounceMillis(); // there is a bi-directional dependency between the loader and the cache,\n    // so we create loader here, and then pass dependencies in setDependencies() method later\n\n    this.rowNodeBlockLoader = new RowNodeBlockLoader(maxConcurrentRequests, blockLoadDebounceMillis);\n    this.getContext().createBean(this.rowNodeBlockLoader);\n    this.cacheParams = {\n      // the user provided datasource\n      datasource: this.datasource,\n      // sort and filter model\n      filterModel: this.filterManager.getFilterModel(),\n      sortModel: this.sortController.getSortModel(),\n      rowNodeBlockLoader: this.rowNodeBlockLoader,\n      // properties - this way we take a snapshot of them, so if user changes any, they will be\n      // used next time we create a new cache, which is generally after a filter or sort change,\n      // or a new datasource is set\n      maxConcurrentRequests: maxConcurrentRequests,\n      overflowSize: this.gridOptionsWrapper.getCacheOverflowSize(),\n      initialRowCount: this.gridOptionsWrapper.getInfiniteInitialRowCount(),\n      maxBlocksInCache: this.gridOptionsWrapper.getMaxBlocksInCache(),\n      blockSize: this.gridOptionsWrapper.getCacheBlockSize(),\n      rowHeight: this.gridOptionsWrapper.getRowHeightAsNumber(),\n      // the cache could create this, however it is also used by the pages, so handy to create it\n      // here as the settings are also passed to the pages\n      lastAccessedSequence: new NumberSequence()\n    }; // set defaults\n\n    if (!this.cacheParams.maxConcurrentRequests || !(this.cacheParams.maxConcurrentRequests >= 1)) {\n      this.cacheParams.maxConcurrentRequests = 2;\n    } // page size needs to be 1 or greater. having it at 1 would be silly, as you would be hitting the\n    // server for one page at a time. so the default if not specified is 100.\n\n\n    if (!this.cacheParams.blockSize || !(this.cacheParams.blockSize >= 1)) {\n      this.cacheParams.blockSize = 100;\n    } // if user doesn't give initial rows to display, we assume one\n\n\n    if (!(this.cacheParams.initialRowCount >= 1)) {\n      this.cacheParams.initialRowCount = 1;\n    } // if user doesn't provide overflow, we use default overflow of 1, so user can scroll past\n    // the current page and request first row of next page\n\n\n    if (!(this.cacheParams.overflowSize >= 1)) {\n      this.cacheParams.overflowSize = 1;\n    }\n\n    this.infiniteCache = new InfiniteCache(this.cacheParams);\n    this.getContext().createBean(this.infiniteCache);\n    this.infiniteCache.addEventListener(RowNodeCache.EVENT_CACHE_UPDATED, this.onCacheUpdated.bind(this));\n  };\n\n  InfiniteRowModel.prototype.destroyCache = function () {\n    if (this.infiniteCache) {\n      this.infiniteCache = this.destroyBean(this.infiniteCache);\n    }\n\n    if (this.rowNodeBlockLoader) {\n      this.rowNodeBlockLoader = this.destroyBean(this.rowNodeBlockLoader);\n    }\n  };\n\n  InfiniteRowModel.prototype.onCacheUpdated = function () {\n    var event = this.createModelUpdatedEvent();\n    this.eventService.dispatchEvent(event);\n  };\n\n  InfiniteRowModel.prototype.getRow = function (rowIndex) {\n    return this.infiniteCache ? this.infiniteCache.getRow(rowIndex) : null;\n  };\n\n  InfiniteRowModel.prototype.getRowNode = function (id) {\n    var result = null;\n    this.forEachNode(function (rowNode) {\n      if (rowNode.id === id) {\n        result = rowNode;\n      }\n    });\n    return result;\n  };\n\n  InfiniteRowModel.prototype.forEachNode = function (callback) {\n    if (this.infiniteCache) {\n      this.infiniteCache.forEachNodeDeep(callback, new NumberSequence());\n    }\n  };\n\n  InfiniteRowModel.prototype.getCurrentPageHeight = function () {\n    return this.getRowCount() * this.rowHeight;\n  };\n\n  InfiniteRowModel.prototype.getTopLevelRowCount = function () {\n    return this.getRowCount();\n  };\n\n  InfiniteRowModel.prototype.getTopLevelRowDisplayedIndex = function (topLevelIndex) {\n    return topLevelIndex;\n  };\n\n  InfiniteRowModel.prototype.getRowIndexAtPixel = function (pixel) {\n    if (this.rowHeight !== 0) {\n      // avoid divide by zero error\n      var rowIndexForPixel = Math.floor(pixel / this.rowHeight);\n      var lastRowIndex = this.getRowCount() - 1;\n\n      if (rowIndexForPixel > lastRowIndex) {\n        return lastRowIndex;\n      } else {\n        return rowIndexForPixel;\n      }\n    } else {\n      return 0;\n    }\n  };\n\n  InfiniteRowModel.prototype.getRowCount = function () {\n    return this.infiniteCache ? this.infiniteCache.getVirtualRowCount() : 0;\n  };\n\n  InfiniteRowModel.prototype.updateRowData = function (transaction) {\n    if (_.exists(transaction.remove) || _.exists(transaction.update)) {\n      console.warn('ag-Grid: updateRowData for InfiniteRowModel does not support remove or update, only add');\n      return;\n    }\n\n    if (_.missing(transaction.addIndex)) {\n      console.warn('ag-Grid: updateRowData for InfiniteRowModel requires add and addIndex to be set');\n      return;\n    }\n\n    if (this.infiniteCache) {\n      this.infiniteCache.insertItemsAtIndex(transaction.addIndex, transaction.add);\n    }\n  };\n\n  InfiniteRowModel.prototype.isRowPresent = function (rowNode) {\n    return false;\n  };\n\n  InfiniteRowModel.prototype.refreshCache = function () {\n    if (this.infiniteCache) {\n      this.infiniteCache.refreshCache();\n    }\n  };\n\n  InfiniteRowModel.prototype.purgeCache = function () {\n    if (this.infiniteCache) {\n      this.infiniteCache.purgeCache();\n    }\n  };\n\n  InfiniteRowModel.prototype.getVirtualRowCount = function () {\n    if (this.infiniteCache) {\n      return this.infiniteCache.getVirtualRowCount();\n    } else {\n      return null;\n    }\n  };\n\n  InfiniteRowModel.prototype.isMaxRowFound = function () {\n    if (this.infiniteCache) {\n      return this.infiniteCache.isMaxRowFound();\n    }\n  };\n\n  InfiniteRowModel.prototype.setVirtualRowCount = function (rowCount, maxRowFound) {\n    if (this.infiniteCache) {\n      this.infiniteCache.setVirtualRowCount(rowCount, maxRowFound);\n    }\n  };\n\n  InfiniteRowModel.prototype.getBlockState = function () {\n    if (this.rowNodeBlockLoader) {\n      return this.rowNodeBlockLoader.getBlockState();\n    } else {\n      return null;\n    }\n  };\n\n  __decorate([Autowired('gridOptionsWrapper')], InfiniteRowModel.prototype, \"gridOptionsWrapper\", void 0);\n\n  __decorate([Autowired('filterManager')], InfiniteRowModel.prototype, \"filterManager\", void 0);\n\n  __decorate([Autowired('sortController')], InfiniteRowModel.prototype, \"sortController\", void 0);\n\n  __decorate([Autowired('selectionController')], InfiniteRowModel.prototype, \"selectionController\", void 0);\n\n  __decorate([Autowired('gridApi')], InfiniteRowModel.prototype, \"gridApi\", void 0);\n\n  __decorate([Autowired('columnApi')], InfiniteRowModel.prototype, \"columnApi\", void 0);\n\n  __decorate([Autowired('rowRenderer')], InfiniteRowModel.prototype, \"rowRenderer\", void 0);\n\n  __decorate([PostConstruct], InfiniteRowModel.prototype, \"init\", null);\n\n  __decorate([PreDestroy], InfiniteRowModel.prototype, \"destroyDatasource\", null);\n\n  InfiniteRowModel = __decorate([Bean('rowModel')], InfiniteRowModel);\n  return InfiniteRowModel;\n}(BeanStub);\n\nexport { InfiniteRowModel };","map":{"version":3,"sources":["/Users/fouaddakhel/Projects/Nana/ReactJS/supermarket_dashboard/supermarket_dashboard/node_modules/@ag-grid-community/infinite-row-model/dist/es6/infiniteRowModel/infiniteRowModel.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","__decorate","decorators","target","key","desc","c","arguments","length","r","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","_","Autowired","Bean","BeanStub","Constants","Events","NumberSequence","PostConstruct","PreDestroy","RowNodeBlockLoader","RowNodeCache","InfiniteCache","InfiniteRowModel","_super","apply","getRowBounds","index","rowHeight","rowTop","ensureRowHeightsValid","startPixel","endPixel","startLimitIndex","endLimitIndex","init","_this","gridOptionsWrapper","isRowModelInfinite","getRowHeightAsNumber","addEventListeners","addDestroyFunc","destroyCache","start","setDatasource","getDatasource","destroyDatasource","datasource","getContext","destroyBean","rowRenderer","datasourceChanged","isLastRowFound","infiniteCache","isMaxRowFound","addManagedListener","eventService","EVENT_FILTER_CHANGED","onFilterChanged","bind","EVENT_SORT_CHANGED","onSortChanged","EVENT_COLUMN_EVERYTHING_CHANGED","onColumnEverything","reset","resetRequired","cacheParams","isSortModelDifferent","jsonEquals","sortModel","sortController","getSortModel","getType","ROW_MODEL_TYPE_INFINITE","checkForDeprecated","ds","exists","maxConcurrentRequests","console","error","maxPagesInCache","overflowSize","blockSize","isEmpty","missing","isRowsToRender","getNodesInRangeForSelection","firstInRange","lastInRange","getRowNodesInRange","userGeneratingIds","getRowNodeIdFunc","selectionController","resetCache","event","createModelUpdatedEvent","dispatchEvent","type","EVENT_MODEL_UPDATED","api","gridApi","columnApi","newPage","newData","keepRenderedRows","animate","getMaxConcurrentDatasourceRequests","blockLoadDebounceMillis","getBlockLoadDebounceMillis","rowNodeBlockLoader","createBean","filterModel","filterManager","getFilterModel","getCacheOverflowSize","initialRowCount","getInfiniteInitialRowCount","maxBlocksInCache","getMaxBlocksInCache","getCacheBlockSize","lastAccessedSequence","addEventListener","EVENT_CACHE_UPDATED","onCacheUpdated","getRow","rowIndex","getRowNode","id","result","forEachNode","rowNode","callback","forEachNodeDeep","getCurrentPageHeight","getRowCount","getTopLevelRowCount","getTopLevelRowDisplayedIndex","topLevelIndex","getRowIndexAtPixel","pixel","rowIndexForPixel","Math","floor","lastRowIndex","getVirtualRowCount","updateRowData","transaction","remove","update","warn","addIndex","insertItemsAtIndex","add","isRowPresent","refreshCache","purgeCache","setVirtualRowCount","rowCount","maxRowFound","getBlockState"],"mappings":"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","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { _, Autowired, Bean, BeanStub, Constants, Events, NumberSequence, PostConstruct, PreDestroy, RowNodeBlockLoader, RowNodeCache } from \"@ag-grid-community/core\";\nimport { InfiniteCache } from \"./infiniteCache\";\nvar InfiniteRowModel = /** @class */ (function (_super) {\n    __extends(InfiniteRowModel, _super);\n    function InfiniteRowModel() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    InfiniteRowModel.prototype.getRowBounds = function (index) {\n        return {\n            rowHeight: this.rowHeight,\n            rowTop: this.rowHeight * index\n        };\n    };\n    // we don't implement as lazy row heights is not supported in this row model\n    InfiniteRowModel.prototype.ensureRowHeightsValid = function (startPixel, endPixel, startLimitIndex, endLimitIndex) {\n        return false;\n    };\n    InfiniteRowModel.prototype.init = function () {\n        var _this = this;\n        if (!this.gridOptionsWrapper.isRowModelInfinite()) {\n            return;\n        }\n        this.rowHeight = this.gridOptionsWrapper.getRowHeightAsNumber();\n        this.addEventListeners();\n        this.addDestroyFunc(function () { return _this.destroyCache(); });\n    };\n    InfiniteRowModel.prototype.start = function () {\n        this.setDatasource(this.gridOptionsWrapper.getDatasource());\n    };\n    InfiniteRowModel.prototype.destroyDatasource = function () {\n        if (this.datasource) {\n            this.getContext().destroyBean(this.datasource);\n            this.rowRenderer.datasourceChanged();\n            this.datasource = null;\n        }\n    };\n    InfiniteRowModel.prototype.isLastRowFound = function () {\n        return this.infiniteCache ? this.infiniteCache.isMaxRowFound() : false;\n    };\n    InfiniteRowModel.prototype.addEventListeners = function () {\n        this.addManagedListener(this.eventService, Events.EVENT_FILTER_CHANGED, this.onFilterChanged.bind(this));\n        this.addManagedListener(this.eventService, Events.EVENT_SORT_CHANGED, this.onSortChanged.bind(this));\n        this.addManagedListener(this.eventService, Events.EVENT_COLUMN_EVERYTHING_CHANGED, this.onColumnEverything.bind(this));\n    };\n    InfiniteRowModel.prototype.onFilterChanged = function () {\n        this.reset();\n    };\n    InfiniteRowModel.prototype.onSortChanged = function () {\n        this.reset();\n    };\n    InfiniteRowModel.prototype.onColumnEverything = function () {\n        var resetRequired;\n        // if cache params, we require reset only if sort model has changed. we don't need to check\n        // for filter model, as the filter manager will fire an event when columns change that result\n        // in the filter changing.\n        if (this.cacheParams) {\n            resetRequired = this.isSortModelDifferent();\n        }\n        else {\n            // if no cacheParams, means first time creating the cache, so always create one\n            resetRequired = true;\n        }\n        if (resetRequired) {\n            this.reset();\n        }\n    };\n    InfiniteRowModel.prototype.isSortModelDifferent = function () {\n        return !_.jsonEquals(this.cacheParams.sortModel, this.sortController.getSortModel());\n    };\n    InfiniteRowModel.prototype.getType = function () {\n        return Constants.ROW_MODEL_TYPE_INFINITE;\n    };\n    InfiniteRowModel.prototype.setDatasource = function (datasource) {\n        this.destroyDatasource();\n        this.datasource = datasource;\n        // only reset if we have a valid datasource to working with\n        if (datasource) {\n            this.checkForDeprecated();\n            this.reset();\n        }\n    };\n    InfiniteRowModel.prototype.checkForDeprecated = function () {\n        var ds = this.datasource;\n        // the number of concurrent loads we are allowed to the server\n        if (_.exists(ds.maxConcurrentRequests)) {\n            console.error('ag-Grid: since version 5.1.x, maxConcurrentRequests is replaced with grid property maxConcurrentDatasourceRequests');\n        }\n        if (_.exists(ds.maxPagesInCache)) {\n            console.error('ag-Grid: since version 5.1.x, maxPagesInCache is replaced with grid property maxPagesInPaginationCache');\n        }\n        if (_.exists(ds.overflowSize)) {\n            console.error('ag-Grid: since version 5.1.x, overflowSize is replaced with grid property paginationOverflowSize');\n        }\n        if (_.exists(ds.blockSize)) {\n            console.error('ag-Grid: since version 5.1.x, pageSize/blockSize is replaced with grid property infinitePageSize');\n        }\n    };\n    InfiniteRowModel.prototype.isEmpty = function () {\n        return _.missing(this.infiniteCache);\n    };\n    InfiniteRowModel.prototype.isRowsToRender = function () {\n        return _.exists(this.infiniteCache);\n    };\n    InfiniteRowModel.prototype.getNodesInRangeForSelection = function (firstInRange, lastInRange) {\n        return this.infiniteCache ? this.infiniteCache.getRowNodesInRange(firstInRange, lastInRange) : [];\n    };\n    InfiniteRowModel.prototype.reset = function () {\n        // important to return here, as the user could be setting filter or sort before\n        // data-source is set\n        if (_.missing(this.datasource)) {\n            return;\n        }\n        // if user is providing id's, then this means we can keep the selection between datasource hits,\n        // as the rows will keep their unique id's even if, for example, server side sorting or filtering\n        // is done.\n        var userGeneratingIds = _.exists(this.gridOptionsWrapper.getRowNodeIdFunc());\n        if (!userGeneratingIds) {\n            this.selectionController.reset();\n        }\n        this.resetCache();\n        var event = this.createModelUpdatedEvent();\n        this.eventService.dispatchEvent(event);\n    };\n    InfiniteRowModel.prototype.createModelUpdatedEvent = function () {\n        return {\n            type: Events.EVENT_MODEL_UPDATED,\n            api: this.gridApi,\n            columnApi: this.columnApi,\n            // not sure if these should all be false - noticed if after implementing,\n            // maybe they should be true?\n            newPage: false,\n            newData: false,\n            keepRenderedRows: false,\n            animate: false\n        };\n    };\n    InfiniteRowModel.prototype.resetCache = function () {\n        // if not first time creating a cache, need to destroy the old one\n        this.destroyCache();\n        var maxConcurrentRequests = this.gridOptionsWrapper.getMaxConcurrentDatasourceRequests();\n        var blockLoadDebounceMillis = this.gridOptionsWrapper.getBlockLoadDebounceMillis();\n        // there is a bi-directional dependency between the loader and the cache,\n        // so we create loader here, and then pass dependencies in setDependencies() method later\n        this.rowNodeBlockLoader = new RowNodeBlockLoader(maxConcurrentRequests, blockLoadDebounceMillis);\n        this.getContext().createBean(this.rowNodeBlockLoader);\n        this.cacheParams = {\n            // the user provided datasource\n            datasource: this.datasource,\n            // sort and filter model\n            filterModel: this.filterManager.getFilterModel(),\n            sortModel: this.sortController.getSortModel(),\n            rowNodeBlockLoader: this.rowNodeBlockLoader,\n            // properties - this way we take a snapshot of them, so if user changes any, they will be\n            // used next time we create a new cache, which is generally after a filter or sort change,\n            // or a new datasource is set\n            maxConcurrentRequests: maxConcurrentRequests,\n            overflowSize: this.gridOptionsWrapper.getCacheOverflowSize(),\n            initialRowCount: this.gridOptionsWrapper.getInfiniteInitialRowCount(),\n            maxBlocksInCache: this.gridOptionsWrapper.getMaxBlocksInCache(),\n            blockSize: this.gridOptionsWrapper.getCacheBlockSize(),\n            rowHeight: this.gridOptionsWrapper.getRowHeightAsNumber(),\n            // the cache could create this, however it is also used by the pages, so handy to create it\n            // here as the settings are also passed to the pages\n            lastAccessedSequence: new NumberSequence()\n        };\n        // set defaults\n        if (!this.cacheParams.maxConcurrentRequests || !(this.cacheParams.maxConcurrentRequests >= 1)) {\n            this.cacheParams.maxConcurrentRequests = 2;\n        }\n        // page size needs to be 1 or greater. having it at 1 would be silly, as you would be hitting the\n        // server for one page at a time. so the default if not specified is 100.\n        if (!this.cacheParams.blockSize || !(this.cacheParams.blockSize >= 1)) {\n            this.cacheParams.blockSize = 100;\n        }\n        // if user doesn't give initial rows to display, we assume one\n        if (!(this.cacheParams.initialRowCount >= 1)) {\n            this.cacheParams.initialRowCount = 1;\n        }\n        // if user doesn't provide overflow, we use default overflow of 1, so user can scroll past\n        // the current page and request first row of next page\n        if (!(this.cacheParams.overflowSize >= 1)) {\n            this.cacheParams.overflowSize = 1;\n        }\n        this.infiniteCache = new InfiniteCache(this.cacheParams);\n        this.getContext().createBean(this.infiniteCache);\n        this.infiniteCache.addEventListener(RowNodeCache.EVENT_CACHE_UPDATED, this.onCacheUpdated.bind(this));\n    };\n    InfiniteRowModel.prototype.destroyCache = function () {\n        if (this.infiniteCache) {\n            this.infiniteCache = this.destroyBean(this.infiniteCache);\n        }\n        if (this.rowNodeBlockLoader) {\n            this.rowNodeBlockLoader = this.destroyBean(this.rowNodeBlockLoader);\n        }\n    };\n    InfiniteRowModel.prototype.onCacheUpdated = function () {\n        var event = this.createModelUpdatedEvent();\n        this.eventService.dispatchEvent(event);\n    };\n    InfiniteRowModel.prototype.getRow = function (rowIndex) {\n        return this.infiniteCache ? this.infiniteCache.getRow(rowIndex) : null;\n    };\n    InfiniteRowModel.prototype.getRowNode = function (id) {\n        var result = null;\n        this.forEachNode(function (rowNode) {\n            if (rowNode.id === id) {\n                result = rowNode;\n            }\n        });\n        return result;\n    };\n    InfiniteRowModel.prototype.forEachNode = function (callback) {\n        if (this.infiniteCache) {\n            this.infiniteCache.forEachNodeDeep(callback, new NumberSequence());\n        }\n    };\n    InfiniteRowModel.prototype.getCurrentPageHeight = function () {\n        return this.getRowCount() * this.rowHeight;\n    };\n    InfiniteRowModel.prototype.getTopLevelRowCount = function () {\n        return this.getRowCount();\n    };\n    InfiniteRowModel.prototype.getTopLevelRowDisplayedIndex = function (topLevelIndex) {\n        return topLevelIndex;\n    };\n    InfiniteRowModel.prototype.getRowIndexAtPixel = function (pixel) {\n        if (this.rowHeight !== 0) { // avoid divide by zero error\n            var rowIndexForPixel = Math.floor(pixel / this.rowHeight);\n            var lastRowIndex = this.getRowCount() - 1;\n            if (rowIndexForPixel > lastRowIndex) {\n                return lastRowIndex;\n            }\n            else {\n                return rowIndexForPixel;\n            }\n        }\n        else {\n            return 0;\n        }\n    };\n    InfiniteRowModel.prototype.getRowCount = function () {\n        return this.infiniteCache ? this.infiniteCache.getVirtualRowCount() : 0;\n    };\n    InfiniteRowModel.prototype.updateRowData = function (transaction) {\n        if (_.exists(transaction.remove) || _.exists(transaction.update)) {\n            console.warn('ag-Grid: updateRowData for InfiniteRowModel does not support remove or update, only add');\n            return;\n        }\n        if (_.missing(transaction.addIndex)) {\n            console.warn('ag-Grid: updateRowData for InfiniteRowModel requires add and addIndex to be set');\n            return;\n        }\n        if (this.infiniteCache) {\n            this.infiniteCache.insertItemsAtIndex(transaction.addIndex, transaction.add);\n        }\n    };\n    InfiniteRowModel.prototype.isRowPresent = function (rowNode) {\n        return false;\n    };\n    InfiniteRowModel.prototype.refreshCache = function () {\n        if (this.infiniteCache) {\n            this.infiniteCache.refreshCache();\n        }\n    };\n    InfiniteRowModel.prototype.purgeCache = function () {\n        if (this.infiniteCache) {\n            this.infiniteCache.purgeCache();\n        }\n    };\n    InfiniteRowModel.prototype.getVirtualRowCount = function () {\n        if (this.infiniteCache) {\n            return this.infiniteCache.getVirtualRowCount();\n        }\n        else {\n            return null;\n        }\n    };\n    InfiniteRowModel.prototype.isMaxRowFound = function () {\n        if (this.infiniteCache) {\n            return this.infiniteCache.isMaxRowFound();\n        }\n    };\n    InfiniteRowModel.prototype.setVirtualRowCount = function (rowCount, maxRowFound) {\n        if (this.infiniteCache) {\n            this.infiniteCache.setVirtualRowCount(rowCount, maxRowFound);\n        }\n    };\n    InfiniteRowModel.prototype.getBlockState = function () {\n        if (this.rowNodeBlockLoader) {\n            return this.rowNodeBlockLoader.getBlockState();\n        }\n        else {\n            return null;\n        }\n    };\n    __decorate([\n        Autowired('gridOptionsWrapper')\n    ], InfiniteRowModel.prototype, \"gridOptionsWrapper\", void 0);\n    __decorate([\n        Autowired('filterManager')\n    ], InfiniteRowModel.prototype, \"filterManager\", void 0);\n    __decorate([\n        Autowired('sortController')\n    ], InfiniteRowModel.prototype, \"sortController\", void 0);\n    __decorate([\n        Autowired('selectionController')\n    ], InfiniteRowModel.prototype, \"selectionController\", void 0);\n    __decorate([\n        Autowired('gridApi')\n    ], InfiniteRowModel.prototype, \"gridApi\", void 0);\n    __decorate([\n        Autowired('columnApi')\n    ], InfiniteRowModel.prototype, \"columnApi\", void 0);\n    __decorate([\n        Autowired('rowRenderer')\n    ], InfiniteRowModel.prototype, \"rowRenderer\", void 0);\n    __decorate([\n        PostConstruct\n    ], InfiniteRowModel.prototype, \"init\", null);\n    __decorate([\n        PreDestroy\n    ], InfiniteRowModel.prototype, \"destroyDatasource\", null);\n    InfiniteRowModel = __decorate([\n        Bean('rowModel')\n    ], InfiniteRowModel);\n    return InfiniteRowModel;\n}(BeanStub));\nexport { InfiniteRowModel };\n"]},"metadata":{},"sourceType":"module"}